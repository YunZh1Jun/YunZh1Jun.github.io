<!DOCTYPE html>
<html lang="zh-cn">
    <!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>2022å¤ç° - äº‘ä¹‹å›&#39;s Blog</title>
  
    <link rel="shortcut icon" href="/theme-img/fav/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/waline.css">

  
  
  
<link rel="stylesheet" href="/css/post.css">

  

  
    
<script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
 
  

  
<meta name="generator" content="Hexo 5.4.2"></head>
    <body data-color-scheme="auto">
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">äº‘ä¹‹å›&#39;s Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">ä¸»é¡µ</a>
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/CTF">CTF</a>
            
            
            
            <a class="nav-item" href="/Learn">Learn</a>
            
            
            
            <a class="nav-item" href="/Dairy">Dairy</a>
            
            
            
            <a class="nav-item" href="/Alkaid">Alkaid</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/YunZh1Jun" target="_blank">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        <article class="post">
    <div class="meta">
        
        <div class="date" id="date">
            
            
            
            
            
            
            
            
            
            <span>September</span>
            
            
            
            
            <span>18,</span>
            <span>2022</span>
        </div>
        

        <h2 class="title">2022å¤ç°</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p>è®°å½•ä¸€äº›2022å¹´ä¹±ä¸ƒå…«ç³Ÿçš„æ¯”èµ›çš„WPå’Œå¤ç°ã€‚</p>
<span id="more"></span>

<h2 id="ç¬¬äº”ç©ºé—´"><a href="#ç¬¬äº”ç©ºé—´" class="headerlink" title="ç¬¬äº”ç©ºé—´"></a>ç¬¬äº”ç©ºé—´</h2><h3 id="wb"><a href="#wb" class="headerlink" title="wb"></a>wb</h3><p>è¿™å…¶å®æ˜¯ä¸ªå¯†ç é¢˜ï¼Œæ¯”èµ›çš„æ—¶å€™æˆ‘ç»™dbtğŸ‘´åœ¨è¿™é¢˜æ‰“ä¸‹æ‰‹ï¼Œå°±é¡ºä¾¿å†™ä¸€ä¸‹é€†å‘çš„éƒ¨åˆ†ï¼Œæ–¹ä¾¿å¯†ç ğŸ‘´ä»¬å¤ç°è¿™é“é¢˜ã€‚</p>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This is an highly obfuscated whitebox ECDSA implementation (on an certain standard elliptic curve)!</span><br><span class="line">E.g. the sig of a message with empty hash is</span><br><span class="line">0xBBDFAC1809250A2BB9415225F7C548CF8C03A5E100F95D52A4AA27F42A2F0FBE, 0x615ED230E3DCEF9712DC86AFE1C33F818EF1BA79212DA3E6D522D41D4C5D6C45 </span><br><span class="line">the flag is the ascii decoding of the private key in big endian</span><br><span class="line">Hint: No need to do (much) reverse engineering!</span><br></pre></td></tr></table></figure>

<p>mainå‡½æ•°ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4[<span class="number">64</span>]; <span class="comment">// [rsp+0h] [rbp-70h] BYREF</span></span><br><span class="line">  __int64 v5[<span class="number">5</span>]; <span class="comment">// [rsp+40h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+68h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+6Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v5[<span class="number">0</span>] = <span class="number">0LL</span>;</span><br><span class="line">  v5[<span class="number">1</span>] = <span class="number">0LL</span>;</span><br><span class="line">  v5[<span class="number">2</span>] = <span class="number">0LL</span>;</span><br><span class="line">  v5[<span class="number">3</span>] = <span class="number">0LL</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;This is an highly obfuscated whitebox ECDSA implementation (on an certain standard elliptic curve)!&quot;</span>);</span><br><span class="line">  sub_404565(v4, v5);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;E.g. the sig of a message with empty hash is\n0x&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%02X&quot;</span>, (<span class="type">unsigned</span> __int8)v4[i]);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;, 0x&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">32</span>; j &lt;= <span class="number">63</span>; ++j )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%02X&quot;</span>, (<span class="type">unsigned</span> __int8)v4[j]);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\nthe flag is the ascii decoding of the private key in big endian&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Hint: No need to do (much) reverse engineering!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>v5èµ‹0ï¼Œsub_404565å‘v4é‡Œå†™äº†ä¸€å †ä¸œè¥¿ç„¶åæ‰“å°å‡ºæ¥ï¼Œv4ä¸ä¼šå½±å“ç»“æœï¼Œä¿®æ”¹v5çš„å€¼ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœã€‚</p>
<blockquote>
<p>è‡³äºæ€ä¹ˆä¿®æ”¹v5ï¼Ÿç›´æ¥ä¸¢ç»™é˜Ÿé‡Œçš„é€†å‘æ‰‹å§hhhhhhh</p>
</blockquote>
<p>sub_404565é‡Œåšäº†ä¸¥é‡çš„æ··æ·†ï¼Œæ— æ³•é€†å‘ï¼Œåªæœ‰ä¸¤ä¸ªå‡½æ•°èƒ½çœ‹ã€‚è¿™ä¸¤ä¸ªå‡½æ•°åˆ†åˆ«åœ¨æ··æ·†çš„æœ€åˆå’Œæœ€åè°ƒç”¨ï¼Œç›¸å…³å†…å®¹æˆ‘å·²ç»å†™åœ¨æ³¨é‡Šé‡Œã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_409980</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v2[<span class="number">8</span>]; <span class="comment">// [rsp+18h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">16</span>]; <span class="comment">// [rsp+30h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">16</span>]; <span class="comment">// [rsp+40h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __gmpz_init(v5);</span><br><span class="line">  __gmpz_import(v5, <span class="number">32LL</span>, <span class="number">1LL</span>, <span class="number">1LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>, a1);<span class="comment">// v5=0</span></span><br><span class="line">  __gmpz_init_set_str(v4, off_410E28, <span class="number">16LL</span>);    <span class="comment">// v4=8b98a63042f8d2ee616e680ab504de9b2e8a8effb4b413f85be9ba360b58e795</span></span><br><span class="line">  __gmpz_init_set_str(v3, <span class="string">&quot;ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551&quot;</span>, <span class="number">16LL</span>);</span><br><span class="line">  __gmpz_mul(v5, v5, v4);                       <span class="comment">// v5*=v4</span></span><br><span class="line">  __gmpz_mod(v5, v5, v3);                       <span class="comment">// v5%=v3</span></span><br><span class="line">  <span class="keyword">return</span> __gmpz_export(a1, v2, <span class="number">1LL</span>, <span class="number">1LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>, v5);</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_409A5F</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v2[<span class="number">8</span>]; <span class="comment">// [rsp+18h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">16</span>]; <span class="comment">// [rsp+30h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">16</span>]; <span class="comment">// [rsp+40h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __gmpz_init(v5);</span><br><span class="line">  __gmpz_import(v5, <span class="number">32LL</span>, <span class="number">1LL</span>, <span class="number">1LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>, a1 + <span class="number">32</span>);</span><br><span class="line">  __gmpz_init_set_str(v4, off_410E30, <span class="number">16LL</span>);    <span class="comment">// v4=8f6f7a2e53c0377e9afb357a510371ea7811df0ac47fb92b92f6baca90ebc282</span></span><br><span class="line">  __gmpz_init_set_str(v3, <span class="string">&quot;ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551&quot;</span>, <span class="number">16LL</span>);</span><br><span class="line">  __gmpz_mul(v5, v5, v4);</span><br><span class="line">  __gmpz_mod(v5, v5, v3);</span><br><span class="line">  <span class="keyword">return</span> __gmpz_export(a1 + <span class="number">32</span>, v2, <span class="number">1LL</span>, <span class="number">1LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>, v5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>dbtè®©æˆ‘ä¿®æ”¹v5çš„å€¼ï¼Œè¿è¡Œç¨‹åºå¾—åˆ°ä»¥ä¸‹æ•°æ®ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v5 = <span class="number">1</span></span><br><span class="line"><span class="comment">//output:0xBBDFAC1809250A2BB9415225F7C548CF8C03A5E100F95D52A4AA27F42A2F0FBE, 0x49225E3C59E87FA62AEB73FD50239A6E03278B96A11319D54624AF8714F2C989</span></span><br><span class="line">v5 = <span class="number">2</span></span><br><span class="line"><span class="comment">//output:0xBBDFAC1809250A2BB9415225F7C548CF8C03A5E100F95D52A4AA27F42A2F0FBE, 0x30E5EA47CFF40FB542FA614ABE83F55A775D5CB420F88FC3B7268AF0DD8826CD</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆè„šæœ¬ï¼ˆæ¥è‡ªdbtğŸ‘´ï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n =<span class="number">0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551</span></span><br><span class="line">k = <span class="number">0x8b98a63042f8d2ee616e680ab504de9b2e8a8effb4b413f85be9ba360b58e795</span></span><br><span class="line">k_inv = <span class="number">0x8f6f7a2e53c0377e9afb357a510371ea7811df0ac47fb92b92f6baca90ebc282</span></span><br><span class="line"><span class="keyword">assert</span> k * k_inv % n == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">r,s   = <span class="number">0xBBDFAC1809250A2BB9415225F7C548CF8C03A5E100F95D52A4AA27F42A2F0FBE</span>, <span class="number">0x615ED230E3DCEF9712DC86AFE1C33F818EF1BA79212DA3E6D522D41D4C5D6C45</span> </span><br><span class="line">r1,s1 = <span class="number">0xBBDFAC1809250A2BB9415225F7C548CF8C03A5E100F95D52A4AA27F42A2F0FBE</span>, <span class="number">0x49225E3C59E87FA62AEB73FD50239A6E03278B96A11319D54624AF8714F2C989</span></span><br><span class="line">r2,s2 = <span class="number">0xBBDFAC1809250A2BB9415225F7C548CF8C03A5E100F95D52A4AA27F42A2F0FBE</span>, <span class="number">0x30E5EA47CFF40FB542FA614ABE83F55A775D5CB420F88FC3B7268AF0DD8826CD</span></span><br><span class="line"><span class="keyword">assert</span> ((s1*<span class="number">0</span>-s*<span class="number">1</span>)%n == (s2*<span class="number">1</span>-s1*<span class="number">2</span>) %n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes((s1*<span class="number">0</span>-s*<span class="number">1</span>)%n * inverse(r*(s-s1),n) % n))</span><br></pre></td></tr></table></figure>

<h3 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h3><p>mipsï¼Œghidraå¯å†²</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">undefined8 <span class="title function_">move</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> check;</span><br><span class="line">  <span class="type">int</span> input_idx;</span><br><span class="line">  <span class="type">char</span> input [<span class="number">528</span>];</span><br><span class="line">  undefined *local_18;</span><br><span class="line">  <span class="type">char</span> this_c;</span><br><span class="line">  </span><br><span class="line">  local_18 = &amp;_mips_gp0_value;</span><br><span class="line">  input_idx = <span class="number">0</span>;</span><br><span class="line">  input[<span class="number">0</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">  input[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(input + <span class="number">2</span>,<span class="number">0</span>,<span class="number">0x1fe</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;input: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(&amp;DAT_120001878,input);</span><br><span class="line">  <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">      check = <span class="number">0</span>;</span><br><span class="line">      find();</span><br><span class="line">      this_c = input[input_idx];</span><br><span class="line">      <span class="keyword">if</span> (this_c == <span class="string">&#x27;w&#x27;</span>) &#123;</span><br><span class="line">        check = Up();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (this_c &lt; <span class="string">&#x27;x&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (this_c == <span class="string">&#x27;s&#x27;</span>) &#123;</span><br><span class="line">          check = Down();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (this_c &lt; <span class="string">&#x27;t&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (this_c == <span class="string">&#x27;d&#x27;</span>) &#123;</span><br><span class="line">            check = Right();</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (this_c &lt; <span class="string">&#x27;e&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (this_c == <span class="string">&#x27;\x1b&#x27;</span>) &#123;</span><br><span class="line">              <span class="keyword">return</span> <span class="number">0xffffffffffffffff</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (this_c == <span class="string">&#x27;a&#x27;</span>) &#123;</span><br><span class="line">              check = Left();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      input_idx = input_idx + <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">while</span> (check != <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (level == <span class="number">2</span>) <span class="keyword">break</span>;</span><br><span class="line">    level = level + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;flag is ctf&#123;md5(your input)&#125;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ•°æ®é‡Œæ‰¾åœ°å›¾ï¼Œæ³¨æ„æ˜¯wordç±»å‹çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">map</span> = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<p>æ‰“å°å‡ºæ¥è¿·å®«æ‰‹åŠ¨èµ°å³å¯ã€‚<br><del>æ³ªç›®ï¼Œè¿™ä¹ˆç®€å•çš„ç­¾åˆ°é¢˜çœŸçš„ä¸å¤šäº†</del></p>
<h3 id="Universal"><a href="#Universal" class="headerlink" title="Universal"></a>Universal</h3><p>è¿™é¢˜å°±æ˜¯çº¯è°ƒè¯•ã€‚ã€‚ã€‚æ²¡ä»»ä½•æŠ€å·§ã€‚ã€‚ã€‚å¯¹ç€traceè¾¹çœ‹è¾¹è°ƒè¯•ï¼ŒæŠ½äº†3å¤©çš„ç©ºç»ˆäºè°ƒå‡ºæ¥äº†ï¼Œè¿™å¯¹æˆ‘è¿™ä¸ªè°ƒè¯•èœé¸¡æ¥è¯´è¿˜æ˜¯å¤ªè‰°éš¾äº†ğŸ˜­ğŸ˜­ğŸ˜­<br>æ„Ÿè§‰è¿™ç§ä¸œè¥¿è¿˜æ˜¯è¦å¤šç»ƒå•Šï¼Œåšç†Ÿç»ƒäº†ï¼Œæ¯”èµ›é‡åˆ°çš„æ—¶å€™å°±ä¸ä¼šç´§å¼ äº†<br>ä½†æ˜¯è¿™ä¸ªé¢˜è«åå…¶å¦™çš„â€¦â€¦å¥½åƒæ²¡äººå†™è¿™ä¸ªé¢˜çš„wpâ€¦â€¦ï¼ˆè¿˜æ˜¯è‡ªå·±ç¡¬ç€å¤´çš®å—¯å•ƒæ±‡ç¼–äº†â€¦â€¦  <del>ä½†è¿˜æ˜¯æƒ³åæ§½æ±‡ç¼–çœŸéš¾çœ‹</del><br>ç°åœ¨é¢å¯¹ç€traceå‡ºæ¥1w+è¡Œæˆ‘ç»ˆäºä¹Ÿèƒ½è¯´</p>
<blockquote>
<p>åŒºåŒº1wè¡Œï¼ˆï¼ˆï¼ˆ  <del>è¿™éƒ½å°åœºé¢</del></p>
</blockquote>
<p>æ³ªç›®</p>
<p>ctrl sæ‰¾dataæ®µï¼Œå¾€ä¸‹ç¿»æ‰¾åˆ°å¯†æ–‡<code>unk_415100</code>ï¼Œæ‰¾äº¤å‰å¼•ç”¨ï¼Œåç¼–è¯‘åˆ°<code>sub_402747</code>ï¼Œä¸»è¦çš„åŠ å¯†é€»è¾‘ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( sub_40AE50() == <span class="number">32</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  sub_40553C(v6, &amp;v14);</span><br><span class="line">  sub_40553C(v8, &amp;v14);</span><br><span class="line">  sub_40553C(v9, &amp;v14);</span><br><span class="line">  sub_40553C(v10, &amp;v14);</span><br><span class="line">  v11 = sub_405432();</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v12 = v7++;</span><br><span class="line">    *((_BYTE *)v15 + (v12 &amp; <span class="number">0x1F</span>)) = v11 ^ ~(*((_BYTE *)v15 + (v12 &amp; <span class="number">0x1F</span>)) ^ *((_BYTE *)v15 + (v7 &amp; <span class="number">0x1F</span>)));</span><br><span class="line">    v11 = sub_405432() ^ <span class="number">0xA5</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v7 != <span class="number">64</span> );</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="type">unsigned</span> <span class="type">int</span>)sub_40A530(v13, <span class="number">0x20</span>ui64) )</span><br><span class="line">    sub_405595();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨<code>sub_40553C</code>åŠ å¯†äº†4æ¬¡ï¼Œç„¶åç”¨<code>sub_405432</code>åŠ å¯†ï¼Œæœ€å<code>sub_40A530</code>å’Œå¯†æ–‡å¯¹æ¯”ã€‚<br>å¯ä»¥çŸ¥é“flagé•¿åº¦æ˜¯32ï¼Œè°ƒè¯•é€‰é¡¹ParamentersåŠ ä¸Šä¸€ä¸ªé•¿åº¦ä¸º32çš„å­—ç¬¦ä¸²å°±å¯ä»¥æ­£å¸¸è¿è¡Œã€‚æ­¤åä¸‹æ–­ç‚¹å»traceï¼Œçœ‹traceå»åˆ†æã€‚</p>
<p>traceçœ‹é€»è¾‘ï¼Œè°ƒè¯•çœ‹å†…å­˜ã€‚è¿˜åŸå‡ºæ¥çš„é€»è¾‘å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span> = [<span class="number">0x33323130</span>, <span class="number">0x37363534</span>, <span class="number">0x31303938</span>, <span class="number">0x35343332</span>,<span class="number">0x39383736</span>, <span class="number">0x33323130</span>, <span class="number">0x37363534</span>, <span class="number">0x31303938</span>]</span><br><span class="line">xor0 = [<span class="number">0xDEADBEEF</span>, <span class="number">0x9E3779B9</span>, <span class="number">0xC6EF3720</span>, <span class="number">0xBEEFDEED</span>, <span class="number">0xDEADBEEF</span>, <span class="number">0x9E3779B9</span>, <span class="number">0xC6EF3720</span>, <span class="number">0xBEEFDEED</span>, <span class="number">0x33323130</span>, <span class="number">0x37363534</span>, <span class="number">0x31303938</span>, <span class="number">0x35343332</span>,<span class="number">0x39383736</span>, <span class="number">0x33323130</span>, <span class="number">0x37363534</span>, <span class="number">0x31303938</span>]</span><br><span class="line">xor1 = [<span class="number">3</span>, <span class="number">0xF</span>, <span class="number">0xE</span>, <span class="number">0xA</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">0xD</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">0xC</span>, <span class="number">0xB</span>, <span class="number">8</span>]</span><br><span class="line">xor2 = [<span class="number">3</span>, <span class="number">0xA</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">0xB</span>, <span class="number">0xD</span>, <span class="number">0xC</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">0xE</span>, <span class="number">0xF</span>]</span><br><span class="line">xor3 = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0xB</span>, <span class="number">0xF</span>, <span class="number">5</span>, <span class="number">0xC</span>, <span class="number">4</span>, <span class="number">0xE</span>, <span class="number">0xD</span>, <span class="number">0xA</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>]</span><br><span class="line">xor4 = [<span class="number">0xB</span>, <span class="number">3</span>, <span class="number">0xE</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0xD</span>, <span class="number">0xC</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">0xA</span>, <span class="number">0xF</span>]</span><br><span class="line">xor5 = [<span class="number">0xD</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0xA</span>, <span class="number">7</span>, <span class="number">0xB</span>, <span class="number">0xC</span>, <span class="number">3</span>, <span class="number">0xE</span>, <span class="number">0xF</span>]</span><br><span class="line">xor6 = [<span class="number">0xF</span>, <span class="number">0xC</span>, <span class="number">0xA</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0xE</span>, <span class="number">2</span>, <span class="number">0xB</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">0xD</span>, <span class="number">3</span>]</span><br><span class="line">xor7 = [<span class="number">0xD</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0xF</span>, <span class="number">3</span>, <span class="number">0xA</span>, <span class="number">0xB</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">0xE</span>, <span class="number">7</span>, <span class="number">0xC</span>, <span class="number">1</span>, <span class="number">8</span>]</span><br><span class="line">xor8 = [<span class="number">4</span>, <span class="number">0xE</span>, <span class="number">0</span>, <span class="number">0xF</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">0xD</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">0xC</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">0xA</span>, <span class="number">0xB</span>, <span class="number">6</span>]</span><br><span class="line">idx = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode1</span>(<span class="params">i0,i1</span>):</span><br><span class="line">	tmp = <span class="built_in">input</span>[i0] ^ xor0[<span class="number">0</span>] ^ <span class="built_in">input</span>[i1]</span><br><span class="line">	xor0_idx = <span class="number">30</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">		key = (xor1[(tmp&gt;&gt;<span class="number">0x1c</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">28</span>)|(xor2[(tmp&gt;&gt;<span class="number">0x18</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">24</span>)|(xor3[(tmp&gt;&gt;<span class="number">0x14</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">20</span>)|(xor4[(tmp&gt;&gt;<span class="number">0x10</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">16</span>)|(xor5[(tmp&gt;&gt;<span class="number">0xc</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">12</span>)|(xor6[(tmp&gt;&gt;<span class="number">0x8</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">8</span>)|(xor7[(tmp&gt;&gt;<span class="number">0x4</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">4</span>)|(xor8[(tmp)&amp;<span class="number">0xf</span>])</span><br><span class="line">		<span class="built_in">input</span>[i1] = <span class="built_in">input</span>[i0]</span><br><span class="line">		tmp = key ^ xor0[idx[xor0_idx]] ^ <span class="built_in">input</span>[i1]</span><br><span class="line">		<span class="built_in">input</span>[i0] = key</span><br><span class="line">		xor0_idx -= <span class="number">1</span></span><br><span class="line">	key = (xor1[(tmp&gt;&gt;<span class="number">0x1c</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">28</span>)|(xor2[(tmp&gt;&gt;<span class="number">0x18</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">24</span>)|(xor3[(tmp&gt;&gt;<span class="number">0x14</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">20</span>)|(xor4[(tmp&gt;&gt;<span class="number">0x10</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">16</span>)|(xor5[(tmp&gt;&gt;<span class="number">0xc</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">12</span>)|(xor6[(tmp&gt;&gt;<span class="number">0x8</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">8</span>)|(xor7[(tmp&gt;&gt;<span class="number">0x4</span>)&amp;<span class="number">0xf</span>]&lt;&lt;<span class="number">4</span>)|(xor8[(tmp)&amp;<span class="number">0xf</span>])</span><br><span class="line">	<span class="built_in">input</span>[i1] = key</span><br><span class="line"></span><br><span class="line">encode1(<span class="number">0</span>,<span class="number">3</span>)</span><br><span class="line">encode1(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">encode1(<span class="number">4</span>,<span class="number">6</span>)</span><br><span class="line">encode1(<span class="number">5</span>,<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">input_byte = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">input</span>:</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> pack(<span class="string">&#x27;&lt;I&#x27;</span>,k):</span><br><span class="line">		input_byte.append(i)</span><br><span class="line"></span><br><span class="line">what = (input_byte[<span class="number">0</span>] + input_byte[-<span class="number">1</span>]) &amp; <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">	input_byte[i] = what ^ (input_byte[i] ^ input_byte[(i+<span class="number">1</span>)&amp;<span class="number">0x1f</span>]) ^ <span class="number">0xff</span></span><br><span class="line">	what += input_byte[i]</span><br><span class="line">	what ^= <span class="number">0xa5</span></span><br><span class="line">	what &amp;= <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">	input_byte[i] = what ^ (input_byte[i] ^ input_byte[(i+<span class="number">1</span>)&amp;<span class="number">0x1f</span>]) ^ <span class="number">0xff</span></span><br><span class="line">	what += input_byte[i]</span><br><span class="line">	what ^= <span class="number">0xa5</span></span><br><span class="line">	what &amp;= <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">hex</span>(input_byte[i]),end=<span class="string">&#x27;,&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>é€†ç€å»å†™è§£å¯†è„šæœ¬è„šæœ¬å³å¯ã€‚<br>æ³¨æ„decode2é‡Œé¢çš„whatå€¼æ˜¯ä¸å¯çŸ¥çš„ï¼Œæ‰€ä»¥åªèƒ½çˆ†ç ´ï¼Œå¯ä»¥é€šè¿‡é™åˆ¶whatç­‰äº<code>(input_byte[0] + input_byte[-1]) &amp; 0xff</code>æ¥å‡å°‘è§£çš„æƒ…å†µã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">input_enc = [<span class="number">0xC2</span>, <span class="number">0x3A</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x44</span>, <span class="number">0x07</span>, <span class="number">0x13</span>, <span class="number">0x0C</span>, <span class="number">0x7B</span>, <span class="number">0xBE</span>, <span class="number">0x1A</span>, <span class="number">0x6D</span>, <span class="number">0xCB</span>, <span class="number">0xFA</span>, <span class="number">0x26</span>, <span class="number">0x99</span>, <span class="number">0x62</span>, <span class="number">0x7C</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0x9F</span>, <span class="number">0x1C</span>, <span class="number">0xD9</span>, <span class="number">0x99</span>, <span class="number">0x44</span>, <span class="number">0xC3</span>, <span class="number">0xB7</span>, <span class="number">0x1D</span>, <span class="number">0x67</span>, <span class="number">0x3C</span>, <span class="number">0x7B</span>, <span class="number">0x80</span>]</span><br><span class="line">decode_1 = []</span><br><span class="line">xor0 = [<span class="number">0xDEADBEEF</span>, <span class="number">0x9E3779B9</span>, <span class="number">0xC6EF3720</span>, <span class="number">0xBEEFDEED</span>, <span class="number">0xDEADBEEF</span>, <span class="number">0x9E3779B9</span>, <span class="number">0xC6EF3720</span>, <span class="number">0xBEEFDEED</span>, <span class="number">0x33323130</span>, <span class="number">0x37363534</span>, <span class="number">0x31303938</span>, <span class="number">0x35343332</span>,<span class="number">0x39383736</span>, <span class="number">0x33323130</span>, <span class="number">0x37363534</span>, <span class="number">0x31303938</span>]</span><br><span class="line">xor1 = [<span class="number">3</span>, <span class="number">0xF</span>, <span class="number">0xE</span>, <span class="number">0xA</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">0xD</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">0xC</span>, <span class="number">0xB</span>, <span class="number">8</span>]</span><br><span class="line">xor2 = [<span class="number">3</span>, <span class="number">0xA</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">0xB</span>, <span class="number">0xD</span>, <span class="number">0xC</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">0xE</span>, <span class="number">0xF</span>]</span><br><span class="line">xor3 = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0xB</span>, <span class="number">0xF</span>, <span class="number">5</span>, <span class="number">0xC</span>, <span class="number">4</span>, <span class="number">0xE</span>, <span class="number">0xD</span>, <span class="number">0xA</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>]</span><br><span class="line">xor4 = [<span class="number">0xB</span>, <span class="number">3</span>, <span class="number">0xE</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0xD</span>, <span class="number">0xC</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">0xA</span>, <span class="number">0xF</span>]</span><br><span class="line">xor5 = [<span class="number">0xD</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0xA</span>, <span class="number">7</span>, <span class="number">0xB</span>, <span class="number">0xC</span>, <span class="number">3</span>, <span class="number">0xE</span>, <span class="number">0xF</span>]</span><br><span class="line">xor6 = [<span class="number">0xF</span>, <span class="number">0xC</span>, <span class="number">0xA</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0xE</span>, <span class="number">2</span>, <span class="number">0xB</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">0xD</span>, <span class="number">3</span>]</span><br><span class="line">xor7 = [<span class="number">0xD</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0xF</span>, <span class="number">3</span>, <span class="number">0xA</span>, <span class="number">0xB</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">0xE</span>, <span class="number">7</span>, <span class="number">0xC</span>, <span class="number">1</span>, <span class="number">8</span>]</span><br><span class="line">xor8 = [<span class="number">4</span>, <span class="number">0xE</span>, <span class="number">0</span>, <span class="number">0xF</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">0xD</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">0xC</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">0xA</span>, <span class="number">0xB</span>, <span class="number">6</span>]</span><br><span class="line">idx = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_to_tmp</span>(<span class="params">key</span>):</span><br><span class="line">	<span class="keyword">return</span> (xor1.index((key&gt;&gt;<span class="number">0x1c</span>)&amp;<span class="number">0xf</span>)&lt;&lt;<span class="number">28</span>)|(xor2.index((key&gt;&gt;<span class="number">0x18</span>)&amp;<span class="number">0xf</span>)&lt;&lt;<span class="number">24</span>)|(xor3.index((key&gt;&gt;<span class="number">0x14</span>)&amp;<span class="number">0xf</span>)&lt;&lt;<span class="number">20</span>)|(xor4.index((key&gt;&gt;<span class="number">0x10</span>)&amp;<span class="number">0xf</span>)&lt;&lt;<span class="number">16</span>)|(xor5.index((key&gt;&gt;<span class="number">0xc</span>)&amp;<span class="number">0xf</span>)&lt;&lt;<span class="number">12</span>)|(xor6.index((key&gt;&gt;<span class="number">0x8</span>)&amp;<span class="number">0xf</span>)&lt;&lt;<span class="number">8</span>)|(xor7.index((key&gt;&gt;<span class="number">0x4</span>)&amp;<span class="number">0xf</span>)&lt;&lt;<span class="number">4</span>)|(xor8.index((key)&amp;<span class="number">0xf</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode1</span>(<span class="params"><span class="built_in">input</span>,i0,i1</span>):</span><br><span class="line">	xor0_idx = <span class="number">0</span></span><br><span class="line">	key = <span class="built_in">input</span>[i1]</span><br><span class="line">	tmp = key_to_tmp(key)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">		key = <span class="built_in">input</span>[i0]</span><br><span class="line">		<span class="built_in">input</span>[i1] = key ^ tmp ^ xor0[idx[xor0_idx]]</span><br><span class="line">		<span class="built_in">input</span>[i0] = <span class="built_in">input</span>[i1]</span><br><span class="line">		tmp = key_to_tmp(key)</span><br><span class="line">		xor0_idx += <span class="number">1</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">input</span>[i1] = <span class="built_in">input</span>[i0] ^ xor0[idx[xor0_idx]] ^ tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode2</span>(<span class="params">what</span>):</span><br><span class="line">	input_byte = input_enc.copy()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">		what ^= <span class="number">0xa5</span></span><br><span class="line">		what -= input_byte[i]</span><br><span class="line">		<span class="keyword">if</span> what &lt; <span class="number">0</span>:</span><br><span class="line">			what += <span class="number">0x100</span></span><br><span class="line">		input_byte[i] = what ^ input_byte[i] ^ input_byte[(i+<span class="number">1</span>)&amp;<span class="number">0x1f</span>] ^ <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">		what ^= <span class="number">0xa5</span></span><br><span class="line">		what -= input_byte[i]</span><br><span class="line">		<span class="keyword">if</span> what &lt; <span class="number">0</span>:</span><br><span class="line">			what += <span class="number">0x100</span></span><br><span class="line">		input_byte[i] = what ^ input_byte[i] ^ input_byte[(i+<span class="number">1</span>)&amp;<span class="number">0x1f</span>] ^ <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> what == ((input_byte[<span class="number">0</span>] + input_byte[-<span class="number">1</span>]) &amp; <span class="number">0xff</span>):</span><br><span class="line">		dec = []</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">32</span>,<span class="number">4</span>):</span><br><span class="line">			dec.append(input_byte[i]|(input_byte[i+<span class="number">1</span>]&lt;&lt;<span class="number">8</span>)|(input_byte[i+<span class="number">2</span>]&lt;&lt;<span class="number">16</span>)|(input_byte[i+<span class="number">3</span>]&lt;&lt;<span class="number">24</span>))</span><br><span class="line">		decode_1.append(dec)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xff</span>):</span><br><span class="line">	decode2(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> decode_1:</span><br><span class="line">	decode1(i,<span class="number">0</span>,<span class="number">3</span>)</span><br><span class="line">	decode1(i,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">	decode1(i,<span class="number">4</span>,<span class="number">6</span>)</span><br><span class="line">	decode1(i,<span class="number">5</span>,<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> decode_1:</span><br><span class="line">	f = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">		f +=pack(<span class="string">&#x27;&lt;I&#x27;</span>,j)</span><br><span class="line">	<span class="built_in">print</span>(f)</span><br><span class="line"><span class="comment">#b&#x27;S3hr0din7er_3_Uni4er3al_D00rs111&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-crackme"><a href="#5-crackme" class="headerlink" title="5_crackme"></a>5_crackme</h3><p>è¿˜æ²¡å¤ç°ï¼Œå…ˆå ä¸ªä½ï¼Œç­‰å­¦å¼Ÿæµ‡æµ‡æˆ‘ç§»åŠ¨å®‰å…¨å†æ¥åšï¼ˆé€ƒ</p>
<h2 id="CISCN-åˆèµ›"><a href="#CISCN-åˆèµ›" class="headerlink" title="CISCN åˆèµ›"></a>CISCN åˆèµ›</h2><h3 id="baby-ast"><a href="#baby-ast" class="headerlink" title="baby ast"></a>baby ast</h3><p>ç®—æ˜¯æ‹–äº†å¾ˆä¹…ï¼Œå¯¹è¿™é¢˜å……æ»¡äº†ä¸æƒ³å¤ç°çš„ææƒ§â€¦â€¦å…¶å®æ¯”èµ›çš„æ—¶å€™æ—©å°±è£…å¥½swiftäº†ï¼Œä¹Ÿæƒ³è¿‡è‡ªå·±ç¼–è¯‘ä¸€æ®µè¯­æ³•æ ‘å‡ºæ¥å¯¹ç…§ä»£ç çœ‹çœ‹ï¼Œä½†æ˜¯æ€»è§‰å¾—å¾ˆéº»çƒ¦ï¼Œåˆè€ä¸ä¸‹å¿ƒå»çœ‹â€¦â€¦<br>æ€»è§‰å¾—å…«ç™¾å¤šè¡Œå¾ˆå¤šå¾ˆææƒ§ï¼Œä½†æ˜¯ç°åœ¨çœ‹ä¹Ÿå°±è¿˜è¡Œâ€¦â€¦</p>
<p>æµ‹è¯•ä»£ç <code>tmp.swift</code>ï¼šï¼ˆè¯­æ³•å¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œæˆ‘ä¹Ÿæ²¡ä»”ç»†çœ‹swiftçš„è¯­æ³•ï¼Œå‡‘åˆçœ‹8</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">check</span>(<span class="params">keyValue</span>: <span class="type">String</span>, <span class="params">encoded</span>: <span class="type">String</span>) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> a <span class="operator">=</span> <span class="number">9</span></span><br><span class="line">	<span class="keyword">let</span> b <span class="operator">=</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a <span class="operator">^</span> b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(check(<span class="string">&quot;1234&quot;</span>,<span class="string">&quot;dfgh&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> n <span class="operator">=</span> [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span><span class="operator">...</span><span class="number">3</span>&#123;</span><br><span class="line">	n[i] <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨å‘½ä»¤<code>swiftc  -dump-ast tmp.swift</code>æ¥å¾—åˆ°æŠ½è±¡è¯­æ³•æ ‘ã€‚</p>
<p><code>func check(keyValue: String, encoded: String) -&gt; Int &#123;</code>å¯¹åº”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(func_decl range=[tmp.swift:1:1 - line:6:1] &quot;check(keyValue:encoded:)&quot; interface type=&#x27;(String, String) -&gt; Int&#x27; access=internal</span><br><span class="line">  (parameter_list range=[tmp.swift:1:11 - line:1:45]</span><br><span class="line">    (parameter &quot;keyValue&quot; apiName=keyValue type=&#x27;String&#x27; interface type=&#x27;String&#x27;)</span><br><span class="line">    (parameter &quot;encoded&quot; apiName=encoded type=&#x27;String&#x27; interface type=&#x27;String&#x27;))</span><br><span class="line">  (result</span><br><span class="line">    (type_ident</span><br><span class="line">      (component id=&#x27;Int&#x27; bind=Swift.(file).Int)))</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥é¢˜ç›®é‡Œçš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(func_decl range=[re.swift:1:1 - line:14:1] &quot;check(_:_:)&quot; interface type=&#x27;(String, String) -&gt; Bool&#x27; access=internal</span><br><span class="line">  (parameter_list range=[re.swift:1:11 - line:1:49]</span><br><span class="line">    (parameter &quot;encoded&quot; type=&#x27;String&#x27; interface type=&#x27;String&#x27;)</span><br><span class="line">    (parameter &quot;keyValue&quot; type=&#x27;String&#x27; interface type=&#x27;String&#x27;))</span><br><span class="line">  (result</span><br><span class="line">    (type_ident</span><br><span class="line">      (component id=&#x27;Bool&#x27; bind=Swift.(file).Bool)))</span><br></pre></td></tr></table></figure>

<p>å¯¹åº”çš„åº”è¯¥å°±æ˜¯<code>check(_: String,_: String) -&gt; Bool</code>ï¼Œå³å®šä¹‰ä¸€ä¸ªcheckå‡½æ•°ï¼Œè¿”å›å€¼ä¸ºå¸ƒå°”ç±»å‹ã€‚</p>
<p><code>let a = 9</code>å¯¹åº”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(pattern_binding_decl range=[tmp.swift:2:5 - line:2:13]</span><br><span class="line">  (pattern_named type=&#x27;Int&#x27; &#x27;a&#x27;)</span><br><span class="line">  Original init:</span><br><span class="line">  (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:2:13 range=[tmp.swift:2:13 - line:2:13] value=9 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**)</span><br><span class="line">  Processed init:</span><br><span class="line">  (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:2:13 range=[tmp.swift:2:13 - line:2:13] value=9 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line"></span><br><span class="line">(var_decl range=[tmp.swift:2:9 - line:2:9] &quot;a&quot; type=&#x27;Int&#x27; interface type=&#x27;Int&#x27; access=private let readImpl=stored immutable)</span><br><span class="line"></span><br><span class="line">(pattern_binding_decl range=[tmp.swift:3:2 - line:3:10]</span><br></pre></td></tr></table></figure>

<p><code>let b = 10</code>åŒç†ã€‚</p>
<p><code>return a ^ b</code>å¯¹åº”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(return_stmt range=[tmp.swift:5:5 - line:5:16]</span><br><span class="line">  (binary_expr type=&#x27;Int&#x27; location=tmp.swift:5:14 range=[tmp.swift:5:12 - line:5:16] nothrow</span><br><span class="line">    (dot_syntax_call_expr implicit type=&#x27;(Int, Int) -&gt; Int&#x27; location=tmp.swift:5:14 range=[tmp.swift:5:14 - line:5:14] nothrow</span><br><span class="line">      (declref_expr type=&#x27;(Int.Type) -&gt; (Int, Int) -&gt; Int&#x27; location=tmp.swift:5:14 range=[tmp.swift:5:14 - line:5:14] decl=Swift.(file).Int extension.^ function_ref=single)</span><br><span class="line">      (argument_list implicit</span><br><span class="line">        (argument</span><br><span class="line">          (type_expr implicit type=&#x27;Int.Type&#x27; location=tmp.swift:5:14 range=[tmp.swift:5:14 - line:5:14] typerepr=&#x27;Int&#x27;))</span><br><span class="line">      ))</span><br><span class="line">    (argument_list implicit</span><br><span class="line">      (argument</span><br><span class="line">        (declref_expr type=&#x27;Int&#x27; location=tmp.swift:5:12 range=[tmp.swift:5:12 - line:5:12] decl=tmp.(file).check(keyValue:encoded:).a@tmp.swift:2:9 function_ref=unapplied))</span><br><span class="line">      (argument</span><br><span class="line">        (declref_expr type=&#x27;Int&#x27; location=tmp.swift:5:16 range=[tmp.swift:5:16 - line:5:16] decl=tmp.(file).check(keyValue:encoded:).b@tmp.swift:3:6 function_ref=unapplied))</span><br><span class="line">    )))))</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­è¿ç®—ç¬¦<code>^</code>åœ¨<code>extension.^</code></p>
<p><code>print(check(&quot;1234&quot;,&quot;dfgh&quot;))</code>å¯¹åº”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(top_level_code_decl range=[tmp.swift:8:1 - line:8:27]</span><br><span class="line">  (brace_stmt implicit range=[tmp.swift:8:1 - line:8:27]</span><br><span class="line">    (call_expr type=&#x27;&lt;null&gt;&#x27;</span><br><span class="line">      (overloaded_decl_ref_expr type=&#x27;&lt;null&gt;&#x27; name=print number_of_decls=2 function_ref=single decls=[</span><br><span class="line">        Swift.(file).print(_:separator:terminator:),</span><br><span class="line">        Swift.(file).print(_:separator:terminator:to:)])</span><br><span class="line">      (argument_list</span><br><span class="line">        (argument</span><br><span class="line">          (call_expr type=&#x27;&lt;null&gt;&#x27;</span><br><span class="line">            (declref_expr type=&#x27;&lt;null&gt;&#x27; decl=tmp.(file).check(keyValue:encoded:)@tmp.swift:1:6 function_ref=single)</span><br><span class="line">            (argument_list</span><br><span class="line">              (argument</span><br><span class="line">                (string_literal_expr type=&#x27;&lt;null&gt;&#x27; encoding=utf8 value=&quot;1234&quot; builtin_initializer=**NULL** initializer=**NULL**))</span><br><span class="line">              (argument</span><br><span class="line">                (string_literal_expr type=&#x27;&lt;null&gt;&#x27; encoding=utf8 value=&quot;dfgh&quot; builtin_initializer=**NULL** initializer=**NULL**))</span><br><span class="line">            )))</span><br><span class="line">      ))))</span><br></pre></td></tr></table></figure>

<p><code>let n = [0,1,2,3]</code>å¯¹åº”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">  (top_level_code_decl range=[tmp.swift:10:1 - line:10:17]</span><br><span class="line">    (brace_stmt implicit range=[tmp.swift:10:1 - line:10:17]</span><br><span class="line">      (pattern_binding_decl range=[tmp.swift:10:1 - line:10:17]</span><br><span class="line">        (pattern_named type=&#x27;[Int]&#x27; &#x27;n&#x27;)</span><br><span class="line">        Original init:</span><br><span class="line">        (array_expr type=&#x27;[Int]&#x27; location=tmp.swift:10:9 range=[tmp.swift:10:9 - line:10:17] initializer=Swift.(file).Array extension.init(arrayLiteral:) [with (substitution_map generic_signature=&lt;Element&gt; (substitution Element -&gt; Int))]</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:10:10 range=[tmp.swift:10:10 - line:10:10] value=0 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**)</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:10:12 range=[tmp.swift:10:12 - line:10:12] value=1 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**)</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:10:14 range=[tmp.swift:10:14 - line:10:14] value=2 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**)</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:10:16 range=[tmp.swift:10:16 - line:10:16] value=3 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">        Processed init:</span><br><span class="line">        (array_expr type=&#x27;[Int]&#x27; location=tmp.swift:10:9 range=[tmp.swift:10:9 - line:10:17] initializer=Swift.(file).Array extension.init(arrayLiteral:) [with (substitution_map generic_signature=&lt;Element&gt; (substitution Element -&gt; Int))]</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:10:10 range=[tmp.swift:10:10 - line:10:10] value=0 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**)</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:10:12 range=[tmp.swift:10:12 - line:10:12] value=1 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**)</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:10:14 range=[tmp.swift:10:14 - line:10:14] value=2 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**)</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:10:16 range=[tmp.swift:10:16 - line:10:16] value=3 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**)))</span><br><span class="line">))</span><br><span class="line">  (var_decl range=[tmp.swift:10:5 - line:10:5] &quot;n&quot; type=&#x27;[Int]&#x27; interface type=&#x27;[Int]&#x27; access=internal let readImpl=stored immutable)</span><br></pre></td></tr></table></figure>

<p><code>for i in 0...3&#123;&#125;</code>å¯¹åº”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(brace_stmt implicit range=[tmp.swift:11:1 - line:13:1]</span><br><span class="line">  (for_each_stmt range=[tmp.swift:11:1 - line:13:1]</span><br><span class="line">    (pattern_named type=&#x27;Int&#x27; &#x27;i&#x27;)</span><br><span class="line">    (pattern_named type=&#x27;Int&#x27; &#x27;i&#x27;)</span><br><span class="line">    (binary_expr type=&#x27;ClosedRange&lt;Int&gt;&#x27; location=tmp.swift:11:11 range=[tmp.swift:11:10 - line:11:14] nothrow</span><br><span class="line">      (dot_syntax_call_expr implicit type=&#x27;(Int, Int) -&gt; ClosedRange&lt;Int&gt;&#x27; location=tmp.swift:11:11 range=[tmp.swift:11:11 - line:11:11] nothrow</span><br><span class="line">        (declref_expr type=&#x27;(Int.Type) -&gt; (Int, Int) -&gt; ClosedRange&lt;Int&gt;&#x27; location=tmp.swift:11:11 range=[tmp.swift:11:11 - line:11:11] decl=Swift.(file).Comparable extension.... [with (substitution_map generic_signature=&lt;Self where Self : Comparable&gt; (substitution Self -&gt; Int))] function_ref=double)</span><br><span class="line">        (argument_list implicit</span><br><span class="line">          (argument</span><br><span class="line">            (type_expr implicit type=&#x27;Int.Type&#x27; location=tmp.swift:11:11 range=[tmp.swift:11:11 - line:11:11] typerepr=&#x27;Int&#x27;))</span><br><span class="line">        ))</span><br><span class="line">      (argument_list implicit</span><br><span class="line">        (argument</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:11:10 range=[tmp.swift:11:10 - line:11:10] value=0 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">        (argument</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:11:14 range=[tmp.swift:11:14 - line:11:14] value=3 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">      ))</span><br><span class="line">    (var_decl implicit range=[tmp.swift:11:7 - line:11:7] &quot;$i$generator&quot; type=&#x27;ClosedRange&lt;Int&gt;.Iterator&#x27; interface type=&#x27;ClosedRange&lt;Int&gt;.Iterator&#x27; access=fileprivate readImpl=stored writeImpl=stored readWriteImpl=stored)</span><br><span class="line"></span><br><span class="line">    (declref_expr implicit type=&#x27;@lvalue ClosedRange&lt;Int&gt;.Iterator&#x27; location=tmp.swift:11:7 range=[tmp.swift:11:7 - line:11:7] decl=tmp.(file).top-level code.$i$generator@tmp.swift:11:7 function_ref=unapplied)</span><br><span class="line">    (brace_stmt range=[tmp.swift:11:15 - line:13:1]</span><br></pre></td></tr></table></figure>

<p><code>for_each_stmt</code>åˆ›å»ºå¾ªç¯ã€‚</p>
<p><code>n[i] = 0</code>å¯¹åº”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(assign_expr type=&#x27;()&#x27; location=tmp.swift:12:7 range=[tmp.swift:12:2 - line:12:9]</span><br><span class="line">  (subscript_expr type=&#x27;@lvalue Int&#x27; location=tmp.swift:12:3 range=[tmp.swift:12:2 - line:12:5] decl=Swift.(file).Array extension.subscript(_:) [with (substitution_map generic_signature=&lt;Element&gt; (substitution Element -&gt; Int))]</span><br><span class="line">    (inout_expr implicit type=&#x27;inout Array&lt;Int&gt;&#x27; location=tmp.swift:12:2 range=[tmp.swift:12:2 - line:12:2]</span><br><span class="line">      (declref_expr type=&#x27;@lvalue [Int]&#x27; location=tmp.swift:12:2 range=[tmp.swift:12:2 - line:12:2] decl=tmp.(file).n@tmp.swift:10:5 function_ref=unapplied))</span><br><span class="line">    (argument_list</span><br><span class="line">      (argument</span><br><span class="line">        (declref_expr type=&#x27;Int&#x27; location=tmp.swift:12:4 range=[tmp.swift:12:4 - line:12:4] decl=tmp.(file).top-level code.i@tmp.swift:11:5 function_ref=unapplied))</span><br><span class="line">    ))</span><br><span class="line">  (integer_literal_expr type=&#x27;Int&#x27; location=tmp.swift:12:9 range=[tmp.swift:12:9 - line:12:9] value=0 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**)))))))</span><br></pre></td></tr></table></figure>

<p><code>extension.subscript(_:)</code>è¡¨ç¤ºåˆ‡ç‰‡æ“ä½œã€‚</p>
<p>é¢˜ç›®ä¸­åˆšå¼€å§‹å®šä¹‰äº†ä¸€ä¸ª<code>check(_: String,_: String) -&gt; Bool</code>ï¼Œç„¶åç»™ä¸¤ä¸ªå˜é‡bå’Œkèµ‹å€¼ï¼Œå¤§æ¦‚æ˜¯ç±»ä¼¼äºbytesçš„æ“ä½œï¼Œå³å¯¹å­—ç¬¦ä¸²è§£ç å­˜ä¸ºASCIIç ï¼Œç„¶åå®šä¹‰4ä¸ªå˜é‡r0,r1,r2,r3ã€‚</p>
<p>å®šä¹‰forå¾ªç¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">(for_each_stmt range=[re.swift:5:5 - line:12:5]</span><br><span class="line">  (pattern_named type=&#x27;Int&#x27; &#x27;i&#x27;)</span><br><span class="line">  (pattern_named type=&#x27;Int&#x27; &#x27;i&#x27;)</span><br><span class="line">  (binary_expr type=&#x27;ClosedRange&lt;Int&gt;&#x27; location=re.swift:5:15 range=[re.swift:5:14 - line:5:26] nothrow</span><br><span class="line">    (dot_syntax_call_expr implicit type=&#x27;(Int, Int) -&gt; ClosedRange&lt;Int&gt;&#x27; location=re.swift:5:15 range=[re.swift:5:15 - line:5:15] nothrow</span><br><span class="line">      (declref_expr type=&#x27;(Int.Type) -&gt; (Int, Int) -&gt; ClosedRange&lt;Int&gt;&#x27; location=re.swift:5:15 range=[re.swift:5:15 - line:5:15] decl=Swift.(file).Comparable extension.... [with (substitution_map generic_signature=&lt;Self where Self : Comparable&gt; (substitution Self -&gt; Int))] function_ref=double)</span><br><span class="line">      (argument_list implicit</span><br><span class="line">        (argument</span><br><span class="line">          (type_expr implicit type=&#x27;Int.Type&#x27; location=re.swift:5:15 range=[re.swift:5:15 - line:5:15] typerepr=&#x27;Int&#x27;))</span><br><span class="line">      ))</span><br><span class="line">    (argument_list implicit</span><br><span class="line">      (argument</span><br><span class="line">        (integer_literal_expr type=&#x27;Int&#x27; location=re.swift:5:14 range=[re.swift:5:14 - line:5:14] value=0 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">      (argument</span><br><span class="line">        (binary_expr type=&#x27;Int&#x27; location=re.swift:5:25 range=[re.swift:5:18 - line:5:26] nothrow</span><br><span class="line">          (dot_syntax_call_expr implicit type=&#x27;(Int, Int) -&gt; Int&#x27; location=re.swift:5:25 range=[re.swift:5:25 - line:5:25] nothrow</span><br><span class="line">            (declref_expr type=&#x27;(Int.Type) -&gt; (Int, Int) -&gt; Int&#x27; location=re.swift:5:25 range=[re.swift:5:25 - line:5:25] decl=Swift.(file).Int extension.- function_ref=double)</span><br><span class="line">            (argument_list implicit</span><br><span class="line">              (argument</span><br><span class="line">                (type_expr implicit type=&#x27;Int.Type&#x27; location=re.swift:5:25 range=[re.swift:5:25 - line:5:25] typerepr=&#x27;Int&#x27;))</span><br><span class="line">            ))</span><br><span class="line">          (argument_list implicit</span><br><span class="line">            (argument</span><br><span class="line">              (member_ref_expr type=&#x27;Int&#x27; location=re.swift:5:20 range=[re.swift:5:18 - line:5:20] decl=Swift.(file).Array extension.count [with (substitution_map generic_signature=&lt;Element&gt; (substitution Element -&gt; UInt8))]</span><br><span class="line">                (load_expr implicit type=&#x27;[UInt8]&#x27; location=re.swift:5:18 range=[re.swift:5:18 - line:5:18]</span><br><span class="line">                  (declref_expr type=&#x27;@lvalue [UInt8]&#x27; location=re.swift:5:18 range=[re.swift:5:18 - line:5:18] decl=re.(file).check(_:_:).b@re.swift:2:9 function_ref=unapplied))))</span><br><span class="line">            (argument</span><br><span class="line">              (integer_literal_expr type=&#x27;Int&#x27; location=re.swift:5:26 range=[re.swift:5:26 - line:5:26] value=4 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">          )))</span><br><span class="line">    ))</span><br><span class="line">  (var_decl implicit range=[re.swift:5:11 - line:5:11] &quot;$i$generator&quot; type=&#x27;ClosedRange&lt;Int&gt;.Iterator&#x27; interface type=&#x27;ClosedRange&lt;Int&gt;.Iterator&#x27; access=private readImpl=stored writeImpl=stored readWriteImpl=stored)</span><br><span class="line"></span><br><span class="line">  (declref_expr implicit type=&#x27;@lvalue ClosedRange&lt;Int&gt;.Iterator&#x27; location=re.swift:5:11 range=[re.swift:5:11 - line:5:11] decl=re.(file).check(_:_:).$i$generator@re.swift:5:11 function_ref=unapplied)</span><br><span class="line">  (brace_stmt range=[re.swift:5:27 - line:12:5]</span><br></pre></td></tr></table></figure>

<p><code>extension....</code>è¡¨ç¤º<code>for i in x...y</code>çš„å½¢å¼ï¼Œxå’Œyå¯ä»¥æ ¹æ®ç¼©è¿›æ¥åˆ¤æ–­ã€‚<br>xå®šä¹‰åœ¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(argument</span><br><span class="line">  (integer_literal_expr type=&#x27;Int&#x27; location=re.swift:5:14 range=[re.swift:5:14 - line:5:14] value=0 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br></pre></td></tr></table></figure>
<p>å³x=0ã€‚</p>
<p>yå®šä¹‰åœ¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">  (argument</span><br><span class="line">    (binary_expr type=&#x27;Int&#x27; location=re.swift:5:25 range=[re.swift:5:18 - line:5:26] nothrow</span><br><span class="line">      (dot_syntax_call_expr implicit type=&#x27;(Int, Int) -&gt; Int&#x27; location=re.swift:5:25 range=[re.swift:5:25 - line:5:25] nothrow</span><br><span class="line">        (declref_expr type=&#x27;(Int.Type) -&gt; (Int, Int) -&gt; Int&#x27; location=re.swift:5:25 range=[re.swift:5:25 - line:5:25] decl=Swift.(file).Int extension.- function_ref=double)</span><br><span class="line">        (argument_list implicit</span><br><span class="line">          (argument</span><br><span class="line">            (type_expr implicit type=&#x27;Int.Type&#x27; location=re.swift:5:25 range=[re.swift:5:25 - line:5:25] typerepr=&#x27;Int&#x27;))</span><br><span class="line">        ))</span><br><span class="line">      (argument_list implicit</span><br><span class="line">        (argument</span><br><span class="line">          (member_ref_expr type=&#x27;Int&#x27; location=re.swift:5:20 range=[re.swift:5:18 - line:5:20] decl=Swift.(file).Array extension.count [with (substitution_map generic_signature=&lt;Element&gt; (substitution Element -&gt; UInt8))]</span><br><span class="line">            (load_expr implicit type=&#x27;[UInt8]&#x27; location=re.swift:5:18 range=[re.swift:5:18 - line:5:18]</span><br><span class="line">              (declref_expr type=&#x27;@lvalue [UInt8]&#x27; location=re.swift:5:18 range=[re.swift:5:18 - line:5:18] decl=re.(file).check(_:_:).b@re.swift:2:9 function_ref=unapplied))))</span><br><span class="line">        (argument</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=re.swift:5:26 range=[re.swift:5:26 - line:5:26] value=4 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">      )))</span><br><span class="line">))</span><br></pre></td></tr></table></figure>

<p>å³<code>y=b.count-4</code>ï¼Œç¿»è¯‘æˆpythonå°±æ˜¯<code>y=len(b)-4</code>ã€‚<br>ç”±äºswiftçš„for inå¾ªç¯å«é¦–ä¹Ÿå«å°¾ï¼Œæ‰€ä»¥è¿™å¥ç¿»è¯‘æˆpythonçš„å½¢å¼åº”è¯¥æ˜¯<code>for i in range(len(b)-4+1)</code></p>
<p>å†å¾€ä¸‹ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(tuple_expr type=&#x27;(@lvalue UInt8, @lvalue UInt8, @lvalue UInt8, @lvalue UInt8)&#x27; location=re.swift:6:9 range=[re.swift:6:9 - line:6:24] names=&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;</span><br><span class="line">  (declref_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:6:10 range=[re.swift:6:10 - line:6:10] decl=re.(file).check(_:_:).r0@re.swift:4:9 function_ref=unapplied)</span><br><span class="line">  (declref_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:6:14 range=[re.swift:6:14 - line:6:14] decl=re.(file).check(_:_:).r1@re.swift:4:13 function_ref=unapplied)</span><br><span class="line">  (declref_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:6:18 range=[re.swift:6:18 - line:6:18] decl=re.(file).check(_:_:).r2@re.swift:4:17 function_ref=unapplied)</span><br><span class="line">  (declref_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:6:22 range=[re.swift:6:22 - line:6:22] decl=re.(file).check(_:_:).r3@re.swift:4:21 function_ref=unapplied))</span><br></pre></td></tr></table></figure>
<p>å³<code>r0,r1,r2,r3 = </code></p>
<p>ä¸‹ä¸€æ­¥åˆ‡ç‰‡æ“ä½œï¼Œä»¥ç¬¬2ä¸ªä¸ºä¾‹ï¼Œå³</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">(subscript_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:6:36 range=[re.swift:6:35 - line:6:40] decl=Swift.(file).Array extension.subscript(_:) [with (substitution_map generic_signature=&lt;Element&gt; (substitution Element -&gt; UInt8))]</span><br><span class="line">  (inout_expr implicit type=&#x27;inout Array&lt;UInt8&gt;&#x27; location=re.swift:6:35 range=[re.swift:6:35 - line:6:35]</span><br><span class="line">    (declref_expr type=&#x27;@lvalue [UInt8]&#x27; location=re.swift:6:35 range=[re.swift:6:35 - line:6:35] decl=re.(file).check(_:_:).b@re.swift:2:9 function_ref=unapplied))</span><br><span class="line">  (argument_list</span><br><span class="line">    (argument</span><br><span class="line">      (binary_expr type=&#x27;Int&#x27; location=re.swift:6:38 range=[re.swift:6:37 - line:6:39] nothrow</span><br><span class="line">        (dot_syntax_call_expr implicit type=&#x27;(Int, Int) -&gt; Int&#x27; location=re.swift:6:38 range=[re.swift:6:38 - line:6:38] nothrow</span><br><span class="line">          (declref_expr type=&#x27;(Int.Type) -&gt; (Int, Int) -&gt; Int&#x27; location=re.swift:6:38 range=[re.swift:6:38 - line:6:38] decl=Swift.(file).Int extension.+ function_ref=double)</span><br><span class="line">          (argument_list implicit</span><br><span class="line">            (argument</span><br><span class="line">              (type_expr implicit type=&#x27;Int.Type&#x27; location=re.swift:6:38 range=[re.swift:6:38 - line:6:38] typerepr=&#x27;Int&#x27;))</span><br><span class="line">          ))</span><br><span class="line">        (argument_list implicit</span><br><span class="line">          (argument</span><br><span class="line">            (declref_expr type=&#x27;Int&#x27; location=re.swift:6:37 range=[re.swift:6:37 - line:6:37] decl=re.(file).check(_:_:).i@re.swift:5:9 function_ref=unapplied))</span><br><span class="line">          (argument</span><br><span class="line">            (integer_literal_expr type=&#x27;Int&#x27; location=re.swift:6:39 range=[re.swift:6:39 - line:6:39] value=1 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">        )))</span><br><span class="line">  )))</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­æ“ä½œå¯¹è±¡æ˜¯bï¼ˆ<code>re.(file).check(_:_:).b@re.swift</code>ï¼‰å’Œiï¼ˆ<code>re.(file).check(_:_:).i@re.swift</code>ï¼‰ï¼Œè¿ç®—ç¬¦æ˜¯+ï¼ˆ<code>extension.+</code>ï¼‰ï¼Œå€¼ä¸º1ï¼Œå³<code>b[i+1]</code></p>
<p>æ•´ç†ä¸€ä¸‹å°±æ˜¯<code>r0,r1,r2,r3=b[i],b[i+1],b[i+2],b[i+3]</code></p>
<p>åŠ å¯†éƒ¨åˆ†ç¬¬ä¸€å¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">(assign_expr type=&#x27;()&#x27; location=re.swift:7:16 range=[re.swift:7:9 - line:7:49]</span><br><span class="line">  (subscript_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:7:10 range=[re.swift:7:9 - line:7:14] decl=Swift.(file).Array extension.subscript(_:) [with (substitution_map generic_signature=&lt;Element&gt; (substitution Element -&gt; UInt8))]</span><br><span class="line">    (inout_expr implicit type=&#x27;inout Array&lt;UInt8&gt;&#x27; location=re.swift:7:9 range=[re.swift:7:9 - line:7:9]</span><br><span class="line">      (declref_expr type=&#x27;@lvalue [UInt8]&#x27; location=re.swift:7:9 range=[re.swift:7:9 - line:7:9] decl=re.(file).check(_:_:).b@re.swift:2:9 function_ref=unapplied))</span><br><span class="line">    (argument_list</span><br><span class="line">      (argument</span><br><span class="line">        (binary_expr type=&#x27;Int&#x27; location=re.swift:7:12 range=[re.swift:7:11 - line:7:13] nothrow</span><br><span class="line">          (dot_syntax_call_expr implicit type=&#x27;(Int, Int) -&gt; Int&#x27; location=re.swift:7:12 range=[re.swift:7:12 - line:7:12] nothrow</span><br><span class="line">            (declref_expr type=&#x27;(Int.Type) -&gt; (Int, Int) -&gt; Int&#x27; location=re.swift:7:12 range=[re.swift:7:12 - line:7:12] decl=Swift.(file).Int extension.+ function_ref=double)</span><br><span class="line">            (argument_list implicit</span><br><span class="line">              (argument</span><br><span class="line">                (type_expr implicit type=&#x27;Int.Type&#x27; location=re.swift:7:12 range=[re.swift:7:12 - line:7:12] typerepr=&#x27;Int&#x27;))</span><br><span class="line">            ))</span><br><span class="line">          (argument_list implicit</span><br><span class="line">            (argument</span><br><span class="line">              (declref_expr type=&#x27;Int&#x27; location=re.swift:7:11 range=[re.swift:7:11 - line:7:11] decl=re.(file).check(_:_:).i@re.swift:5:9 function_ref=unapplied))</span><br><span class="line">            (argument</span><br><span class="line">              (integer_literal_expr type=&#x27;Int&#x27; location=re.swift:7:13 range=[re.swift:7:13 - line:7:13] value=0 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">          )))</span><br><span class="line">    ))</span><br><span class="line">  (binary_expr type=&#x27;UInt8&#x27; location=re.swift:7:21 range=[re.swift:7:18 - line:7:49] nothrow</span><br><span class="line">    (dot_syntax_call_expr implicit type=&#x27;(UInt8, UInt8) -&gt; UInt8&#x27; location=re.swift:7:21 range=[re.swift:7:21 - line:7:21] nothrow</span><br><span class="line">      (declref_expr type=&#x27;(UInt8.Type) -&gt; (UInt8, UInt8) -&gt; UInt8&#x27; location=re.swift:7:21 range=[re.swift:7:21 - line:7:21] decl=Swift.(file).UInt8 extension.^ function_ref=single)</span><br><span class="line">      (argument_list implicit</span><br><span class="line">        (argument</span><br><span class="line">          (type_expr implicit type=&#x27;UInt8.Type&#x27; location=re.swift:7:21 range=[re.swift:7:21 - line:7:21] typerepr=&#x27;UInt8&#x27;))</span><br><span class="line">      ))</span><br><span class="line">    (argument_list implicit</span><br><span class="line">      (argument</span><br><span class="line">        (load_expr implicit type=&#x27;UInt8&#x27; location=re.swift:7:18 range=[re.swift:7:18 - line:7:18]</span><br><span class="line">          (declref_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:7:18 range=[re.swift:7:18 - line:7:18] decl=re.(file).check(_:_:).r2@re.swift:4:17 function_ref=unapplied)))</span><br><span class="line">      (argument</span><br><span class="line">        (paren_expr type=&#x27;(UInt8)&#x27; location=re.swift:7:43 range=[re.swift:7:23 - line:7:49]</span><br><span class="line">          (binary_expr type=&#x27;UInt8&#x27; location=re.swift:7:43 range=[re.swift:7:24 - line:7:45] nothrow</span><br><span class="line">            (dot_syntax_call_expr implicit type=&#x27;(UInt8, UInt8) -&gt; UInt8&#x27; location=re.swift:7:43 range=[re.swift:7:43 - line:7:43] nothrow</span><br><span class="line">              (declref_expr type=&#x27;(UInt8.Type) -&gt; (UInt8, UInt8) -&gt; UInt8&#x27; location=re.swift:7:43 range=[re.swift:7:43 - line:7:43] decl=Swift.(file).UInt8 extension.&amp; function_ref=double)</span><br><span class="line">              (argument_list implicit</span><br><span class="line">                (argument</span><br><span class="line">                  (type_expr implicit type=&#x27;UInt8.Type&#x27; location=re.swift:7:43 range=[re.swift:7:43 - line:7:43] typerepr=&#x27;UInt8&#x27;))</span><br><span class="line">              ))</span><br><span class="line">            (argument_list implicit</span><br><span class="line">              (argument</span><br><span class="line">                (paren_expr type=&#x27;(UInt8)&#x27; location=re.swift:7:30 range=[re.swift:7:24 - line:7:41]</span><br><span class="line">                  (binary_expr type=&#x27;UInt8&#x27; location=re.swift:7:30 range=[re.swift:7:25 - line:7:40] nothrow</span><br><span class="line">                    (dot_syntax_call_expr implicit type=&#x27;(UInt8, UInt8) -&gt; UInt8&#x27; location=re.swift:7:30 range=[re.swift:7:30 - line:7:30] nothrow</span><br><span class="line">                      (declref_expr type=&#x27;(UInt8.Type) -&gt; (UInt8, UInt8) -&gt; UInt8&#x27; location=re.swift:7:30 range=[re.swift:7:30 - line:7:30] decl=Swift.(file).UInt8 extension.+ function_ref=double)</span><br><span class="line">                      (argument_list implicit</span><br><span class="line">                        (argument</span><br><span class="line">                          (type_expr implicit type=&#x27;UInt8.Type&#x27; location=re.swift:7:30 range=[re.swift:7:30 - line:7:30] typerepr=&#x27;UInt8&#x27;))</span><br><span class="line">                      ))</span><br><span class="line">                    (argument_list implicit</span><br><span class="line">                      (argument</span><br><span class="line">                        (load_expr implicit type=&#x27;UInt8&#x27; location=re.swift:7:26 range=[re.swift:7:25 - line:7:28]</span><br><span class="line">                          (subscript_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:7:26 range=[re.swift:7:25 - line:7:28] decl=Swift.(file).Array extension.subscript(_:) [with (substitution_map generic_signature=&lt;Element&gt; (substitution Element -&gt; UInt8))]</span><br><span class="line">                            (inout_expr implicit type=&#x27;inout Array&lt;UInt8&gt;&#x27; location=re.swift:7:25 range=[re.swift:7:25 - line:7:25]</span><br><span class="line">                              (declref_expr type=&#x27;@lvalue [UInt8]&#x27; location=re.swift:7:25 range=[re.swift:7:25 - line:7:25] decl=re.(file).check(_:_:).k@re.swift:3:9 function_ref=unapplied))</span><br><span class="line">                            (argument_list</span><br><span class="line">                              (argument</span><br><span class="line">                                (integer_literal_expr type=&#x27;Int&#x27; location=re.swift:7:27 range=[re.swift:7:27 - line:7:27] value=0 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">                            ))))</span><br><span class="line">                      (argument</span><br><span class="line">                        (paren_expr type=&#x27;(UInt8)&#x27; location=re.swift:7:36 range=[re.swift:7:32 - line:7:40]</span><br><span class="line">                          (binary_expr type=&#x27;UInt8&#x27; location=re.swift:7:36 range=[re.swift:7:33 - line:7:39] nothrow</span><br><span class="line">                            (dot_syntax_call_expr implicit type=&#x27;(UInt8, Int) -&gt; UInt8&#x27; location=re.swift:7:36 range=[re.swift:7:36 - line:7:36] nothrow</span><br><span class="line">                              (declref_expr type=&#x27;(UInt8.Type) -&gt; (UInt8, Int) -&gt; UInt8&#x27; location=re.swift:7:36 range=[re.swift:7:36 - line:7:36] decl=Swift.(file).FixedWidthInteger extension.&gt;&gt; [with (substitution_map generic_signature=&lt;Self, Other where Self : FixedWidthInteger, Other : BinaryInteger&gt; (substitution Self -&gt; UInt8) (substitution Other -&gt; Int))] function_ref=double)</span><br><span class="line">                              (argument_list implicit</span><br><span class="line">                                (argument</span><br><span class="line">                                  (type_expr implicit type=&#x27;UInt8.Type&#x27; location=re.swift:7:36 range=[re.swift:7:36 - line:7:36] typerepr=&#x27;UInt8&#x27;))</span><br><span class="line">                              ))</span><br><span class="line">                            (argument_list implicit</span><br><span class="line">                              (argument</span><br><span class="line">                                (load_expr implicit type=&#x27;UInt8&#x27; location=re.swift:7:33 range=[re.swift:7:33 - line:7:33]</span><br><span class="line">                                  (declref_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:7:33 range=[re.swift:7:33 - line:7:33] decl=re.(file).check(_:_:).r0@re.swift:4:9 function_ref=unapplied)))</span><br><span class="line">                              (argument</span><br><span class="line">                                (integer_literal_expr type=&#x27;Int&#x27; location=re.swift:7:39 range=[re.swift:7:39 - line:7:39] value=4 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">                            ))))</span><br><span class="line">                    ))))</span><br><span class="line">              (argument</span><br><span class="line">                (integer_literal_expr type=&#x27;UInt8&#x27; location=re.swift:7:45 range=[re.swift:7:45 - line:7:45] value=0xff builtin_initializer=Swift.(file).UInt8.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">            ))))</span><br><span class="line">    )))</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€å¥æ˜¯ç”±å¤šä¸ªå­å¥æ„æˆï¼Œä»æœ€å†…å±‚çš„ç¼©è¿›çœ‹èµ·ï¼Œæœ€å†…å±‚çš„ä¸¤ä¸ªå­å¥åˆ†åˆ«æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(argument</span><br><span class="line">  (load_expr implicit type=&#x27;UInt8&#x27; location=re.swift:7:26 range=[re.swift:7:25 - line:7:28]</span><br><span class="line">    (subscript_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:7:26 range=[re.swift:7:25 - line:7:28] decl=Swift.(file).Array extension.subscript(_:) [with (substitution_map generic_signature=&lt;Element&gt; (substitution Element -&gt; UInt8))]</span><br><span class="line">      (inout_expr implicit type=&#x27;inout Array&lt;UInt8&gt;&#x27; location=re.swift:7:25 range=[re.swift:7:25 - line:7:25]</span><br><span class="line">        (declref_expr type=&#x27;@lvalue [UInt8]&#x27; location=re.swift:7:25 range=[re.swift:7:25 - line:7:25] decl=re.(file).check(_:_:).k@re.swift:3:9 function_ref=unapplied))</span><br><span class="line">      (argument_list</span><br><span class="line">        (argument</span><br><span class="line">          (integer_literal_expr type=&#x27;Int&#x27; location=re.swift:7:27 range=[re.swift:7:27 - line:7:27] value=0 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">      ))))</span><br></pre></td></tr></table></figure>

<p>å³<code>k[0]</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(dot_syntax_call_expr implicit type=&#x27;(UInt8, Int) -&gt; UInt8&#x27; location=re.swift:7:36 range=[re.swift:7:36 - line:7:36] nothrow</span><br><span class="line">  (declref_expr type=&#x27;(UInt8.Type) -&gt; (UInt8, Int) -&gt; UInt8&#x27; location=re.swift:7:36 range=[re.swift:7:36 - line:7:36] decl=Swift.(file).FixedWidthInteger extension.&gt;&gt; [with (substitution_map generic_signature=&lt;Self, Other where Self : FixedWidthInteger, Other : BinaryInteger&gt; (substitution Self -&gt; UInt8) (substitution Other -&gt; Int))] function_ref=double)</span><br><span class="line">  (argument_list implicit</span><br><span class="line">    (argument</span><br><span class="line">      (type_expr implicit type=&#x27;UInt8.Type&#x27; location=re.swift:7:36 range=[re.swift:7:36 - line:7:36] typerepr=&#x27;UInt8&#x27;))</span><br><span class="line">  ))</span><br><span class="line">(argument_list implicit</span><br><span class="line">  (argument</span><br><span class="line">    (load_expr implicit type=&#x27;UInt8&#x27; location=re.swift:7:33 range=[re.swift:7:33 - line:7:33]</span><br><span class="line">      (declref_expr type=&#x27;@lvalue UInt8&#x27; location=re.swift:7:33 range=[re.swift:7:33 - line:7:33] decl=re.(file).check(_:_:).r0@re.swift:4:9 function_ref=unapplied)))</span><br><span class="line">  (argument</span><br><span class="line">    (integer_literal_expr type=&#x27;Int&#x27; location=re.swift:7:39 range=[re.swift:7:39 - line:7:39] value=4 builtin_initializer=Swift.(file).Int.init(_builtinIntegerLiteral:) initializer=**NULL**))</span><br><span class="line">))))</span><br></pre></td></tr></table></figure>

<p>å³<code>r0&gt;&gt;4</code></p>
<p>å¤„äºåŒä¸€ç¼©è¿›çš„å­å¥æ˜¯åŒçº§çš„å…³ç³»ï¼Œä¸¤å­å¥çš„è¿ç®—ç¬¦è¦åœ¨æ¬¡ä¸€çº§ç¼©è¿›å¤„æ‰¾ã€‚</p>
<p><img src="/img/code/chall_photo/ciscn-1.png"></p>
<p>å³<code>k[0]+(r0&gt;&gt;4)</code></p>
<p>æ­¤åè¿‡ç¨‹å¤§è‡´ç›¸åŒï¼Œè¿™ä¸€å¥ç¿»è¯‘è¿‡æ¥å³<code>b[i]^=(k[0]+(r0&gt;&gt;4))&amp;0xff</code>ï¼ŒåŒç†ï¼Œä¸‹ä¸€æ®µæ˜¯<code>b[i+1]^=(k[1]+(r1&gt;&gt;4))&amp;0xff</code></p>
<p>å®Œæ•´åŠ å¯†è¿‡ç¨‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)-<span class="number">4</span>+<span class="number">1</span>):</span><br><span class="line">  r0,r1,r2,r3=b[i],b[i+<span class="number">1</span>],b[i+<span class="number">2</span>],b[i+<span class="number">3</span>]</span><br><span class="line">  b[i]^=(k[<span class="number">0</span>]+(r0&gt;&gt;<span class="number">4</span>))&amp;<span class="number">0xff</span></span><br><span class="line">  b[i+<span class="number">1</span>]^=(k[<span class="number">1</span>]+(r1&gt;&gt;<span class="number">4</span>))&amp;<span class="number">0xff</span></span><br><span class="line">  b[i+<span class="number">2</span>]^=k[<span class="number">2</span>]</span><br><span class="line">  b[i+<span class="number">3</span>]^=k[<span class="number">3</span>]</span><br><span class="line">  k[<span class="number">0</span>],k[<span class="number">1</span>],k[<span class="number">2</span>],k[<span class="number">3</span>]=k[<span class="number">1</span>],k[<span class="number">2</span>],k[<span class="number">3</span>],k[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<p>ç¨‹åºä½¿ç”¨çš„å¯†æ–‡å¯ä»¥åœ¨äº”ç™¾å¤šè¡Œçš„åœ°æ–¹è·å–åˆ°ï¼Œå¯†é’¥æ˜¯<code>&quot;345y&quot;</code>ã€‚æ®æ­¤å†™å‡ºè§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">b=[<span class="number">88</span>,<span class="number">35</span>,<span class="number">88</span>,<span class="number">225</span>,<span class="number">7</span>,<span class="number">201</span>,<span class="number">57</span>,<span class="number">94</span>,<span class="number">77</span>,<span class="number">56</span>,<span class="number">75</span>,<span class="number">168</span>,<span class="number">72</span>,<span class="number">218</span>,<span class="number">64</span>,<span class="number">91</span>,<span class="number">16</span>,<span class="number">101</span>,<span class="number">32</span>,<span class="number">207</span>,<span class="number">73</span>,<span class="number">130</span>,<span class="number">74</span>,<span class="number">128</span>,<span class="number">76</span>,<span class="number">201</span>,<span class="number">16</span>,<span class="number">248</span>,<span class="number">41</span>,<span class="number">205</span>,<span class="number">103</span>,<span class="number">84</span>,<span class="number">91</span>,<span class="number">99</span>,<span class="number">79</span>,<span class="number">202</span>,<span class="number">22</span>,<span class="number">131</span>,<span class="number">63</span>,<span class="number">255</span>,<span class="number">20</span>,<span class="number">16</span>]</span><br><span class="line">k = <span class="built_in">list</span>(<span class="string">b&#x27;y345&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)-<span class="number">4</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">  k[<span class="number">1</span>],k[<span class="number">2</span>],k[<span class="number">3</span>],k[<span class="number">0</span>] = k[<span class="number">0</span>],k[<span class="number">1</span>],k[<span class="number">2</span>],k[<span class="number">3</span>]</span><br><span class="line">  r1 = b[i+<span class="number">3</span>] ^ k[<span class="number">3</span>]</span><br><span class="line">  r0 = b[i+<span class="number">2</span>] ^ k[<span class="number">2</span>]</span><br><span class="line">  r3 = b[i+<span class="number">1</span>] ^ ((k[<span class="number">1</span>]+(r1&gt;&gt;<span class="number">2</span>))&amp;<span class="number">0xff</span>)</span><br><span class="line">  r2 = b[i] ^ ((k[<span class="number">0</span>]+(r0&gt;&gt;<span class="number">4</span>))&amp;<span class="number">0xff</span>)</span><br><span class="line">  b[i],b[i+<span class="number">1</span>],b[i+<span class="number">2</span>],b[i+<span class="number">3</span>]=r0,r1,r2,r3</span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">  <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#flag&#123;30831242-56db-45b4-96fd-1f47e60da99d&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="babycode"><a href="#babycode" class="headerlink" title="babycode"></a>babycode</h3><p>è¦è£…mrubyï¼Œå…ˆè£…rubyï¼Œå†è£…doxygenï¼Œæ³¨æ„æŠŠdoxygenæ”¾åˆ°ç¯å¢ƒå˜é‡é‡Œï¼Œæœ€åæ‰èƒ½è£…mrubyâ€¦â€¦<br>ç¼–è¯‘å¥½ä¹‹ååœ¨binç›®å½•ä¸‹å¯ä»¥åç¼–è¯‘ã€‚</p>
<p><code>.\mruby -v -b .\babycode.mrb &gt; ruby.txt</code></p>
<p><del>åŒºåŒºä¸‰ç™¾å¤šè¡Œï¼Œçœ‹æˆ‘æ‰‹æ’•</del><br>å±®â€¦â€¦æœ€å¼€å§‹è¾“å‡ºçš„å­—èŠ‚ç å°‘äº†å››åå¤šè¡Œï¼Œæˆ‘å°±è¯´ä¸ºä»€ä¹ˆæ²¡æœ‰å¯†æ–‡å¯†é’¥ï¼Œè€Œä¸”é‚£ä¸ªcheckæ–¹æ³•çœ‹èµ·æ¥é‚£ä¹ˆå¥‡æ€ªâ€¦â€¦å¿ƒç´¯<br>ä¸æƒ³å†çœ‹ä¸€éäº†<br>åˆå› ä¸ºè¿ç®—ä¼˜å…ˆçº§å‡ºé”…äº†â€¦â€¦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">enc = <span class="string">b&#x27;f469358b7f165145116e127ad6105917bce5225d6d62a714c390c5ed93b22d8b6b102a8813488fdb&#x27;</span></span><br><span class="line">key = <span class="string">b&#x27;aaaassssddddffff&#x27;</span></span><br><span class="line">key = struct.unpack(<span class="string">&#x27;LLLL&#x27;</span>, key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">num1, num2, key</span>):</span><br><span class="line">      XX = <span class="number">0x12345678</span></span><br><span class="line">      s = XX*<span class="number">16</span></span><br><span class="line">      y = num1</span><br><span class="line">      z = num2</span><br><span class="line">      <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        z -= (((y&lt;&lt;<span class="number">3</span>)^(y&gt;&gt;<span class="number">5</span>))+y) ^ (key[(s+<span class="number">1</span>)&amp;<span class="number">3</span>]+s)</span><br><span class="line">        z &amp;= <span class="number">0xffffffff</span></span><br><span class="line">        s -= XX</span><br><span class="line">        y -= (((z&lt;&lt;<span class="number">3</span>)^(z&gt;&gt;<span class="number">5</span>))+z) ^ (key[((s&gt;&gt;<span class="number">11</span>)+<span class="number">1</span>)&amp;<span class="number">3</span>]+s)</span><br><span class="line">        y &amp;= <span class="number">0xffffffff</span></span><br><span class="line">      <span class="keyword">return</span> struct.pack(<span class="string">&#x27;&gt;I&#x27;</span>,y), struct.pack(<span class="string">&#x27;&gt;I&#x27;</span>,z)</span><br><span class="line"></span><br><span class="line">dec = []</span><br><span class="line">b = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(enc),<span class="number">8</span>):</span><br><span class="line">  dec.append(<span class="built_in">int</span>(enc[i:i+<span class="number">8</span>],<span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(dec),<span class="number">2</span>):</span><br><span class="line">  x,y = decode(dec[i],dec[i+<span class="number">1</span>],key)</span><br><span class="line">  b += x + y</span><br><span class="line">dec = [i <span class="keyword">for</span> i <span class="keyword">in</span> b]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dec)):</span><br><span class="line">  l = <span class="number">0</span> <span class="keyword">if</span> i==<span class="number">0</span> <span class="keyword">else</span> dec[i-<span class="number">1</span>]</span><br><span class="line">  dec[i] ^= l ^ (i+<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,dec)))</span><br><span class="line"><span class="comment"># flag&#123;6ad1c70c-daa4-11ec-9d64-0242ac1200&#125;</span></span><br></pre></td></tr></table></figure>

<p>å‚è€ƒæ–‡ç« ï¼š<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/253572#h2-1">https://www.anquanke.com/post/id/253572#h2-1</a></p>

    </div>

    <div class="about">
        <h1>å…³äºæœ¬æ–‡</h1>
        <p>æœ¬æ–‡ä½œè€… äº‘ä¹‹å›, è®¸å¯ç”± <a
                target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
    </div>

    
        
    
</article>
        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h4 class="title">Blog</h4>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/CTF" class="item">CTF</a>
                
                <a href="/Learn" class="item">Learn</a>
                
                <a href="/Dairy" class="item">Dairy</a>
                
                <a href="/Alkaid" class="item">Alkaid</a>
                
                <a href="/friends" class="item">Friends</a>
                
            </div>
            
            <div class="group">
                <h4 class="title">Me</h4>
                
                <a target="_blank" rel="noopener" href="https://github.com/YunZh1Jun" class="item">GitHub</a>
                
                <a href="yunzh1jun@qq.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2022 äº‘ä¹‹å›<br >é©±åŠ¨ç”± <a href="http://hexo.io/" target="_blank">Hexo</a></span>
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
    </body>
</html>