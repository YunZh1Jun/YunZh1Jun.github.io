<!DOCTYPE html>
<html lang="zh-cn">
    <!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>å¼ºç½‘æ¯2022 åˆèµ›Reverse å¤ç° - äº‘ä¹‹å›&#39;s Blog</title>
  
    <link rel="shortcut icon" href="/theme-img/fav/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/waline.css">

  
  
  
<link rel="stylesheet" href="/css/post.css">

  

  
    
<script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
 
  

  
<meta name="generator" content="Hexo 5.4.2"></head>
    <body data-color-scheme="auto">
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">äº‘ä¹‹å›&#39;s Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">ä¸»é¡µ</a>
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/CTF">CTF</a>
            
            
            
            <a class="nav-item" href="/Learn">Learn</a>
            
            
            
            <a class="nav-item" href="/Dairy">Dairy</a>
            
            
            
            <a class="nav-item" href="/Alkaid">Alkaid</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/YunZh1Jun" target="_blank">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        <article class="post">
    <div class="meta">
        
        <div class="date" id="date">
            
            
            
            
            
            
            
            
            
            <span>September</span>
            
            
            
            
            <span>18,</span>
            <span>2022</span>
        </div>
        

        <h2 class="title">å¼ºç½‘æ¯2022 åˆèµ›Reverse å¤ç°</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p>ç»ˆäºå¼€å§‹ç¼“æ…¢å¤ç°å¼ºpwnæ¯äº†</p>
<span id="more"></span>

<h2 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h2><p>è¿™é¢˜æˆ‘çœŸçš„æ˜¯æ°”æ­»äº†å•Šå•Šå•Šå•Šå•Šå•Šæµªè´¹æˆ‘ä¸€å¤©æ—¶é—´ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p>
<h3 id="åˆæ­¥åˆ†æ"><a href="#åˆæ­¥åˆ†æ" class="headerlink" title="åˆæ­¥åˆ†æ"></a>åˆæ­¥åˆ†æ</h3><p>å…ˆfingerä¸€æŠŠæ¢­äº†æ¢å¤ç¬¦å·è¡¨ã€‚</p>
<p>ä¸»å‡½æ•°ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// r8</span></span><br><span class="line">  __int64 v4; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// er8</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// er9</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+0h] [rbp-20h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  sub_402150();</span><br><span class="line">  v9 = fork();</span><br><span class="line">  <span class="keyword">if</span> ( v9 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_401F2F(v9);</span><br><span class="line">    remove(<span class="string">&quot;re3&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sys_ptrace(<span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>, v3, v4, (<span class="type">char</span>)argv);</span><br><span class="line">    sub_44B680((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;re3&quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;re3&quot;</span>, *(_QWORD *)(v8 + <span class="number">8</span>), <span class="number">0</span>, v5, v6, v8);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_402150å†™äº†ä¸€ä¸ªå«re3çš„æ–‡ä»¶ï¼Œç„¶åforkä¸€ä¸ªçº¿ç¨‹ã€‚çˆ¶è¿›ç¨‹è¿›å…¥sub_401F2Fè¿è¡Œre3ï¼Œç»“æŸåremoveæ‰re3ï¼Œå­è¿›ç¨‹æ¥å—çˆ¶è¿›ç¨‹çš„ptrace</p>
<p>sub_401F2Fï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_401F2F</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// r8</span></span><br><span class="line">  __int64 v2; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// ecx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// r8</span></span><br><span class="line">  __int64 v7; <span class="comment">// r9</span></span><br><span class="line">  __int64 v8; <span class="comment">// r8</span></span><br><span class="line">  __int64 v9; <span class="comment">// r9</span></span><br><span class="line">  __int64 v10; <span class="comment">// r8</span></span><br><span class="line">  __int64 v11; <span class="comment">// r9</span></span><br><span class="line">  __int64 v12; <span class="comment">// r8</span></span><br><span class="line">  __int64 v13; <span class="comment">// r9</span></span><br><span class="line">  __int64 v14; <span class="comment">// r8</span></span><br><span class="line">  __int64 v15; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">char</span> v17; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">char</span> v18; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">char</span> v19; <span class="comment">// [rsp+0h] [rbp-130h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v20; <span class="comment">// [rsp+10h] [rbp-120h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+18h] [rbp-118h]</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// [rsp+2Ch] [rbp-104h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">user_regs_struct</span> <span class="title">v23</span>;</span> <span class="comment">// [rsp+30h] [rbp-100h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v24; <span class="comment">// [rsp+108h] [rbp-28h]</span></span><br><span class="line">  __int64 v25; <span class="comment">// [rsp+110h] [rbp-20h]</span></span><br><span class="line">  __int64 v26; <span class="comment">// [rsp+118h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+124h] [rbp-Ch]</span></span><br><span class="line">  __int64 v28; <span class="comment">// [rsp+128h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  sys_wait(a1, <span class="number">0LL</span>, <span class="number">0</span>);</span><br><span class="line">  sys_ptrace(PTRACE_CONT, a1, <span class="number">0LL</span>, <span class="number">0LL</span>, v1, v2, v16);</span><br><span class="line">  v26 = sub_401A30(a1);</span><br><span class="line">  v3 = sub_4017E5();</span><br><span class="line">  result = v4;</span><br><span class="line">  v20 = v3;</span><br><span class="line">  v21 = v4;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">2</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v22 = <span class="number">0</span>;</span><br><span class="line">    sys_wait(a1, &amp;v22, <span class="number">0</span>);</span><br><span class="line">    result = v22 &amp; <span class="number">0x7F</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (v22 &amp; <span class="number">0x7F</span>) == <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    sys_ptrace(PTRACE_GETREGS, a1, <span class="number">0LL</span>, (__int64)&amp;v23, v6, v7, v17);</span><br><span class="line">    v25 = v23.rip - <span class="number">1</span>;</span><br><span class="line">    v24 = sys_ptrace(PTRACE_PEEKTEXT, a1, v23.rip - <span class="number">1</span>, <span class="number">0LL</span>, v8, v9, v18);</span><br><span class="line">    <span class="keyword">if</span> ( v24 == <span class="number">0xCAFEB055BFCC</span>LL )</span><br><span class="line">    &#123;</span><br><span class="line">      v28 = v25;</span><br><span class="line">      SMC(a1, v25, v26, v20, v21);</span><br><span class="line">      v23.rip = v25 + <span class="number">10</span>;</span><br><span class="line">      sys_ptrace(PTRACE_SETREGS, a1, <span class="number">0LL</span>, (__int64)&amp;v23, v12, v13, v19);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v24 == <span class="number">0xCAFE1055BFCC</span>LL )</span><br><span class="line">    &#123;</span><br><span class="line">      lizaiganshenmo(a1, v28, v25, v26, v20, v21);</span><br><span class="line">      v23.rip = v25 + <span class="number">10</span>;</span><br><span class="line">      sys_ptrace(PTRACE_SETREGS, a1, <span class="number">0LL</span>, (__int64)&amp;v23, v14, v15, v19);</span><br><span class="line">    &#125;</span><br><span class="line">    result = sys_ptrace(PTRACE_CONT, a1, <span class="number">0LL</span>, <span class="number">0LL</span>, v10, v11, v19);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_4017E5å–äº†ä¸€å †æŠ½è±¡çš„æ•°æ®ã€‚èµ·å­è¿›ç¨‹åç­‰å¾…å­è¿›ç¨‹è¿è¡Œï¼Œwaitå­è¿›ç¨‹å‘é€ä¿¡å·ï¼Œä¸º0å°±é€€å‡ºforå¾ªç¯ã€‚ä¸ä¸º0çš„è¯å°±ä¿å­˜å­è¿›ç¨‹çš„å¯„å­˜å™¨ï¼Œç„¶åå»åˆ¤æ–­if-elseï¼ˆå°±æ˜¯ä¸€ä¸ªå­è¿›ç¨‹å‘½ä¸­å¼‚å¸¸åæŠŠæ§åˆ¶æƒäº¤ç»™çˆ¶è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹ä¿å­˜å­è¿›ç¨‹ä¸Šä¸‹æ–‡ï¼Œå¤„ç†å®Œå¼‚å¸¸åæ¢å¤å­è¿›ç¨‹ä¸Šä¸‹æ–‡ï¼Œæ­¤åç»§ç»­è¿è¡Œå­è¿›ç¨‹çš„è¿‡ç¨‹ï¼‰ã€‚</p>
<p>ä¾æ®ä»RIP-1å¤„å–åˆ°çš„æ•°æ®æ¥åˆ¤æ–­è¿›å…¥ifè¿˜æ˜¯elseï¼Œifä¼šå¯¹å­è¿›ç¨‹è¿›è¡Œä¸€ä¸ªSMCçš„æ“ä½œï¼Œelseåˆ™ä¼šå°†å­è¿›ç¨‹SMCå›å»ã€‚<br>å…¶å®findcryptoå¯ä»¥æ‰¾åˆ°MD5å¸¸æ•°ï¼Œç„¶åæ¨æµ‹SMCä½¿ç”¨äº†å¯¹å‰é¢å–çš„æ•°æ®çš„MD5å€¼æ¥å¼‚æˆ–ã€‚<del>ä½†æ˜¯è¿™æ ·æ¯•ç«Ÿå¤ªç„å­¦äº†ï¼Œæƒ³è¦æ¢å¤re3è¿˜æ˜¯åº”è¯¥é‡‡å–ä¸€äº›æ­£å¸¸äººèƒ½æƒ³åˆ°çš„æ–¹æ³•ã€‚</del></p>
<h3 id="re3åˆ†æ"><a href="#re3åˆ†æ" class="headerlink" title="re3åˆ†æ"></a>re3åˆ†æ</h3><p>è·å–re3å¾ˆç®€å•ï¼Œæ‰‹åŠ¨dump<code>unk_4BC380</code>å¤„çš„æ•°æ®æˆ–è€…æŠŠremoveæ‰¬äº†ç„¶åè·‘ä¸€éç¨‹åºå°±èƒ½è·å–åˆ°re3ã€‚</p>
<p>å¯¹re3åˆ†æä¸»å‡½æ•°ï¼ˆåˆ†æä¸å‡ºæ¥çš„å‡½æ•°ä¸€è·¯Cç„¶åPå°±å½³äºï¼‰ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">env</span>[1];</span> <span class="comment">// [rsp+10h] [rbp-850h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">v5</span>[1];</span> <span class="comment">// [rsp+E0h] [rbp-780h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">v6</span>[1];</span> <span class="comment">// [rsp+1B0h] [rbp-6B0h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> __<span class="title">jmp_buf_tag</span> <span class="title">v7</span>[1];</span> <span class="comment">// [rsp+280h] [rbp-5E0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">640</span>]; <span class="comment">// [rsp+350h] [rbp-510h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v9[<span class="number">636</span>]; <span class="comment">// [rsp+5D0h] [rbp-290h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+84Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+850h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+854h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [rsp+858h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+85Ch] [rbp-4h]</span></span><br><span class="line">  __int64 savedregs; <span class="comment">// [rsp+860h] [rbp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v14 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a1 != <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  ((<span class="type">void</span> (__fastcall *)(<span class="type">char</span> *, <span class="type">char</span> **, <span class="type">char</span> **))sub_2490)(a2[<span class="number">1</span>], a2, a3);</span><br><span class="line">  ((<span class="type">void</span> (__fastcall *)(<span class="type">void</span> *, <span class="type">char</span> *, <span class="type">char</span> *))loc_21F9)(&amp;unk_55C0, v9, v8);</span><br><span class="line">  v13 = _setjmp(env);</span><br><span class="line">  <span class="keyword">if</span> ( v13 &lt;= <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = _setjmp(v5);</span><br><span class="line">    <span class="keyword">if</span> ( v11 &lt; byte_50A0[<span class="number">25</span> * v13] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( byte_50A0[<span class="number">25</span> * v13 + <span class="number">1</span> + v11] != *((<span class="type">char</span> *)&amp;savedregs + <span class="number">25</span> * v13 + v11 - <span class="number">655</span>) )<span class="comment">// v9</span></span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">      longjmp(v5, v11 + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    longjmp(env, v13 + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = _setjmp(v6);</span><br><span class="line">  <span class="keyword">if</span> ( v12 &lt;= <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = _setjmp(v7);</span><br><span class="line">    <span class="keyword">if</span> ( v10 &lt; byte_5320[<span class="number">25</span> * v12] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( byte_5320[<span class="number">25</span> * v12 + <span class="number">1</span> + v10] != *((<span class="type">char</span> *)&amp;savedregs + <span class="number">25</span> * v12 + v10 - <span class="number">1295</span>) )<span class="comment">// v8</span></span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">      longjmp(v7, v10 + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    longjmp(v6, v12 + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v14 == <span class="number">1</span> )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;GOOD JOB&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_2490æ¥å—è¾“å…¥ï¼Œæ§åˆ¶è¾“å…¥åªèƒ½ä¸º0æˆ–1ï¼Œ21F9è¿›è¡Œäº†ä¸€äº›å¤„ç†ï¼Œä½†ç”±äºæ­¤å‡½æ•°è¢«SMCäº†æ‰€ä»¥æˆ‘ä»¬ä¸çŸ¥é“å®ƒå¹²äº†ä»€ä¹ˆï¼Œç„¶åæŠŠsavedregsï¼ˆåšäº†ä¸€äº›æ··æ·†ï¼‰å’Œbyte_50A0å¤„çš„æ•°æ®å¯¹æ¯”ï¼Œèƒ½çœ‹å‡ºæ¥æ•°æ®æ˜¯ä¸¤ç»„25*25çš„è¡¨ã€‚æƒ³è¦çœ‹åˆ°éªŒè¯é€»è¾‘è¿˜æ˜¯è¦æ¢å¤21F9å¤„çš„é€»è¾‘ã€‚</p>
<h3 id="æ¢å¤re3"><a href="#æ¢å¤re3" class="headerlink" title="æ¢å¤re3"></a>æ¢å¤re3</h3><p>å¯¹äºSMCï¼Œè¦ä¹ˆæ˜¯é™æ€åˆ†æè‡ªå·±å†™è„šæœ¬æ¢å¤ï¼Œè¦ä¹ˆæ˜¯åŠ¨æ€è°ƒè¯•å»è§£å¯†ç¨‹åºã€‚ä½†æ˜¯é—®é¢˜åœ¨äºï¼Œå­è¿›ç¨‹æœ¬èº«å°±å¤„äºä¸€ä¸ªè¢«çˆ¶è¿›ç¨‹è°ƒè¯•çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æ³•å†å‘å­è¿›ç¨‹é™„åŠ è°ƒè¯•å™¨ã€‚è€Œå½“çˆ¶è¿›ç¨‹ç»“æŸæ—¶ï¼Œå­è¿›ç¨‹ä¹Ÿä¼šç»“æŸã€‚ä¸è¿‡æ­£æ˜¯å› ä¸ºçˆ¶å­è¿›ç¨‹çš„é€šä¿¡è¿‡ç¨‹ï¼Œæˆ‘ä»¬åˆä¼šå¤šä¸€ç§æ€è·¯ã€‚å¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œæ¢å¤re3æœ‰ä»¥ä¸‹4ç§æ€è·¯ã€‚</p>
<h4 id="é€šè¿‡patchç¨‹åºè®©å­è¿›ç¨‹æˆä¸ºåƒµå°¸è¿›ç¨‹"><a href="#é€šè¿‡patchç¨‹åºè®©å­è¿›ç¨‹æˆä¸ºåƒµå°¸è¿›ç¨‹" class="headerlink" title="é€šè¿‡patchç¨‹åºè®©å­è¿›ç¨‹æˆä¸ºåƒµå°¸è¿›ç¨‹"></a>é€šè¿‡patchç¨‹åºè®©å­è¿›ç¨‹æˆä¸ºåƒµå°¸è¿›ç¨‹</h4><p>æ€è·¯æ¥è‡ª<a target="_blank" rel="noopener" href="http://1.12.239.117:8090/archives/qwb2022-easyre">FallW1ndå¸ˆå‚…</a>ï¼Œç›´æ¥çœ‹åŸæ–‡8 <del>æˆ‘å°±ä¸æŠ„ä¸€éäº†</del></p>
<p>æ•´ä½“çš„patchæ€è·¯ï¼š</p>
<ul>
<li>è®©çˆ¶è¿›ç¨‹ä¸å¿…ç­‰å¾…å­è¿›ç¨‹ç»“æŸå°±å¯ä»¥è‡ªè¡Œç»“æŸ</li>
<li>æ‰¬äº†çˆ¶è¿›ç¨‹ä¸­å¯¹å­è¿›ç¨‹SMCå›å»çš„æ“ä½œ</li>
<li>è®©å­è¿›ç¨‹é™·å…¥æ­»å¾ªç¯æ— æ³•ç»“æŸ</li>
</ul>
<p>ä½†æ˜¯æˆ‘WSLè°ƒè¯•æ ¹æœ¬èµ·ä¸æ¥å­è¿›ç¨‹ï¼Œæ€ä¹ˆä¼šæ˜¯æï¼Ÿ<br>å‡†å¤‡ä¹‹åé…ä¸ªubuntuè™šæ‹Ÿæœºäº†ğŸ¤—forkè°ƒçš„è¡€å‹é«˜</p>
<h4 id="ç¡¬åˆšåŠ å¯†å‡½æ•°"><a href="#ç¡¬åˆšåŠ å¯†å‡½æ•°" class="headerlink" title="ç¡¬åˆšåŠ å¯†å‡½æ•°"></a>ç¡¬åˆšåŠ å¯†å‡½æ•°</h4><p>findcryptoèƒ½çœ‹åˆ°MD5çš„å¸¸æ•°ï¼Œå¯ä»¥çŒœæµ‹æ˜¯ç”¨äº†MD5ã€‚<br>å¯èƒ½è°ƒè¯•çœ‹çš„æ›´å¿«å§ï¼Œä½†æ˜¯æˆ‘èµ·ä¸æ¥å­è¿›ç¨‹ï¼Œçœ‹çœ‹<a target="_blank" rel="noopener" href="https://ppppz.net/2022/08/03/QWB2022-GameMaster-EasyRe/">PZå¸ˆå‚…çš„WP</a></p>
<h4 id="é€šè¿‡traceç¨‹åºè·å–çœŸå®æ•°æ®"><a href="#é€šè¿‡traceç¨‹åºè·å–çœŸå®æ•°æ®" class="headerlink" title="é€šè¿‡traceç¨‹åºè·å–çœŸå®æ•°æ®"></a>é€šè¿‡traceç¨‹åºè·å–çœŸå®æ•°æ®</h4><p>æ€è·¯æ¥è‡ªtrackç¥ï¼ˆtrackç¥TTTTQQQQLLLL!!!</p>
<p>æœ¬é¢˜çˆ¶è¿›ç¨‹å¯¹å­è¿›ç¨‹çš„æ“ä½œéƒ½éœ€è¦ä»å­è¿›ç¨‹è¯»æ•°æ®ã€åœ¨çˆ¶è¿›ç¨‹ä¸­ä¿®æ”¹ã€å†™å›å­è¿›ç¨‹è¿™3ä¸ªè¿‡ç¨‹ã€‚å…¶ä¸­ç¬¬1ã€3æ­¥ä¼šç”¨åˆ°ptraceè¿™ä¸ªç³»ç»Ÿè°ƒç”¨ã€‚<br>è€Œå¯¹äºç³»ç»Ÿè°ƒç”¨ï¼Œå¯ä»¥ä½¿ç”¨traceæ¥leakå‡ºç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­çš„å„ç§å‚æ•°ã€‚</p>
<p>ä½¿ç”¨å‘½ä»¤<code>strace -e trace=ptrace -o ./easyre.log ./easyre flag&#123;hhhhhhhhhh&#125;</code>ï¼Œç„¶åå»çœ‹ptraceçš„logï¼Œåªè¦æŠŠè¿™äº›å‚æ•°å†™å›å°±å¥½äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ptrace(PTRACE_POKETEXT, 149, 0x561dac238213, 0xe900000000fc45c7) = 0</span><br><span class="line">ptrace(PTRACE_PEEKTEXT, 149, 0x561dac238223, [0x4d94f7e68575494c]) = 0</span><br><span class="line">ptrace(PTRACE_POKETEXT, 149, 0x561dac238223, 0xf445c7000000) = 0</span><br><span class="line">ptrace(PTRACE_PEEKTEXT, 149, 0x561dac238233, [0xf1ac2feb8f8c89a9]) = 0</span><br><span class="line">ptrace(PTRACE_POKETEXT, 149, 0x561dac238233, 0x1ec45c700) = 0</span><br><span class="line">ptrace(PTRACE_PEEKTEXT, 149, 0x561dac238243, [0x7ef555b84fe2ed45]) = 0</span><br><span class="line">ptrace(PTRACE_POKETEXT, 149, 0x561dac238243, 0x8dd00102e0c1d089) = 0</span><br><span class="line">ptrace(PTRACE_PEEKTEXT, 149, 0x561dac238253, [0x7d3de98de644b0e3]) = 0</span><br><span class="line">ptrace(PTRACE_POKETEXT, 149, 0x561dac238253, 0xd06348d001f8458b) = 0</span><br><span class="line">ptrace(PTRACE_PEEKTEXT, 149, 0x561dac238263, [0xee5cc92072689f66]) = 0</span><br><span class="line">ï¼ˆåé¢å¤ªé•¿ä¸è´´äº†</span><br></pre></td></tr></table></figure>

<p><code>PTRACE_POKETEXT</code>æ˜¯å‘å­è¿›ç¨‹å†™å›æ•°æ®ï¼Œå–è¿™ä¸ªæ•°æ®å°±å¥½ã€‚</p>
<p>IDAPythonè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">0xe900000000fc45c7</span>,<span class="number">0xf445c7000000</span>,<span class="number">0x1ec45c700</span>,<span class="number">0x8dd00102e0c1d089</span>,<span class="number">0xd06348d001f8458b</span>,<span class="number">0x45830d74c08400b6</span>,<span class="number">0x7400f07d8347eb00</span>,<span class="number">0x14802e0c148d089</span>,<span class="number">0xc0458b48c2014800</span>,<span class="number">0x20c889848ec458b</span>,<span class="number">0xf045c701ec45</span>,<span class="number">0xf07d83407519f8</span>,<span class="number">0x4802e0c148d08948</span>,<span class="number">0x458b48c201480000</span>,<span class="number">0xc889848ec458bc1</span>,<span class="number">0x18f87d8301ec4583</span>,<span class="number">0x6348fc458bc189ec</span>,<span class="number">0x85148d48d00148</span>,<span class="number">0xff518dd00148c045</span>,<span class="number">0xfffffed48e0f18fc</span>,<span class="number">0xe445c700000122</span>,<span class="number">0xdc45c70000</span>,<span class="number">0xe4558b000000c7e9</span>,<span class="number">0xc201000000008514</span>,<span class="number">0xfd00148c8458b48</span>,<span class="number">0x1dc45c701e0</span>,<span class="number">0x48d06348e8458b3a</span>,<span class="number">0x85148d48d0</span>,<span class="number">0xc189e0458bc20148</span>,<span class="number">0x8300000000e045c7</span>,<span class="number">0x7d8301e445830000</span>,<span class="number">0xd06348e8458b3a74</span>,<span class="number">0x85148d48d001</span>,<span class="number">0x89e0458bc20148b8</span>,<span class="number">0xe045c702</span>,<span class="number">0x458bffffff2f8e0f</span>,<span class="number">0x2e0c148d08948d0</span>,<span class="number">0x8b48c20148000000</span>,<span class="number">0x7d8301e845831088</span>]</span><br><span class="line"></span><br><span class="line">addr = <span class="number">0x2213</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> key:</span><br><span class="line">    idc.patch_qword(addr, i)</span><br><span class="line">    addr += <span class="number">16</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ok&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>patchå®Œæ…¢æ…¢åˆ†æä¼ªä»£ç å°±å½³äºã€‚</p>
<p>ç„¶åå°±æ˜¯æ³¨æ„ä¸€ä¸‹ï¼Œæ—¥å¸¸ç¿»ç¿»initæ®µ = =<br>é‡Œé¢è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°sub_257Dï¼Œé‡Œé¢å¯¹éªŒè¯æ•°æ®åšäº†ä¸€äº›ä¿®æ”¹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_257D</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1[<span class="number">640</span>]; <span class="comment">// [rsp+0h] [rbp-290h] BYREF</span></span><br><span class="line">  __int64 v2; <span class="comment">// [rsp+280h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+28Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  qmemcpy(v1, &amp;unk_3020, <span class="number">0x271</span>uLL);</span><br><span class="line">  v2 = (__int64)&amp;unk_5838 - <span class="number">1304</span>;        <span class="comment">//0x5320</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">24</span>; ++i )</span><br><span class="line">    <span class="built_in">memcpy</span>((<span class="type">void</span> *)(<span class="number">25</span> * i + v2), &amp;v1[<span class="number">25</span> * i], (<span class="type">unsigned</span> __int8)v1[<span class="number">25</span> * i] + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> nullsub_2();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨unk_3020é™„è¿‘æœ‰unk_32A0ï¼Œäº¤å‰å¼•ç”¨å¯ä»¥çœ‹åˆ°ç”¨å®ƒå¯¹0x50A0åšäº†ä¿®æ”¹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sigabbrev_np</span><span class="params">(__int64 a1, __int64 a2, __int64 a3, __int64 a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// zf</span></span><br><span class="line">  __int64 v5; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v6; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  v6 = a4 - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v4 &amp;&amp; v6 )</span><br><span class="line">    <span class="keyword">return</span> nullsub_2(a1, a2, a3, v6);</span><br><span class="line">  _enable();</span><br><span class="line">  *(_BYTE *)(v5 - <span class="number">97</span>) = <span class="number">-3</span>;</span><br><span class="line">  *(_WORD *)(v5 - <span class="number">114</span>) = <span class="number">-5399</span>;</span><br><span class="line">  *(_BYTE *)(v5 - <span class="number">112</span>) = <span class="number">-20</span>;</span><br><span class="line">  *(_DWORD *)(v5 - <span class="number">120</span>) = <span class="number">-268633374</span>;</span><br><span class="line">  *(_WORD *)(v5 - <span class="number">116</span>) = <span class="number">-5139</span>;</span><br><span class="line">  *(_DWORD *)(v5 - <span class="number">126</span>) = <span class="number">-268633347</span>;</span><br><span class="line">  *(_WORD *)(v5 - <span class="number">122</span>) = <span class="number">-5139</span>;</span><br><span class="line">  *(_WORD *)(v5 - <span class="number">129</span>) = <span class="number">-5401</span>;</span><br><span class="line">  *(_BYTE *)(v5 - <span class="number">127</span>) = <span class="number">-17</span>;</span><br><span class="line">  <span class="keyword">for</span> ( *(_DWORD *)(v5 - <span class="number">4</span>) = <span class="number">0</span>; *(<span class="type">int</span> *)(v5 - <span class="number">4</span>) &lt;= <span class="number">14</span>; ++*(_DWORD *)(v5 - <span class="number">4</span>) )</span><br><span class="line">    *(_BYTE *)(v5 + *(<span class="type">int</span> *)(v5 - <span class="number">4</span>) - <span class="number">111</span>) ^= <span class="number">0x8E</span>u;</span><br><span class="line">  <span class="keyword">for</span> ( *(_DWORD *)(v5 - <span class="number">8</span>) = <span class="number">0</span>; *(<span class="type">int</span> *)(v5 - <span class="number">8</span>) &lt;= <span class="number">2</span>; ++*(_DWORD *)(v5 - <span class="number">8</span>) )</span><br><span class="line">    *(_BYTE *)(v5 + *(<span class="type">int</span> *)(v5 - <span class="number">8</span>) - <span class="number">114</span>) ^= <span class="number">0x8E</span>u;</span><br><span class="line">  <span class="keyword">for</span> ( *(_DWORD *)(v5 - <span class="number">12</span>) = <span class="number">0</span>; *(<span class="type">int</span> *)(v5 - <span class="number">12</span>) &lt;= <span class="number">5</span>; ++*(_DWORD *)(v5 - <span class="number">12</span>) )</span><br><span class="line">    *(_BYTE *)(v5 + *(<span class="type">int</span> *)(v5 - <span class="number">12</span>) - <span class="number">120</span>) ^= <span class="number">0x8E</span>u;</span><br><span class="line">  <span class="keyword">for</span> ( *(_DWORD *)(v5 - <span class="number">16</span>) = <span class="number">0</span>; *(<span class="type">int</span> *)(v5 - <span class="number">16</span>) &lt;= <span class="number">5</span>; ++*(_DWORD *)(v5 - <span class="number">16</span>) )</span><br><span class="line">    *(_BYTE *)(v5 + *(<span class="type">int</span> *)(v5 - <span class="number">16</span>) - <span class="number">126</span>) ^= <span class="number">0x8E</span>u;</span><br><span class="line">  <span class="keyword">for</span> ( *(_DWORD *)(v5 - <span class="number">20</span>) = <span class="number">0</span>; *(<span class="type">int</span> *)(v5 - <span class="number">20</span>) &lt;= <span class="number">5</span>; ++*(_DWORD *)(v5 - <span class="number">20</span>) )</span><br><span class="line">    *(_BYTE *)(v5 + *(<span class="type">int</span> *)(v5 - <span class="number">20</span>) - <span class="number">129</span>) ^= <span class="number">0x8E</span>u;</span><br><span class="line">  v7 = getppid();</span><br><span class="line">  <span class="built_in">snprintf</span>((<span class="type">char</span> *)(v5 - <span class="number">80</span>), <span class="number">0x1E</span>uLL, (<span class="type">const</span> <span class="type">char</span> *)(v5 - <span class="number">111</span>), v7);</span><br><span class="line">  *(_QWORD *)(v5 - <span class="number">32</span>) = fopen((<span class="type">const</span> <span class="type">char</span> *)(v5 - <span class="number">80</span>), <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  fgets((<span class="type">char</span> *)(v5 - <span class="number">96</span>), <span class="number">16</span>, *(FILE **)(v5 - <span class="number">32</span>));</span><br><span class="line">  fclose(*(FILE **)(v5 - <span class="number">32</span>));</span><br><span class="line">  result = <span class="built_in">strstr</span>((<span class="type">const</span> <span class="type">char</span> *)(v5 - <span class="number">96</span>), (<span class="type">const</span> <span class="type">char</span> *)(v5 - <span class="number">129</span>))</span><br><span class="line">        || <span class="built_in">strstr</span>((<span class="type">const</span> <span class="type">char</span> *)(v5 - <span class="number">96</span>), (<span class="type">const</span> <span class="type">char</span> *)(v5 - <span class="number">114</span>))</span><br><span class="line">        || <span class="built_in">strstr</span>((<span class="type">const</span> <span class="type">char</span> *)(v5 - <span class="number">96</span>), (<span class="type">const</span> <span class="type">char</span> *)(v5 - <span class="number">120</span>))</span><br><span class="line">        || <span class="built_in">strstr</span>((<span class="type">const</span> <span class="type">char</span> *)(v5 - <span class="number">96</span>), (<span class="type">const</span> <span class="type">char</span> *)(v5 - <span class="number">126</span>));</span><br><span class="line">  *(_DWORD *)(v5 - <span class="number">36</span>) = result;</span><br><span class="line">  <span class="keyword">if</span> ( !*(_DWORD *)(v5 - <span class="number">36</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    qmemcpy((<span class="type">void</span> *)(v5 - <span class="number">768</span>), byte_32A0, <span class="number">0x271</span>uLL);</span><br><span class="line">    result = (__int64)&amp;unk_5834 - <span class="number">1940</span>;                <span class="comment">//0x50A0</span></span><br><span class="line">    *(_QWORD *)(v5 - <span class="number">48</span>) = (<span class="type">char</span> *)&amp;unk_5834 - <span class="number">1940</span>;</span><br><span class="line">    <span class="keyword">for</span> ( *(_DWORD *)(v5 - <span class="number">24</span>) = <span class="number">0</span>; *(<span class="type">int</span> *)(v5 - <span class="number">24</span>) &lt;= <span class="number">24</span>; ++*(_DWORD *)(v5 - <span class="number">24</span>) )</span><br><span class="line">      result = (__int64)<span class="built_in">memcpy</span>(</span><br><span class="line">                          (<span class="type">void</span> *)(<span class="number">25</span> * *(_DWORD *)(v5 - <span class="number">24</span>) + *(_QWORD *)(v5 - <span class="number">48</span>)),</span><br><span class="line">                          (<span class="type">const</span> <span class="type">void</span> *)(v5 - <span class="number">768</span> + <span class="number">25LL</span> * *(<span class="type">int</span> *)(v5 - <span class="number">24</span>)),</span><br><span class="line">                          *(<span class="type">unsigned</span> __int8 *)(v5 + <span class="number">25LL</span> * *(<span class="type">int</span> *)(v5 - <span class="number">24</span>) - <span class="number">768</span>) + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­£å¥½å’Œä¸»å‡½æ•°é‡Œè¿›è¡ŒéªŒè¯çš„æ•°æ®å¯¹ä¸Šäº†ï¼Œæ‰€ä»¥è¿™ä¸¤ç»„æ•°æ®æ‰æ˜¯çœŸå®æ•°æ®ã€‚åˆ†æå‡ºæ¥æ˜¯æ•°ç»‡æ¸¸æˆï¼Œå»åœ¨çº¿ç½‘ç«™è§£ä¸€ä¸‹å°±å¥½ã€‚</p>
<h2 id="GameMaster"><a href="#GameMaster" class="headerlink" title="GameMaster"></a>GameMaster</h2><p><del>åŒå‡»æ¸¸æˆï¼Œæ‹¿20å—èµ¢åˆ°3700w</del></p>
<p>å¯¹gamemessageçš„ä¸¤å¤„è§£å¯†ï¼š</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; num; i++)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">byte</span>[] array = Program.memory;</span><br><span class="line">	<span class="built_in">int</span> num = i;</span><br><span class="line">	array[num] ^= <span class="number">34</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//2</span></span><br><span class="line"><span class="built_in">byte</span>[] key = <span class="keyword">new</span> <span class="built_in">byte</span>[]&#123;<span class="number">66</span>,<span class="number">114</span>,<span class="number">97</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">115</span>,<span class="number">116</span>,<span class="number">111</span>,<span class="number">114</span>,<span class="number">109</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">103</span>,<span class="number">33</span>,<span class="number">33</span>,<span class="number">33</span>&#125;;</span><br><span class="line">ICryptoTransform cryptoTransform = <span class="keyword">new</span> RijndaelManaged</span><br><span class="line">&#123;</span><br><span class="line">	Key = key,</span><br><span class="line">	Mode = CipherMode.ECB,</span><br><span class="line">	Padding = PaddingMode.Zeros</span><br><span class="line">&#125;.CreateDecryptor();</span><br><span class="line">Program.m = cryptoTransform.TransformFinalBlock(Program.memory, <span class="number">0</span>, num);</span><br></pre></td></tr></table></figure>

<p>pythonè§£å¯†å¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰¾PEå¤´ï¼Œå‰é¢çš„å…¨éƒ¨åˆ æ‰ã€‚<br>å¾—åˆ°è§£å¯†åçš„æ–‡ä»¶æ‹–è¿›dnspyè¯»ä»£ç ï¼Œz3è§£æ–¹ç¨‹ç…§æŠ„é€»è¾‘å³å¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">101</span>,<span class="number">5</span>,<span class="number">80</span>,<span class="number">213</span>,<span class="number">163</span>,<span class="number">26</span>,<span class="number">59</span>,<span class="number">38</span>,<span class="number">19</span>,<span class="number">6</span>,<span class="number">173</span>,<span class="number">189</span>,<span class="number">198</span>,<span class="number">166</span>,<span class="number">140</span>,<span class="number">183</span>,<span class="number">42</span>,<span class="number">247</span>,<span class="number">223</span>,<span class="number">24</span>,<span class="number">106</span>,<span class="number">20</span>,<span class="number">145</span>,<span class="number">37</span>,<span class="number">24</span>,<span class="number">7</span>,<span class="number">22</span>,<span class="number">191</span>,<span class="number">110</span>,<span class="number">179</span>,<span class="number">227</span>,<span class="number">5</span>,<span class="number">62</span>,<span class="number">9</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">65</span>,<span class="number">22</span>,<span class="number">37</span>,<span class="number">5</span>]</span><br><span class="line">num = -<span class="number">1</span></span><br><span class="line">chk = [<span class="number">0</span>]*<span class="number">50</span></span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">x = BitVec(<span class="string">&#x27;x&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">y = BitVec(<span class="string">&#x27;y&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">z = BitVec(<span class="string">&#x27;z&#x27;</span>,<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">320</span>):</span><br><span class="line">	x = (((x &gt;&gt; <span class="number">29</span> ^ x &gt;&gt; <span class="number">28</span> ^ x &gt;&gt; <span class="number">25</span> ^ x &gt;&gt; <span class="number">23</span>) &amp; <span class="number">1</span>) | x &lt;&lt; <span class="number">1</span>)</span><br><span class="line">	y = (((y &gt;&gt; <span class="number">30</span> ^ y &gt;&gt; <span class="number">27</span>) &amp; <span class="number">1</span>) | y &lt;&lt; <span class="number">1</span>)</span><br><span class="line">	z = (((z &gt;&gt; <span class="number">31</span> ^ z &gt;&gt; <span class="number">30</span> ^ z &gt;&gt; <span class="number">29</span> ^ z &gt;&gt; <span class="number">28</span> ^ z &gt;&gt; <span class="number">26</span> ^ z &gt;&gt; <span class="number">24</span>) &amp; <span class="number">1</span>) | z &lt;&lt; <span class="number">1</span>)</span><br><span class="line">	flag = i % <span class="number">8</span> == <span class="number">0</span></span><br><span class="line">	<span class="keyword">if</span> flag:</span><br><span class="line">		num+=<span class="number">1</span></span><br><span class="line">	chk[num] = ((chk[num] &lt;&lt; <span class="number">1</span>) | ((((z &gt;&gt; <span class="number">32</span> &amp; <span class="number">1</span> &amp; (x &gt;&gt; <span class="number">30</span> &amp; <span class="number">1</span>)) ^ (((z &gt;&gt; <span class="number">32</span> &amp; <span class="number">1</span>) ^ <span class="number">1</span>) &amp; (y &gt;&gt; <span class="number">31</span> &amp; <span class="number">1</span>))))))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    s.add(chk[i]==enc[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(s.check() == sat):</span><br><span class="line">    <span class="built_in">print</span>(s.model())</span><br><span class="line"><span class="comment"># [y = 868387187, x = 156324965, z = 3131229747]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">xor_key = [<span class="number">60</span>,<span class="number">100</span>,<span class="number">36</span>,<span class="number">86</span>,<span class="number">51</span>,<span class="number">251</span>,<span class="number">167</span>,<span class="number">108</span>,<span class="number">116</span>,<span class="number">245</span>,<span class="number">207</span>,<span class="number">223</span>,<span class="number">40</span>,<span class="number">103</span>,<span class="number">34</span>,<span class="number">62</span>,<span class="number">22</span>,<span class="number">251</span>,<span class="number">227</span>]</span><br><span class="line"></span><br><span class="line">y = <span class="number">868387187</span></span><br><span class="line">x = <span class="number">156324965</span></span><br><span class="line">z = <span class="number">3131229747</span></span><br><span class="line"></span><br><span class="line">key = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">	key.append(x &amp; <span class="number">0xff</span>)</span><br><span class="line">	x &gt;&gt;= <span class="number">8</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">	key.append(y &amp; <span class="number">0xff</span>)</span><br><span class="line">	y &gt;&gt;= <span class="number">8</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">	key.append(z &amp; <span class="number">0xff</span>)</span><br><span class="line">	z &gt;&gt;= <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(xor_key)):</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(key[i%<span class="built_in">len</span>(key)]^xor_key[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="deeprev"><a href="#deeprev" class="headerlink" title="deeprev"></a>deeprev</h2><p>é¢˜ç›®æ€è·¯è·Ÿ<a target="_blank" rel="noopener" href="https://www.yunzh1jun.com/2022/09/22/GoogleCTF2022-eldar/">googleCTFçš„eldar</a>ä¸€æ ·çš„ï¼Œé“¾æ¥æ˜¯æˆ‘å†™çš„ç¿»è¯‘ï¼Œä½†æ˜¯å»ºè®®è¯»åŸæ–‡ã€‚</p>
<p>è¿è¡Œä¸€ä¸‹ï¼Œç„¶åå»soåº“é‡Œé¢æœflagï¼Œå¯ä»¥æœåˆ°ä¸€ä¸ªå‡ºé¢˜äººå†™å¥½çš„flagï¼Œæç¤ºæˆ‘ä»¬åº”è¯¥patchè¿™é‡Œã€‚å½“æˆ‘ä»¬æŠŠflag patchæˆæ­£ç¡®çš„flagï¼Œè¿™ä¸ªç¨‹åºå°±ä¼šæç¤ºwinã€‚</p>
<p>ç”¨IDAæ‰“å¼€deeprevå¯ä»¥çœ‹åˆ°å·¨å¤§æ— æ¯”çš„é‡å®šä½è¡¨ï¼Œå¹¶ä¸”è¿™ä¸ªè¡¨æ˜¯å¯è¯»å¯å†™å¯æ‰§è¡Œçš„ã€‚<br>æ³¨æ„ä¸€å †0xc3ï¼Œè¿™æ˜¯retçš„æœºå™¨ç ï¼Œè€Œ0xc3ç±»å‹éƒ½æ˜¯RELï¼Œè¿™å°±æ˜¯<code>r.r_offset = r.r_addend</code>ï¼ˆè§eldaré‚£ç¯‡wpï¼‰ã€‚</p>
<p><img src="/img/code/chall_photo/deeprev1.png"></p>
<p>æ‰¾ä¸€ä¸ªè¿ç€RELç±»å‹çš„0xc3çš„æœºå™¨ç åç¼–è¯‘ä¸€ä¸‹</p>
<p><img src="/img/code/chall_photo/deeprev2.png"></p>
<p>ç›´æ¥åŒå‡»<code>stru_8040C4</code>è¿›å»æŒ‰Uçœ‹çœ‹å†…éƒ¨ç»“æ„</p>
<p><img src="/img/code/chall_photo/deeprev3.png"></p>
<p>æ³¨æ„IDAå·²ç»æ³¨é‡Šå‡ºæ¥ï¼Œ0x8040ccåœ°å€å¤„çš„æ•°æ®æ˜¯<code>Copy of shared data</code>ï¼Œä¹Ÿå°±æ˜¯ä»soæ–‡ä»¶é‡Œcopyè¿‡æ¥çš„flagå€¼ï¼Œæ‰€ä»¥è¿™é‡Œè‚¯å®šè·Ÿflagå…³ç³»å¯†åˆ‡ã€‚<br>å¦‚æœä¸å«Œéº»çƒ¦æ„¿æ„ç›´æ¥è°ƒè¯•ç¡¬å•ƒçš„è¯å°±å¯ä»¥ç›´æ¥åœ¨è¿™é‡Œä¸‹å†…å­˜æ–­ç‚¹ç„¶åè·‘ç¨‹åºäº†ï¼Œè°ƒè¯•å°±å¯ä»¥å‘ç°å®ƒä¸æ–­åœ°copy soåº“é‡Œçš„flagåˆ°è¿™ä¸ªåœ°å€ï¼Œç„¶åç»è¿‡ä¸€ä¸ªå¼‚æˆ–å’ŒåŠ çš„è¿ç®—ï¼Œå†æŠŠå¯†æ–‡å­˜åˆ°å¦ä¸€å¤„ï¼ˆ0x8042BAå¤„ï¼‰ï¼Œç„¶åå†ä¸æ–­copyæ­¤å¤„å­˜çš„å¯†æ–‡åˆ°0x8040FCå¤„ï¼Œæœ€åå†å¯¹è¿™ä¸ªåœ°å€å¼‚æˆ–ä¸€ä¸ªå€¼ã€‚<br>æˆ‘ä»¬å½“ç„¶å¯ä»¥æ…¢æ…¢è°ƒè¯•å»ä¸€ä¸ªä¸€ä¸ªè®°å½•è¿™äº›å€¼ï¼Œä¸è¿‡è¿™æ ·è¿˜æ˜¯ <del>å¤ªå°åº¦äººäº†</del> å¤ªéº»çƒ¦äº†ï¼Œæ‰€ä»¥å¯ä»¥æ€è€ƒé€‰æ‹©ä¸€äº›å·¥å…·ã€‚</p>
<p>é¦–å…ˆç»è¿‡è°ƒè¯•å¯ä»¥å‘ç°ï¼Œå…³é”®ä»£ç éƒ½åœ¨retå‰é¢ï¼ˆä¹Ÿå°±æ˜¯0xc3ï¼‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä»¥è¿™ä¸€æ¡ä¸ºä¾æ®æ¥ç­›é€‰æˆ‘ä»¬éœ€è¦çš„<code>r.r_addend</code>å€¼ï¼Œç„¶åè¾“å‡ºè¿™äº›å€¼çš„åæ±‡ç¼–ä»£ç ã€‚<br>å¯ä»¥å…ˆ<code>readelf -r deeprev &gt; rel.txt</code>å¤§æ¦‚çœ‹ä¸€ä¸‹é‡å®šä½è¡¨ï¼Œåªæœ‰1.2k+è¡Œæ˜¯æœ‰æ„ä¹‰çš„ï¼Œåé¢éƒ½æ˜¯0ï¼Œæ‰€ä»¥å†™ä»£ç çš„æ—¶å€™ä¹Ÿä¸ç”¨éå†æ•´ä¸ªé‡å®šä½è¡¨ï¼Œè¿™æ ·ä¼šå¾ˆæ…¢ï¼Œéå†åˆ°1300çš„æ—¶å€™å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lief</span><br><span class="line"></span><br><span class="line">b = lief.ELF.parse(<span class="string">&#x27;./deeprev&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">b</span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    relocs = <span class="built_in">list</span>(b.relocations)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">1300</span>):</span><br><span class="line">        r = relocs[i]</span><br><span class="line">        <span class="keyword">if</span> r.<span class="built_in">type</span> == <span class="number">8</span>: <span class="comment">#ç­›é€‰RELç±»å‹çš„é‡å®šä½ä¿¡æ¯</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">hex</span>(r.addend), end=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line">parse(b)</span><br></pre></td></tr></table></figure>

<p>æ‰“å°å‡ºæ¥çš„å€¼å¯ä»¥ç›´æ¥åæ±‡ç¼–ï¼Œæˆ‘è¿™é‡Œæ‰‹åŠ¨å»æ‰äº†ä¸€äº›0ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># r.r_addendè¢«liefè§£æä¸ºsignedï¼Œæ‰€ä»¥packå¯èƒ½ä¼šæŠ¥é”™out of rangeï¼ˆå› ä¸ºå˜æˆäº†è´Ÿæ•°ï¼‰</span></span><br><span class="line"><span class="comment"># å†™ä¸€ä¸ªå‡½æ•°è½¬æ¢ä¸€ä¸‹è´Ÿæ•°å³å¯</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">yun</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">0</span>:</span><br><span class="line">        i += <span class="number">0x10000000000000000</span></span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line">lst = [<span class="number">0x404040</span>,<span class="number">0x1</span>,<span class="number">0x16008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x804332</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x80440a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404041</span>,<span class="number">0x17008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80452a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x1008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x804602</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404042</span>,<span class="number">0x10008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x804722</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x2008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x8047fa</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404043</span>,<span class="number">0x12008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80491a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x3008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x8049f2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404044</span>,<span class="number">0x10008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x804b12</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x4008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x804bea</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404045</span>,<span class="number">0x11008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x804d0a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x5008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x804de2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404046</span>,<span class="number">0x12008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x804f02</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x6008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x804fda</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404047</span>,<span class="number">0x13008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8050fa</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x7008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x8051d2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404048</span>,<span class="number">0x14008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8052f2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x8053ca</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404049</span>,<span class="number">0x15008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8054ea</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x9008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x8055c2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x40404a</span>,<span class="number">0x16008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8056e2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0xa008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x8057ba</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x40404b</span>,<span class="number">0x17008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8058da</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0xb008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x8059b2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x40404c</span>,<span class="number">0x18008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x805ad2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0xc008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x805baa</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x40404d</span>,<span class="number">0x19008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x805cca</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0xd008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x805da2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x40404e</span>,<span class="number">0x24008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x805ec2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0xe008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x805f9a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x40404f</span>,<span class="number">0x2c008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8060ba</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0xf008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x806192</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404050</span>,<span class="number">0x26008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8062b2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x10008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x80638a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404051</span>,<span class="number">0x1e008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8064aa</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x11008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x806582</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404052</span>,<span class="number">0x1f008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8066a2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x12008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x80677a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404053</span>,<span class="number">0x20008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80689a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x13008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x806972</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404054</span>,<span class="number">0x20008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x806a92</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x14008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x806b6a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404055</span>,<span class="number">0x21008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x806c8a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x15008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x806d62</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404056</span>,<span class="number">0x23008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x806e82</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x16008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x806f5a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404057</span>,<span class="number">0x27008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80707a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x17008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x807152</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404058</span>,<span class="number">0x24008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x807272</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x18008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x80734a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x404059</span>,<span class="number">0x25008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80746a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x19008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x807542</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x40405a</span>,<span class="number">0x26008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x807662</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x1a008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x80773a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x40405b</span>,<span class="number">0x27008040cc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80785a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x1b008040cc250480</span>,<span class="number">0xc3</span>,<span class="number">0x807932</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0x8040cc</span>,<span class="number">0x1</span>,<span class="number">0x8042ba</span>,<span class="number">0x8</span>,<span class="number">0x70008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x807ab2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042bb</span>,<span class="number">0x7c008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x807c4a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042bc</span>,<span class="number">0x73008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x807de2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042bd</span>,<span class="number">0x78008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x807f7a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042be</span>,<span class="number">0x6f008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x808112</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042bf</span>,<span class="number">0x27008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8082aa</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042c0</span>,<span class="number">0x2a008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x808442</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042c1</span>,<span class="number">0x2c008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8085da</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042c2</span>,<span class="number">0x7f008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x808772</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042c3</span>,<span class="number">0x35008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80890a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042c4</span>,<span class="number">0x2d008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x808aa2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042c5</span>,<span class="number">0x32008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x808c3a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042c6</span>,<span class="number">0x37008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x808dd2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042c7</span>,<span class="number">0x3b008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x808f6a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042c8</span>,<span class="number">0x22008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x809102</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042c9</span>,<span class="number">0x59008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80929a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042ca</span>,<span class="number">0x53008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x809432</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042cb</span>,-<span class="number">0x71ff7fbf03dacb80</span>,<span class="number">0xc3</span>,<span class="number">0x8095ca</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042cc</span>,<span class="number">0x3d008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x809762</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042cd</span>,<span class="number">0x2a008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x8098fa</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042ce</span>,<span class="number">0x59008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x809a92</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042cf</span>,<span class="number">0x27008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x809c2a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042d0</span>,<span class="number">0x2d008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x809dc2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042d1</span>,<span class="number">0x29008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x809f5a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042d2</span>,<span class="number">0x34008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80a0f2</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042d3</span>,<span class="number">0x2d008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80a28a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042d4</span>,<span class="number">0x61008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80a422</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x8042d5</span>,<span class="number">0x32008040fc253480</span>,<span class="number">0xc3</span>,<span class="number">0x80a5ba</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x8040fc</span>,<span class="number">0x8</span>,<span class="number">0x40405c</span>,<span class="number">0x40405d</span>,<span class="number">0x80412c</span>,<span class="number">0x8040fc</span>,<span class="number">0x804144</span>,<span class="number">0x804114</span>,<span class="number">0x804144</span>,<span class="number">0x6c0080415c253480</span>,<span class="number">0xc3</span>,<span class="number">0x80a992</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x80415c</span>,<span class="number">0x8</span>,<span class="number">0x40405c</span>,<span class="number">0x40405d</span>,<span class="number">0x80412c</span>,<span class="number">0x8040fc</span>,<span class="number">0x80412c</span>,<span class="number">0x804144</span>,<span class="number">0x804114</span>,<span class="number">0x804144</span>,-<span class="number">0x5eff7fbea3dacb80</span>,<span class="number">0xc3</span>,<span class="number">0x80ae2a</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x80415c</span>,<span class="number">0x8</span>,<span class="number">0x40405e</span>,<span class="number">0x40405f</span>,<span class="number">0x80412c</span>,<span class="number">0x8040fc</span>,<span class="number">0x804144</span>,<span class="number">0x804114</span>,<span class="number">0x804144</span>,-<span class="number">0x4eff7fbea3dacb80</span>,<span class="number">0xc3</span>,<span class="number">0x80b262</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x80415c</span>,<span class="number">0x8</span>,<span class="number">0x40405e</span>,<span class="number">0x40405f</span>,<span class="number">0x80412c</span>,<span class="number">0x8040fc</span>,<span class="number">0x80412c</span>,<span class="number">0x804144</span>,<span class="number">0x804114</span>,<span class="number">0x804144</span>,-<span class="number">0x1aff7fbea3dacb80</span>,<span class="number">0xc3</span>,<span class="number">0x80b6fa</span>,<span class="number">0x1000a0000001a</span>,<span class="number">0xa53f62</span>,<span class="number">0x18</span>,<span class="number">0x80415c</span>,<span class="number">0x8</span>,<span class="number">0x8040e4</span>,<span class="number">0x1</span>]</span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_64)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lst)):</span><br><span class="line">    <span class="keyword">if</span> lst[j] == <span class="number">0xc3</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            CODE = pack(<span class="string">&#x27;&lt;Q&#x27;</span>,lst[j-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            t = yun(lst[j-<span class="number">1</span>])</span><br><span class="line">            CODE = pack(<span class="string">&#x27;&lt;Q&#x27;</span>, t)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> md.disasm(CODE, <span class="number">0</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;%s\t%s&quot;</span> %(i.mnemonic, i.op_str))</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">xor	byte ptr [0x8040cc], 0x16</span><br><span class="line">add	byte ptr [0x8040cc], 0</span><br><span class="line">xor	byte ptr [0x8040cc], 0x17</span><br><span class="line">add	byte ptr [0x8040cc], 1</span><br><span class="line">xor	byte ptr [0x8040cc], 0x10</span><br><span class="line">add	byte ptr [0x8040cc], 2</span><br><span class="line">xor	byte ptr [0x8040cc], 0x12</span><br><span class="line">add	byte ptr [0x8040cc], 3</span><br><span class="line">xor	byte ptr [0x8040cc], 0x10</span><br><span class="line">add	byte ptr [0x8040cc], 4</span><br><span class="line">xor	byte ptr [0x8040cc], 0x11</span><br><span class="line">add	byte ptr [0x8040cc], 5</span><br><span class="line">xor	byte ptr [0x8040cc], 0x12</span><br><span class="line">add	byte ptr [0x8040cc], 6</span><br><span class="line">xor	byte ptr [0x8040cc], 0x13</span><br><span class="line">add	byte ptr [0x8040cc], 7</span><br><span class="line">xor	byte ptr [0x8040cc], 0x14</span><br><span class="line">add	byte ptr [0x8040cc], 8</span><br><span class="line">xor	byte ptr [0x8040cc], 0x15</span><br><span class="line">add	byte ptr [0x8040cc], 9</span><br><span class="line">xor	byte ptr [0x8040cc], 0x16</span><br><span class="line">add	byte ptr [0x8040cc], 0xa</span><br><span class="line">xor	byte ptr [0x8040cc], 0x17</span><br><span class="line">add	byte ptr [0x8040cc], 0xb</span><br><span class="line">xor	byte ptr [0x8040cc], 0x18</span><br><span class="line">add	byte ptr [0x8040cc], 0xc</span><br><span class="line">xor	byte ptr [0x8040cc], 0x19</span><br><span class="line">add	byte ptr [0x8040cc], 0xd</span><br><span class="line">xor	byte ptr [0x8040cc], 0x24</span><br><span class="line">add	byte ptr [0x8040cc], 0xe</span><br><span class="line">xor	byte ptr [0x8040cc], 0x2c</span><br><span class="line">add	byte ptr [0x8040cc], 0xf</span><br><span class="line">xor	byte ptr [0x8040cc], 0x26</span><br><span class="line">add	byte ptr [0x8040cc], 0x10</span><br><span class="line">xor	byte ptr [0x8040cc], 0x1e</span><br><span class="line">add	byte ptr [0x8040cc], 0x11</span><br><span class="line">xor	byte ptr [0x8040cc], 0x1f</span><br><span class="line">add	byte ptr [0x8040cc], 0x12</span><br><span class="line">xor	byte ptr [0x8040cc], 0x20</span><br><span class="line">add	byte ptr [0x8040cc], 0x13</span><br><span class="line">xor	byte ptr [0x8040cc], 0x20</span><br><span class="line">add	byte ptr [0x8040cc], 0x14</span><br><span class="line">xor	byte ptr [0x8040cc], 0x21</span><br><span class="line">add	byte ptr [0x8040cc], 0x15</span><br><span class="line">xor	byte ptr [0x8040cc], 0x23</span><br><span class="line">add	byte ptr [0x8040cc], 0x16</span><br><span class="line">xor	byte ptr [0x8040cc], 0x27</span><br><span class="line">add	byte ptr [0x8040cc], 0x17</span><br><span class="line">xor	byte ptr [0x8040cc], 0x24</span><br><span class="line">add	byte ptr [0x8040cc], 0x18</span><br><span class="line">xor	byte ptr [0x8040cc], 0x25</span><br><span class="line">add	byte ptr [0x8040cc], 0x19</span><br><span class="line">xor	byte ptr [0x8040cc], 0x26</span><br><span class="line">add	byte ptr [0x8040cc], 0x1a</span><br><span class="line">xor	byte ptr [0x8040cc], 0x27</span><br><span class="line">add	byte ptr [0x8040cc], 0x1b</span><br><span class="line">xor	byte ptr [0x8040fc], 0x70</span><br><span class="line">xor	byte ptr [0x8040fc], 0x7c</span><br><span class="line">xor	byte ptr [0x8040fc], 0x73</span><br><span class="line">xor	byte ptr [0x8040fc], 0x78</span><br><span class="line">xor	byte ptr [0x8040fc], 0x6f</span><br><span class="line">xor	byte ptr [0x8040fc], 0x27</span><br><span class="line">xor	byte ptr [0x8040fc], 0x2a</span><br><span class="line">xor	byte ptr [0x8040fc], 0x2c</span><br><span class="line">xor	byte ptr [0x8040fc], 0x7f</span><br><span class="line">xor	byte ptr [0x8040fc], 0x35</span><br><span class="line">xor	byte ptr [0x8040fc], 0x2d</span><br><span class="line">xor	byte ptr [0x8040fc], 0x32</span><br><span class="line">xor	byte ptr [0x8040fc], 0x37</span><br><span class="line">xor	byte ptr [0x8040fc], 0x3b</span><br><span class="line">xor	byte ptr [0x8040fc], 0x22</span><br><span class="line">xor	byte ptr [0x8040fc], 0x59</span><br><span class="line">xor	byte ptr [0x8040fc], 0x53</span><br><span class="line">xor	byte ptr [0x8040fc], 0x8e</span><br><span class="line">xor	byte ptr [0x8040fc], 0x3d</span><br><span class="line">xor	byte ptr [0x8040fc], 0x2a</span><br><span class="line">xor	byte ptr [0x8040fc], 0x59</span><br><span class="line">xor	byte ptr [0x8040fc], 0x27</span><br><span class="line">xor	byte ptr [0x8040fc], 0x2d</span><br><span class="line">xor	byte ptr [0x8040fc], 0x29</span><br><span class="line">xor	byte ptr [0x8040fc], 0x34</span><br><span class="line">xor	byte ptr [0x8040fc], 0x2d</span><br><span class="line">xor	byte ptr [0x8040fc], 0x61</span><br><span class="line">xor	byte ptr [0x8040fc], 0x32</span><br><span class="line">xor	byte ptr [0x80415c], 0x6c</span><br><span class="line">xor	byte ptr [0x80415c], 0xa1</span><br><span class="line">xor	byte ptr [0x80415c], 0xb1</span><br><span class="line">xor	byte ptr [0x80415c], 0xe5</span><br></pre></td></tr></table></figure>

<p>æå–å€¼æ‰‹æ“è§£å¯†å³å¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xor1 = [<span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x10</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x24</span>, <span class="number">0x2c</span>, <span class="number">0x26</span>, <span class="number">0x1e</span>, <span class="number">0x1f</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x23</span>, <span class="number">0x27</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x26</span>, <span class="number">0x27</span>]</span><br><span class="line">xor2 = [<span class="number">0x70</span>, <span class="number">0x7c</span>, <span class="number">0x73</span>, <span class="number">0x78</span>, <span class="number">0x6f</span>, <span class="number">0x27</span>, <span class="number">0x2a</span>, <span class="number">0x2c</span>, <span class="number">0x7f</span>, <span class="number">0x35</span>, <span class="number">0x2d</span>, <span class="number">0x32</span>, <span class="number">0x37</span>, <span class="number">0x3b</span>, <span class="number">0x22</span>, <span class="number">0x59</span>, <span class="number">0x53</span>, <span class="number">0x8e</span>, <span class="number">0x3d</span>, <span class="number">0x2a</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x2d</span>, <span class="number">0x29</span>, <span class="number">0x34</span>, <span class="number">0x2d</span>, <span class="number">0x61</span>, <span class="number">0x32</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(xor1)):</span><br><span class="line">    flag += <span class="built_in">chr</span>((xor2[i]-i)^xor1[i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;366c950370fec47e34581a0</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ä¸Šé¢è¾“å‡ºçš„æœ€å4å¥æ±‡ç¼–ä¸å†æ˜¯å¯¹0x8040fcå¤„çš„å¼‚æˆ–ï¼Œè€Œæ˜¯åœ¨0x80415cå¤„è¿›è¡Œå¼‚æˆ–ï¼Œæ‰€ä»¥å4ä½flagæ˜¾ç„¶æ˜¯æ¢äº†éªŒè¯æ–¹å¼ã€‚</p>
<p>å¯¹0x80415cä¸‹ç¡¬ä»¶æ–­ç‚¹å¯ä»¥å‘ç°ï¼Œå…¶é€»è¾‘å°±æ˜¯ä¸¤ä¸ªä¸€ç»„çš„äºŒå…ƒæ–¹ç¨‹ï¼Œè‡ªå·±è§£æˆ–è€…z3è§£å‡å¯â€¦â€¦</p>
<p>ä¸è¿‡æ¯”èµ›çš„æ—¶å€™ç»™äº†flagçš„SHA256å€¼ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç›´æ¥çˆ†ç ´ã€‚</p>
<p>å½“ç„¶äº†ï¼Œæ¯•ç«Ÿflagåªå‰©æœ€å4ä½ï¼ˆå®é™…ä¸Šæ˜¯3ä½ï¼Œå› ä¸ºæœ€åä¸€ä½ä¸€å®šæ˜¯<code>&#125;</code>ï¼‰ï¼Œå†å»çœ‹è¿™ä¸ªé€»è¾‘å±å®æœ‰ç‚¹éº»çƒ¦ã€‚æ‰€ä»¥<del>å¯¹äºæˆ‘è¿™ä¹ˆä¸€ä¸ªçˆ†ç ´èµ°å¤©ä¸‹çš„äººæ¥è¯´</del>å½“ç„¶è¿˜æ˜¯ç›´æ¥çˆ†ç ´æ–¹ä¾¿ä¸€äº›ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">fr = <span class="built_in">open</span>(<span class="string">&quot;libsecret.so&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">f = fr.read()</span><br><span class="line">fr.close()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.product(<span class="string">&#x27;1234567890abcedf&#x27;</span>,repeat = <span class="number">3</span>):</span><br><span class="line">	s = i[<span class="number">0</span>] + i[<span class="number">1</span>] + i[<span class="number">2</span>]</span><br><span class="line">	fw = <span class="built_in">open</span>(<span class="string">&quot;libsecret.so&quot;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line">	fw.write(f[:<span class="number">0x305c</span>] + s.encode() + f[<span class="number">0x305f</span>:])</span><br><span class="line">	out = subprocess.check_output([<span class="string">&quot;./deeprev&quot;</span>])</span><br><span class="line">	<span class="keyword">if</span> <span class="string">b&#x27;Fail&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> out:</span><br><span class="line">		<span class="built_in">print</span>(s)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line"><span class="comment">#574</span></span><br></pre></td></tr></table></figure>

<p><code>flag&#123;366c950370fec47e34581a0574&#125;</code></p>
<p>ä¸‹é¢æ˜¯é€†å‘åˆ†äº«ä¼šçš„æ–‡æ¡£</p>
<h3 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h3><p>ELFåŠ¨æ€é‡å®šä½æ¡ç›®çš„ç»“æ„ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    Elf64_Addr      r_offset;</span><br><span class="line">    Elf64_Xword     r_info;</span><br><span class="line">    Elf64_Sxword    r_addend;</span><br><span class="line">&#125; Elf64_Rela;</span><br></pre></td></tr></table></figure>

<p>infoåŒ…æ‹¬ä¸€ä¸ªtypeå’Œsymble(å¯é€‰)ç´¢å¼•ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> ELF64_R_SYM(info)             ((info)&gt;&gt;32)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ELF64_R_TYPE(info)            ((Elf64_Word)(info))</span></span><br></pre></td></tr></table></figure>

<p>åŠ¨æ€ç¬¦å·è¡¨æ¡ç›®çš„ç»“æ„ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    Elf64_Word      st_name;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>   st_info;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>   st_other;</span><br><span class="line">    Elf64_Half      st_shndx;</span><br><span class="line">    Elf64_Addr      st_value;</span><br><span class="line">    Elf64_Xword     st_size;</span><br><span class="line">&#125; Elf64_Sym;</span><br></pre></td></tr></table></figure>

<p>æœ¬é¢˜ä½¿ç”¨äº†ä»¥ä¸‹é‡å®šä½ä¿¡æ¯ï¼š</p>
<h4 id="REL-type-8"><a href="#REL-type-8" class="headerlink" title="REL(type 8)"></a>REL(type 8)</h4><p>å°†é‡å®šä½ä¿¡æ¯è®¾ç½®ä¸ºä¸€ä¸ªç›¸å¯¹åŸºå€çš„å€¼ï¼ˆä½†æ˜¯åŸºå€å§‹ç»ˆä¸º0ï¼‰</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*(<span class="type">uint64_t</span> *)r.r_offset = r.r_addend;</span><br></pre></td></tr></table></figure>

<p>ç«‹å³æ•°å¯»å€ï¼š<code>mov *0xbeef0000, $0x04</code><br>å†™æˆé‡å®šä½æ¡ç›®å°±æ˜¯<code>&#123;type=RELATIVE, offset=0xbeef0000,symbol=0,addend=0x04&#125;</code><br>åœ¨IDAä¸­æ˜¾ç¤ºä¸º<code>Elf64_Rela &lt;beef0000h, 8, 4h&gt;</code></p>
<h4 id="CPY-type-5"><a href="#CPY-type-5" class="headerlink" title="CPY(type 5)"></a>CPY(type 5)</h4><p>ä»ç¬¦å·åœ°å€å¤åˆ¶nå­—èŠ‚åˆ°é‡å®šä½åœ°å€</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Elf64_Sym sym = symbols[ELF64_R_SYM(r.r_info)];</span><br><span class="line"><span class="built_in">memcpy</span>(r.r_offset, sym.st_value, sym.st_size);</span><br></pre></td></tr></table></figure>

<p>ç«‹å³æ•°å¯»å€ï¼š<code>mov *0xbeef0000, [%foo]</code><br><code>&#123;type=COPY, offset=0xbeef0000,symbol=foo,addend=0&#125;</code><br><code>Elf64_Rela &lt;beef0000h, ?00000005, 0&gt;</code><br>å¤åˆ¶fooæŒ‡å‘çš„nä¸ªå­—èŠ‚åˆ°0xbeef0000ï¼Œnæ˜¯fooçš„st_sizeã€‚</p>
<h4 id="R64-type-1"><a href="#R64-type-1" class="headerlink" title="R64(type 1)"></a>R64(type 1)</h4><p>å°†é‡å®šä½ä¿¡æ¯è®¾ç½®ä¸º ç¬¦å·å€¼+å¸¸æ•°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*(<span class="type">uint64_t</span> *)r.r_offset = symbols[ELF64_R_SYM(r.r_info)] + r.r_addend;</span><br></pre></td></tr></table></figure>

<h3 id="æ€ä¹ˆåšï¼Ÿ"><a href="#æ€ä¹ˆåšï¼Ÿ" class="headerlink" title="æ€ä¹ˆåšï¼Ÿ"></a>æ€ä¹ˆåšï¼Ÿ</h3><h4 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h4><p>å½“æˆ‘ä»¬å¯¹è¿™äº›æ•°æ®å…·ä½“å¦‚ä½•å¡«å……å¹¶ä¸æ¸…æ¥šçš„æ—¶å€™ï¼Œæœ€å¥½çš„åŠæ³•å½“ç„¶æ˜¯è®©é“¾æ¥å™¨æ¥å¸®æˆ‘ä»¬åšè¿™äº›äº‹æƒ…ã€‚æˆ‘ä»¬åªéœ€è¦ä¸‹æ–­ç‚¹è°ƒè¯•ï¼Œå»æ‰¾æ•°æ®çš„åŠ å¯†é€»è¾‘å°±å¯ä»¥äº†ã€‚<br>å¯¹äºè¿™ä¸ªé¢˜è€Œè¨€ï¼Œè°ƒè¯•å°±å¯ä»¥å‘ç°å®ƒä¸æ–­åœ°copy soåº“é‡Œçš„flagåˆ°è¿™ä¸ªåœ°å€ï¼Œç„¶åç»è¿‡ä¸€ä¸ªå¼‚æˆ–å’ŒåŠ çš„è¿ç®—ï¼Œå†æŠŠå¯†æ–‡å­˜åˆ°å¦ä¸€å¤„ï¼ˆ0x8042BAå¤„ï¼‰ï¼Œç„¶åå†ä¸æ–­copyæ­¤å¤„å­˜çš„å¯†æ–‡åˆ°0x8040FCå¤„ï¼Œæœ€åå†å¯¹è¿™ä¸ªåœ°å€å¼‚æˆ–ä¸€ä¸ªå€¼ã€‚</p>
<p>ä¸è¿‡å…¶å®å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªé¢˜è™½ç„¶å¯¹å•ä¸ªå­—ç¬¦ä¸²çš„åŠ å¯†æ•°æ®ä¸åŒï¼Œä½†å¤§éƒ¨åˆ†ä»£ç æ˜¯å¤ç”¨çš„ã€‚ä¸€ä¸ªå…¸å‹çš„è¡¨ç°å°±æ˜¯æ¯æ¬¡å¤åˆ¶æ•°æ®ã€å¼‚æˆ–ã€åŠ ä¹‹åï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªretã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¤ä¸ºretå‰å°±æ˜¯ç”¨äºåŠ å¯†çš„å…³é”®ä»£ç ï¼Œå…¶ä»–åœ°æ–¹æ˜¯ä¸€äº›å¯¹é€†å‘ä»·å€¼ä¸é«˜çš„ä»£ç ã€‚<br>é‚£ä¹ˆå°±å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬æ¥è§£æè¿™äº›æ•°æ®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lief</span><br><span class="line"></span><br><span class="line">b = lief.ELF.parse(<span class="string">&#x27;./deeprev&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">b</span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    relocs = <span class="built_in">list</span>(b.relocations)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">1300</span>):</span><br><span class="line">        r = relocs[i]</span><br><span class="line">        <span class="keyword">if</span> r.<span class="built_in">type</span> == <span class="number">8</span>: <span class="comment">#ç­›é€‰RELç±»å‹çš„é‡å®šä½ä¿¡æ¯</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">hex</span>(r.addend), end=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line">parse(b)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªè„šæœ¬è¾“å‡ºäº†æ‰€æœ‰RELç±»å‹çš„é‡å®šä½ä¿¡æ¯çš„addendå€¼ï¼Œå…¶ä¸­å¯èƒ½ä¼šæœ‰ä¸€äº›å€¼ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œä½†æ˜¯ä¸ç”¨ç®¡ã€‚<br>åç»­åç¼–è¯‘çš„æ—¶å€™ï¼Œcapstoneé‡åˆ°æ— æ³•åç¼–è¯‘çš„æ•°æ®å°±ä¼šç›´æ¥è·³è¿‡ã€‚</p>
<p>ç„¶åå†™ä¸€ä¸ªè„šæœ¬ï¼Œç­›é€‰retä¹‹å‰çš„å€¼åæ±‡ç¼–ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> capstone <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># r.r_addendè¢«liefè§£æä¸ºsignedï¼Œæ‰€ä»¥packå¯èƒ½ä¼šæŠ¥é”™out of rangeï¼ˆå› ä¸ºå˜æˆäº†è´Ÿæ•°ï¼‰</span></span><br><span class="line"><span class="comment"># å†™ä¸€ä¸ªå‡½æ•°è½¬æ¢ä¸€ä¸‹è´Ÿæ•°å³å¯</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">yun</span>(<span class="params">i</span>):</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">0</span>:</span><br><span class="line">        i += <span class="number">0x10000000000000000</span></span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line">lst = [...]</span><br><span class="line">md = Cs(CS_ARCH_X86, CS_MODE_64)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lst)):</span><br><span class="line">    <span class="keyword">if</span> lst[j] == <span class="number">0xc3</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            CODE = pack(<span class="string">&#x27;&lt;Q&#x27;</span>,lst[j-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            t = yun(lst[j-<span class="number">1</span>])</span><br><span class="line">            CODE = pack(<span class="string">&#x27;&lt;Q&#x27;</span>, t)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> md.disasm(CODE, <span class="number">0</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;%s\t%s&quot;</span> %(i.mnemonic, i.op_str))</span><br></pre></td></tr></table></figure>

<h4 id="è‡ªå·±å†™ä¸€ä¸ªè§£æè„šæœ¬"><a href="#è‡ªå·±å†™ä¸€ä¸ªè§£æè„šæœ¬" class="headerlink" title="è‡ªå·±å†™ä¸€ä¸ªè§£æè„šæœ¬"></a>è‡ªå·±å†™ä¸€ä¸ªè§£æè„šæœ¬</h4><p>æ¨èé˜…è¯»ï¼š<br><a target="_blank" rel="noopener" href="https://ctf.harrisongreen.me/2022/googlectf/eldar/">googlectf2022 eldar WP</a></p>
<p>é¡ºä¾¿ä¸€æï¼šeldarè¿™ä¸ªé¢˜æ˜¯<strong>çœŸæ­£å®ç°äº†ä½¿ç”¨å…ƒæ•°æ®æ¥éšè—ä»£ç é€»è¾‘çš„ã€‚</strong><br>deeprevè¿™ä¸ªé¢˜æ›´åƒæ˜¯ç›´æ¥æŠŠæœºå™¨ç æ”¾åœ¨äº†é‡å®šä½è¡¨é‡Œï¼Œæ‰€ä»¥ä¸Šé¢é‚£ç§å·æ‡’çš„è§£ææ–¹æ³•ï¼ˆç›´æ¥dumpé‡å®šä½è¡¨çš„æ•°æ®æ¥åç¼–è¯‘ï¼‰æ‰èƒ½å¥æ•ˆã€‚<br>eldaré‡Œçš„é‡å®šä½è¡¨æ˜¯æ²¡æœ‰depprevé‚£æ ·çš„é•¿æ•°æ®æœºå™¨ç çš„ï¼Œæ‰€ä»¥åŸºæœ¬åªèƒ½ç¡¬è°ƒï¼Œæˆ–è€…åƒä¸Šé¢è¿™ä¸ªå¤§ä½¬ä¸€æ ·è‡ªå·±å†™è„šæœ¬è§£æã€‚</p>

    </div>

    <div class="about">
        <h1>å…³äºæœ¬æ–‡</h1>
        <p>æœ¬æ–‡ä½œè€… äº‘ä¹‹å›, è®¸å¯ç”± <a
                target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
    </div>

    
        
    
</article>
        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h4 class="title">Blog</h4>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/CTF" class="item">CTF</a>
                
                <a href="/Learn" class="item">Learn</a>
                
                <a href="/Dairy" class="item">Dairy</a>
                
                <a href="/Alkaid" class="item">Alkaid</a>
                
                <a href="/friends" class="item">Friends</a>
                
            </div>
            
            <div class="group">
                <h4 class="title">Me</h4>
                
                <a target="_blank" rel="noopener" href="https://github.com/YunZh1Jun" class="item">GitHub</a>
                
                <a href="mailto:yunzh1jun@qq.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2022 äº‘ä¹‹å›<br >é©±åŠ¨ç”± <a href="http://hexo.io/" target="_blank">Hexo</a></span>
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
    </body>
</html>