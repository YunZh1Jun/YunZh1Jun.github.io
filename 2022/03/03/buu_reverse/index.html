<!DOCTYPE html>
<html lang="zh-cn">
    <!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>buu Reverse刷题记录 - 云之君&#39;s Blog</title>
  
    <link rel="shortcut icon" href="/img/fav/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/waline.css">

  
  
  
<link rel="stylesheet" href="/css/post.css">

  

  
    
<script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
 
  

  
<meta name="generator" content="Hexo 5.4.2"></head>
    <body data-color-scheme="auto">
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">云之君&#39;s Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">主页</a>
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/CTF">CTF</a>
            
            
            
            <a class="nav-item" href="/Learn">Learn</a>
            
            
            
            <a class="nav-item" href="/Diary">Diary</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/YunZh1Jun" target="_blank">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        <article class="post">
    <div class="meta">
        
        <div class="date" id="date">
            
            
            
            <span>March</span>
            
            
            
            
            
            
            
            
            
            
            <span>3,</span>
            <span>2022</span>
        </div>
        

        <h2 class="title">buu Reverse刷题记录</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p>BUU的刷题记录（非WP），只记录一些自己踩坑和知识点，以及没什么用但舍不得删的解题脚本。</p>
<span id="more"></span>

<h2 id="GUET-CTF2019-re"><a href="#GUET-CTF2019-re" class="headerlink" title="[GUET-CTF2019]re"></a>[GUET-CTF2019]re</h2><p>脱壳之后导入IDA64找加密函数，正常就是写脚本解密，中间少了一位可以爆破。但是这个题，这个题它它它它它中间的17和16居然是倒过来写的，倒过来写的！！！我*&amp;……%￥#@~我我我我我找了好久，找了好久啊，我就说我不可能输反啊扣努压路！<br>然后就是如何在linux里跑一个elf文件，因为有一位不知道要爆破，就这命令找了半天……<br><code>./文件名</code><br>这个命令就能跑了，然后是flag脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">flag=[]</span><br><span class="line">a=<span class="number">166163712</span>/<span class="number">1629056</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">731332800</span>/<span class="number">6771600</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">357245568</span>/<span class="number">3682944</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">1074393000</span>/<span class="number">10431000</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">489211344</span>/<span class="number">3977328</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">518971936</span>/<span class="number">5138336</span></span><br><span class="line">flag.append(a)</span><br><span class="line">flag.append(<span class="built_in">ord</span>(<span class="string">&#x27;1&#x27;</span>))</span><br><span class="line">a=<span class="number">406741500</span>/<span class="number">7532250</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">294236496</span>/<span class="number">5551632</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">177305856</span>/<span class="number">3409728</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">650683500</span>/<span class="number">13013670</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">298351053</span>/<span class="number">6088797</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">386348487</span>/<span class="number">7884663</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">438258597</span>/<span class="number">8944053</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">249527520</span>/<span class="number">5198490</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">445362764</span>/<span class="number">4544518</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">981182160</span>/<span class="number">10115280</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">174988800</span>/<span class="number">3645600</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">493042704</span>/<span class="number">9667504</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">257493600</span>/<span class="number">5364450</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">767478780</span>/<span class="number">13464540</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">312840624</span>/<span class="number">5488432</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">1404511500</span>/<span class="number">14479500</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">316139670</span>/<span class="number">6451830</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">619005024</span>/<span class="number">6252576</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">372641472</span>/<span class="number">7763364</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">373693320</span>/<span class="number">7327320</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">498266640</span>/<span class="number">8741520</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">452465676</span> /<span class="number">8871876</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">208422720</span>/<span class="number">4086720</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">515592000</span>/<span class="number">9374400</span></span><br><span class="line">flag.append(a)</span><br><span class="line">a=<span class="number">719890500</span>/<span class="number">5759124</span></span><br><span class="line">flag.append(a)</span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    s+=<span class="built_in">chr</span>(<span class="built_in">int</span>(i))</span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>

<h2 id="SUCTF2019-SignIn"><a href="#SUCTF2019-SignIn" class="headerlink" title="[SUCTF2019]SignIn"></a>[SUCTF2019]SignIn</h2><p><del>dbt诚不欺我，二进制手果然还是避不开学密码的命运……</del><br>搜字符串，交叉引用，然后F5大法……</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-4A0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">16</span>]; <span class="comment">// [rsp+10h] [rbp-490h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-480h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">16</span>]; <span class="comment">// [rsp+30h] [rbp-470h] BYREF</span></span><br><span class="line">  <span class="type">char</span> input[<span class="number">112</span>]; <span class="comment">// [rsp+40h] [rbp-460h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v9[<span class="number">1000</span>]; <span class="comment">// [rsp+B0h] [rbp-3F0h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+498h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[sign in]&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;[input your flag]: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%99s&quot;</span>, input);</span><br><span class="line">  sub_96A(input, (__int64)v9);</span><br><span class="line">  __gmpz_init_set_str((__int64)v7, (__int64)<span class="string">&quot;ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35&quot;</span>, <span class="number">16LL</span>);</span><br><span class="line">  __gmpz_init_set_str((__int64)v6, (__int64)v9, <span class="number">16LL</span>);</span><br><span class="line">  __gmpz_init_set_str(</span><br><span class="line">    (__int64)v4,</span><br><span class="line">    (__int64)<span class="string">&quot;103461035900816914121390101299049044413950405173712170434161686539878160984549&quot;</span>,</span><br><span class="line">    <span class="number">10LL</span>);</span><br><span class="line">  __gmpz_init_set_str((__int64)v5, (__int64)<span class="string">&quot;65537&quot;</span>, <span class="number">10LL</span>);</span><br><span class="line">  __gmpz_powm(v6, v6, v5, v4);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)__gmpz_cmp(v6, v7) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;GG!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;TTTTTTTTTTql!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_96A函数，看起来就是把字符串转成ASCII码的字符串，左移四位然后加上下一位的ASCII码，这样循环到字符串结束。然后emmm是__gmpz_init_set_str这个看起来有点迷的函数，查了一下才知道是高精度算法库，学习一下查阅官方文档吧<del>嘤嘤嘤</del><br><a target="_blank" rel="noopener" href="https://gmplib.org/manual/">https://gmplib.org/manual/</a><br>简单来讲有点像pow函数，不过这个函数最后一位指定进制。然后看到65537 <del>（我DNA动了）这么好的数字怎么能不拿来算RSA呢？！！！</del><br>大胆猜测一下，这两串数字应该有一个是密文，有一个是n，<del>那么接下来就干他！</del><br>kafu分解大法……得到p，q，写脚本……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">q = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">c=<span class="number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></span><br><span class="line">n=<span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">N=gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m=<span class="built_in">pow</span>(c,N,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m))</span><br><span class="line"><span class="comment">#0x73756374667b50776e5f405f68756e647265645f79656172737d</span></span><br><span class="line">m=[<span class="number">0x73</span>,<span class="number">0x75</span>,<span class="number">0x63</span>,<span class="number">0x74</span>,<span class="number">0x66</span>,<span class="number">0x7b</span>,<span class="number">0x50</span>,<span class="number">0x77</span>,<span class="number">0x6e</span>,<span class="number">0x5f</span>,<span class="number">0x40</span>,<span class="number">0x5f</span>,<span class="number">0x68</span>,<span class="number">0x75</span>,<span class="number">0x6e</span>,<span class="number">0x64</span>,<span class="number">0x72</span>,<span class="number">0x65</span>,<span class="number">0x64</span>,<span class="number">0x5f</span>,<span class="number">0x79</span>,<span class="number">0x65</span>,<span class="number">0x61</span>,<span class="number">0x72</span>,<span class="number">0x73</span>,<span class="number">0x7d</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>咳咳……但是不要学我瞎猜做题大法，万一不是就白瞎了……</p>
<h2 id="Youngter-drive"><a href="#Youngter-drive" class="headerlink" title="Youngter-drive"></a>Youngter-drive</h2><p>我看了一下这个题的题解感觉都很奇怪呢……？<br>线程的问题我确实是一点不会 <del>（被打）</del>，但是函数还是能看得懂的吧。线程的部分大概意思是，创建两个线程交替进行，一个线程是下面这个加密函数，一个线程是仅仅把字符串往前推。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *__cdecl <span class="title function_">sub_411940</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v3; <span class="comment">// [esp+D3h] [ebp-5h]</span></span><br><span class="line"></span><br><span class="line">  v3 = *(_BYTE *)(a2 + a1);</span><br><span class="line">  <span class="keyword">if</span> ( (v3 &lt; <span class="number">97</span> || v3 &gt; <span class="number">122</span>) &amp;&amp; (v3 &lt; <span class="number">65</span> || v3 &gt; <span class="number">90</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; <span class="number">97</span> || v3 &gt; <span class="number">122</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = off_418000[<span class="number">0</span>];</span><br><span class="line">    *(_BYTE *)(a2 + a1) = off_418000[<span class="number">0</span>][*(<span class="type">char</span> *)(a2 + a1) - <span class="number">38</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = off_418000[<span class="number">0</span>];</span><br><span class="line">    *(_BYTE *)(a2 + a1) = off_418000[<span class="number">0</span>][*(<span class="type">char</span> *)(a2 + a1) - <span class="number">96</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一句if限定了只能是大小写字母，后面的if判断，如果是大写字母，写入off[a2[a1]-38]，如果是小写，写入off[a2[a1]-96]。这里加密的是输入，也就是说程序里给的”TOiZiZtOrYaToUwPnToBsOaOapsyS”这么一串字符是需要解密的。<br>那么去找，偶数位字符的索引，就是a2[a1]-38和a2[a1]-96的值。那么我们怎么知道哪个+38哪个+96呢？看题解大多数是反过来的，即认为大写加密后变成小写，小写加密后变成大写（我超，我当时竟然看了半天没看懂，一直是反着写的）。 <br> 个人认为这样不太好，万一加密之后不是反过来的，而是有一个码表呢？所以还是爆破大法好（x<br>自己原来是照着题解写的脚本，不过后来按自己的思路改了一下，这就爆破吧反正，直接无脑爆破（bushi<br>然后还有一个坑是因为这个函数，dword_418008的值是0x1d，也就是29，判断&gt;=0的话就是30位字符串，所以题目中给的被加密后的字符串实际上少了一位，打出来的flag是29位。<br></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __stdcall <span class="title function_">StartAddress_0</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    WaitForSingleObject(hObject, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">    <span class="keyword">if</span> ( dword_418008 &gt; <span class="number">-1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_41112C(&amp;Source, dword_418008);</span><br><span class="line">      --dword_418008;</span><br><span class="line">      Sleep(<span class="number">0x64</span>u);</span><br><span class="line">    &#125;</span><br><span class="line">    ReleaseMutex(hObject);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>哈啊哈哈哈哈哈，看了好多题解都说猜，<del>这怎么能猜呢（bushi</del>当然是要看一下加密字符串后面还有什么玩意啦~<br>因为这是个常规情况吧，就是加密之后的字符因为码值比较小，所以没办法显示成字符，只能以数字形式表示。跟进去看看，后边果然跟了个0x10，那就加进去就完事了~</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=<span class="string">&quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span></span><br><span class="line">de=<span class="string">&quot;TOiZiZtOrYaToUwPnToBsOaOapsySy&quot;</span>+<span class="built_in">chr</span>(<span class="number">0x10</span>)</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(de)):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        flag+=de[i]</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    j=<span class="built_in">str</span>.find(de[i])</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)+<span class="number">1</span>):</span><br><span class="line">      <span class="keyword">if</span> k-<span class="number">38</span>==j:</span><br><span class="line">        flag+=<span class="built_in">chr</span>(k)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>)+<span class="number">1</span>):</span><br><span class="line">      <span class="keyword">if</span> k-<span class="number">96</span>==j:</span><br><span class="line">        flag+=<span class="built_in">chr</span>(k)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="WUSTCTF2020-level1"><a href="#WUSTCTF2020-level1" class="headerlink" title="[WUSTCTF2020]level1"></a>[WUSTCTF2020]level1</h2><p>这个很简单，直接上脚本……注意索引为0的地方随便加个啥东西，不然跑出来不对（别问我怎么知道的……）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">s=[<span class="number">0</span>,<span class="number">198</span>,<span class="number">232</span>,<span class="number">816</span>,<span class="number">200</span>,<span class="number">1536</span>,<span class="number">300</span>,<span class="number">6144</span>,<span class="number">984</span>,<span class="number">51200</span>,<span class="number">570</span>,<span class="number">92160</span>,<span class="number">1200</span>,<span class="number">565248</span>,<span class="number">756</span>,<span class="number">1474560</span>,<span class="number">800</span>,<span class="number">6291456</span>,<span class="number">1782</span>,<span class="number">65536000</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">  <span class="keyword">if</span> i&amp;<span class="number">1</span>!=<span class="number">0</span>:</span><br><span class="line">    s[i]=s[i]//<span class="built_in">pow</span>(<span class="number">2</span>,i)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    s[i]=s[i]//i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">  <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="ACTF新生赛2020-usualCrypt"><a href="#ACTF新生赛2020-usualCrypt" class="headerlink" title="[ACTF新生赛2020]usualCrypt"></a>[ACTF新生赛2020]usualCrypt</h2><p>base64变表。<del>其实是网上嫖的代码</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">Str = <span class="built_in">list</span>(<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>)</span><br><span class="line">model = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>,<span class="number">15</span>):</span><br><span class="line">    Str[i],Str[i+<span class="number">10</span>] = Str[i+<span class="number">10</span>],Str[i]</span><br><span class="line">Str = <span class="string">&#x27;&#x27;</span>.join(Str)</span><br><span class="line">enc = <span class="string">&quot;zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&quot;</span>.swapcase()</span><br><span class="line">dec = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    dec += model[Str.find(enc[i])]</span><br><span class="line"><span class="built_in">print</span> (dec)</span><br><span class="line"><span class="built_in">print</span> (Str)</span><br><span class="line"><span class="built_in">print</span> (base64.b64decode(dec))</span><br></pre></td></tr></table></figure>

<h2 id="MRCTF2020-Transform"><a href="#MRCTF2020-Transform" class="headerlink" title="[MRCTF2020]Transform"></a>[MRCTF2020]Transform</h2><p>记得翻转s0 <del>（别问我怎么知道的）</del><br>后面的字符串长度不够，补一个0，而且看一下代码逻辑就知道，是以len33为索引补全flag，所以肯定有一个索引是0，也就是len33里必然有一个元素是0。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cyber=[<span class="number">0x67</span>,<span class="number">0x79</span>,<span class="number">0x7B</span>,<span class="number">0x7F</span>,<span class="number">0x75</span>,<span class="number">0x2B</span>,<span class="number">0x3C</span>,<span class="number">0x52</span>,<span class="number">0x53</span>,<span class="number">0x79</span>,<span class="number">0x57</span>,<span class="number">0x5E</span>,<span class="number">0x5D</span>,<span class="number">0x42</span>,<span class="number">0x7B</span>,<span class="number">0x2D</span>,<span class="number">0x2A</span>,<span class="number">0x66</span>,<span class="number">0x42</span>,<span class="number">0x7E</span>,<span class="number">0x4C</span>,<span class="number">0x57</span>,<span class="number">0x79</span>,<span class="number">0x41</span>,<span class="number">0x6B</span>,<span class="number">0x7E</span>,<span class="number">0x65</span>,<span class="number">0x3C</span>,<span class="number">0x5C</span>,<span class="number">0x45</span>,<span class="number">0x6F</span>,<span class="number">0x62</span>,<span class="number">0x4D</span>,<span class="number">0x3F</span>]</span><br><span class="line">len33=[<span class="number">9</span>,<span class="number">0x0A</span>,<span class="number">0x0F</span>,<span class="number">0x17</span>,<span class="number">0x7</span>,<span class="number">0x18</span>,<span class="number">0x0C</span>,<span class="number">0x6</span>,<span class="number">0x1</span>,<span class="number">0x10</span>,<span class="number">0x3</span>,<span class="number">0x11</span>,<span class="number">0x20</span>,<span class="number">0x1D</span>,<span class="number">0x0B</span>,<span class="number">0x1E</span>,<span class="number">0x1B</span>,<span class="number">0x16</span>,<span class="number">0x4</span>,<span class="number">0x0D</span>,<span class="number">0x13</span>,<span class="number">0x14</span>,<span class="number">0x15</span>,<span class="number">0x2</span>,<span class="number">0x19</span>,<span class="number">5</span>,<span class="number">0x1F</span>,<span class="number">0x8</span>,<span class="number">0x12</span>,<span class="number">0x1A</span>,<span class="number">0x1C</span>,<span class="number">0x0E</span>,<span class="number">0</span>]</span><br><span class="line">s0=[]</span><br><span class="line">ipt=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    s0.append(cyber[i]^len33[i])</span><br><span class="line">s=<span class="built_in">list</span>(<span class="built_in">reversed</span>(s0))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">    ipt.append(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">    ipt[len33[i]]=s[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ipt:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h2><p><del>我超有病毒不敢做</del><br>咳咳，等我攒几道安卓题一起看看，学一下jeb怎么用的 <del>（才不是因为懒）</del><br><br>来填坑了~咳咳！<br>感觉安卓逆向跟exe也差不多嘛，找关键字符串定位主要函数，然后分析代码逻辑。不过apk可以解压出来一堆文件，在lib里有个so文件比较关键，这个里面可能会有比较重要的信息，一般是个ELF文件，拖进IDA里找字符串就好了，就是java代码真难看(x<br>这个题忘记录了，反正就是找mail字符，主函数里看base64加密，然后去so文件里找最长的字符串（因为要的是完整邮箱）解密。IDA里最后三个字符串很明显，都是=结尾。</p>
<h2 id="WUSTCTF2020-level2"><a href="#WUSTCTF2020-level2" class="headerlink" title="[WUSTCTF2020]level2"></a>[WUSTCTF2020]level2</h2><p>？？？？？？这个题搞什么？？？脱壳之后拖进IDA就有flag？？？我还以为有坑，交上去竟然对了？做的我一脸黑人问号？<del>（不过今天倒是轻松了）</del></p>
<h2 id="HDCTF2019-Maze"><a href="#HDCTF2019-Maze" class="headerlink" title="[HDCTF2019]Maze"></a>[HDCTF2019]Maze</h2><p><del>呜呜呜呜吃到坏的柚子肚子难受睡不着，来摸几道逆向</del><br>首先查壳，有壳的，名字很长，改一个短一点的就能脱掉，也不知道是什么原理~<br>载入IDA，搜关键字符串，定位到主函数，发现反编译不了，是因为跳转到一个不存在的地址（IDA中会有标红，猜测是花指令）。<br>之前了解过一点花指令hhhhhh，一眼xor然后jnz，标准的花指令格式(bushi)，给它nop掉</p>
<blockquote>
<p>选中指令-右键keypatch-patch（快捷键ctrl+alt+k）<br></p>
</blockquote>
<p><del>懒得搜命令就自己在IDA里瞎找，竟然找到了……</del><br>下面的call函数先不要nop，因为可能是关键代码。摁d转成字节数据，然后一个一个试（先将第一个数据nop掉再转成代码，不行再将前俩数据nop……）发现nop掉第一条指令之后就正常了，IDA自动将后面的字节数据转为代码。然后选中main函数中所有关键代码，摁p将其声明为函数，然后F5大法……<br>题目是迷宫题，wsad上下左右，asc_408078值是7，迷宫抠出来长度是70，推测是7X10的迷宫，那么打出来看看……</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*******+**</span><br><span class="line">******* **</span><br><span class="line">****    **</span><br><span class="line">**   *****</span><br><span class="line">** **F****</span><br><span class="line">**    ****</span><br><span class="line">**********</span><br></pre></td></tr></table></figure>

<p>初始位置是+，结束位置在F，因为看结束判断条件是（5，-4），也就是F的坐标。<br><del>然后手撕就好了</del><br>flag{ssaaasaassdddw}</p>
<h2 id="GWCTF-2019-xxor"><a href="#GWCTF-2019-xxor" class="headerlink" title="[GWCTF 2019]xxor"></a>[GWCTF 2019]xxor</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-68h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+Ch] [rbp-64h]</span></span><br><span class="line">  __int64 input[<span class="number">6</span>]; <span class="comment">// [rsp+10h] [rbp-60h] BYREF</span></span><br><span class="line">  __int64 v7[<span class="number">6</span>]; <span class="comment">// [rsp+40h] [rbp-30h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v7[<span class="number">5</span>] = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Let us play a game?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;you have six chances to input&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Come on!&quot;</span>);</span><br><span class="line">  input[<span class="number">0</span>] = <span class="number">0LL</span>;</span><br><span class="line">  input[<span class="number">1</span>] = <span class="number">0LL</span>;</span><br><span class="line">  input[<span class="number">2</span>] = <span class="number">0LL</span>;</span><br><span class="line">  input[<span class="number">3</span>] = <span class="number">0LL</span>;</span><br><span class="line">  input[<span class="number">4</span>] = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">5</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;input: &quot;</span>);</span><br><span class="line">    a2 = (<span class="type">char</span> **)((<span class="type">char</span> *)input + <span class="number">4</span> * i);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, a2);</span><br><span class="line">  &#125;</span><br><span class="line">  v7[<span class="number">0</span>] = <span class="number">0LL</span>;</span><br><span class="line">  v7[<span class="number">1</span>] = <span class="number">0LL</span>;</span><br><span class="line">  v7[<span class="number">2</span>] = <span class="number">0LL</span>;</span><br><span class="line">  v7[<span class="number">3</span>] = <span class="number">0LL</span>;</span><br><span class="line">  v7[<span class="number">4</span>] = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">2</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    dword_601078 = input[j];</span><br><span class="line">    dword_60107C = HIDWORD(input[j]);</span><br><span class="line">    a2 = (<span class="type">char</span> **)&amp;unk_601060;</span><br><span class="line">    sub_400686(&amp;dword_601078, &amp;unk_601060);</span><br><span class="line">    LODWORD(v7[j]) = dword_601078;</span><br><span class="line">    HIDWORD(v7[j]) = dword_60107C;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)sub_400770(v7, a2) != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;NO NO NO~ &quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Congratulation!\n&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You seccess half\n&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do not forget to change input to hex and combine~\n&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;ByeBye&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>戳进去sub_400770看看，是个判断，一大堆数字，还有负的，应该是IDA把变量识别为singed的问题，数字本身应该是unsinged，看了下别人转出来都是正的（呜呜呜呜呜呜呜呜），不过应当无影响<br>用这个方程组把数组a解出来，然后把前面的加密过程逆着写回去就可以了 <del>鹅鹅鹅，我先做了才看见RX的hint说用z3，我直接手解方程组了</del><br>当时看见一堆移位异或，还想着是不是什么高深的加密算法，应该不会是倒着写回去就可以的那种，看了题解， <del>呃好吧，还真是倒着写回去就行(bushi……</del><br>a2前面写了一堆没用的赋值，但最后运算的时候用的还是unk_601060，点进去看下，是2，2，3，4中间一堆0，应该是long long的锅，总之a2=[2,2,3,4]。<br>本来用python写了，但是这个玩意应该是有溢出的舍位，但是python不会溢出啊啊啊啊啊啊啊，打出来好长一串 <del>（裂开）</del>，我也不会用python限制数字位数，那就老老实实用C吧……注意小端序就好了，因为我们这是把他原本的long long拆成两个int。<br><del>对比了一下代码，我的代码跟别人写的题解都一样，懒得python转c了，直接嫖代码……</del></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> a[<span class="number">6</span>] = &#123; <span class="number">3746099070</span>, <span class="number">550153460</span>, <span class="number">3774025685</span>, <span class="number">1548802262</span>, <span class="number">2652626477</span>, <span class="number">2230518816</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> a2[<span class="number">4</span>] = &#123; <span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v3, v4;</span><br><span class="line">    <span class="type">int</span> v5;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">4</span>; j += <span class="number">2</span>) &#123;</span><br><span class="line">        v3 = a[j];</span><br><span class="line">        v4 = a[j + <span class="number">1</span>];</span><br><span class="line">        v5 = <span class="number">1166789954</span> * <span class="number">64</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0x3F</span>; ++i) &#123;</span><br><span class="line">            v4 -= (v3 + v5 + <span class="number">20</span>) ^ ((v3 &lt;&lt; <span class="number">6</span>) + a2[<span class="number">2</span>]) ^ ((v3 &gt;&gt; <span class="number">9</span>) + a2[<span class="number">3</span>]) ^ <span class="number">0x10</span>;</span><br><span class="line">            v3 -= (v4 + v5 + <span class="number">11</span>) ^ ((v4 &lt;&lt; <span class="number">6</span>) + *a2) ^ ((v4 &gt;&gt; <span class="number">9</span>) + a2[<span class="number">1</span>]) ^ <span class="number">0x20</span>;</span><br><span class="line">            v5 -= <span class="number">1166789954</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        a[j] = v3;</span><br><span class="line">        a[j + <span class="number">1</span>] = v4;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i) </span><br><span class="line">        <span class="comment">/*将整型数组作为字符输出，注意计算机小端排序*/</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c&quot;</span>, *((<span class="type">char</span>*)&amp;a[i] + <span class="number">2</span>), *((<span class="type">char</span>*)&amp;a[i] + <span class="number">1</span>), *(<span class="type">char</span>*)&amp;a[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="MRCTF2020-Xor"><a href="#MRCTF2020-Xor" class="headerlink" title="[MRCTF2020]Xor"></a>[MRCTF2020]Xor</h2><p>非常白给异或题~直接反编译主函数会报错，进去报错的那个函数然后反编译，再反编译主函数就可以了。（虽然不明白原理是什么）虽然前面写了一大堆代码，但是直接看判断条件就好了，判断一个长度之后跟索引异或，直接上脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="built_in">chr</span>(<span class="number">0x4d</span>)+<span class="string">r&#x27;SAWB~FXZ:J:`tQJ&quot;N@ bpdd&#125;8g&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i^<span class="built_in">ord</span>(s[i])),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe"></a>[FlareOn4]IgniteMe</h2><p>白给题，直接上脚本<br>注意这里异或用的是明文<br>然后就是学习了一下抠数字的快捷方法……</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">f2                   修改多处同名变量</span><br><span class="line">alt                  鼠标左键点击添加多个光标</span><br><span class="line">Ctrl+Alt+上下        添加多个光标</span><br><span class="line">shift+alt+i          选中一段摁住，每行末尾出现光标</span><br><span class="line">ctrl+shift+L</span><br><span class="line">ctrl+f2              在页面中出现这个词的不同地方都出现光标</span><br><span class="line">shift+alt            复制一行</span><br><span class="line">ctrl+U               取消任何光标操作</span><br><span class="line">alt+enter            上下移动一行</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">s=[<span class="number">0xd</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x2A</span>,<span class="number">0x17</span>,<span class="number">0x78</span>,<span class="number">0x44</span>,<span class="number">0x2B</span>,<span class="number">0x6C</span>,<span class="number">0x5D</span>,<span class="number">0x5E</span>,<span class="number">0x45</span>,<span class="number">0x12</span>,<span class="number">0x2f</span>,<span class="number">0x17</span>,<span class="number">0x2b</span>,<span class="number">0x44</span>,<span class="number">0x6F</span>,<span class="number">0x6E</span>,<span class="number">0x56</span>,<span class="number">9</span>,<span class="number">0x5f</span>,<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x73</span>,<span class="number">0x26</span>,<span class="number">0x0A</span>,<span class="number">0xd</span>,<span class="number">0x13</span>,<span class="number">0x17</span>,<span class="number">0x48</span>,<span class="number">0x42</span>,<span class="number">1</span>,<span class="number">0x40</span>,<span class="number">0x4D</span>,<span class="number">0x0C</span>,<span class="number">2</span>,<span class="number">0x69</span>]</span><br><span class="line">j=<span class="number">4</span></span><br><span class="line">string=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        string.append(s[i]^j)</span><br><span class="line">        j=string[-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(string)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(string[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="MRCTF2020-hello-world-go"><a href="#MRCTF2020-hello-world-go" class="headerlink" title="[MRCTF2020]hello_world_go"></a>[MRCTF2020]hello_world_go</h2><p>盲猜花指令，IDA进去红一片 <del>，明天再看看嘤嘤嘤</del><br><br>草，猜错了，是go语言。。。但是没啥用，F5进去之后有个叫aFlagHelloWorld的变量，flag就在这里。。。</p>
<h2 id="WUSTCTF2020-level3"><a href="#WUSTCTF2020-level3" class="headerlink" title="[WUSTCTF2020]level3"></a>[WUSTCTF2020]level3</h2><p>一个base64变表，啊啊啊啊，对着加密函数看了半天，明明是标准实现，晕了……看了题解才知道前面还有对base64进行变表的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">O_OLookAtYou</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// [rsp+1h] [rbp-5h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+2h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = base64_table[i];</span><br><span class="line">    base64_table[i] = base64_table[<span class="number">19</span> - i];</span><br><span class="line">    result = <span class="number">19</span> - i;</span><br><span class="line">    base64_table[result] = v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这贴个base64标准实现吧……</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">encodeBase64</span><span class="params">(<span class="type">char</span>* str,<span class="type">int</span> len,<span class="type">char</span>** in)</span>&#123;</span><br><span class="line">	<span class="type">char</span> base64[<span class="number">65</span>] = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>;</span><br><span class="line">	<span class="comment">//读取3个字节zxc，转换为二进制01111010 01111000 01100011</span></span><br><span class="line">    <span class="comment">//转换为4个6位字节，011110 100111 100001 100011</span></span><br><span class="line">    <span class="comment">//不足8位在前补0，变成00011110 00100111 00100001 00100011</span></span><br><span class="line">    <span class="comment">//若剩余的字节数不足以构成4个字节，补等号</span></span><br><span class="line">	<span class="type">int</span> encodeStrLen = <span class="number">1</span> + (len/<span class="number">3</span>)*<span class="number">4</span> ,k=<span class="number">0</span>;</span><br><span class="line">	encodeStrLen += len%<span class="number">3</span> ? <span class="number">4</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span>* encodeStr = (<span class="type">char</span>*)(<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">char</span>)*encodeStrLen));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">    	<span class="keyword">if</span>(len - i &gt;= <span class="number">3</span>)&#123;</span><br><span class="line">            encodeStr[k++] = base64[(<span class="type">unsigned</span> <span class="type">char</span>)str[i]&gt;&gt;<span class="number">2</span>];</span><br><span class="line">    		encodeStr[k++] = base64[((<span class="type">unsigned</span> <span class="type">char</span>)str[i]&amp;<span class="number">0x03</span>)&lt;&lt;<span class="number">4</span> | (<span class="type">unsigned</span> <span class="type">char</span>)str[++i]&gt;&gt;<span class="number">4</span>];</span><br><span class="line">    		encodeStr[k++] = base64[((<span class="type">unsigned</span> <span class="type">char</span>)str[i]&amp;<span class="number">0x0f</span>)&lt;&lt;<span class="number">2</span> | (<span class="type">unsigned</span> <span class="type">char</span>)str[++i]&gt;&gt;<span class="number">6</span>];</span><br><span class="line">            encodeStr[k++] = base64[(<span class="type">unsigned</span> <span class="type">char</span>)str[i]&amp;<span class="number">0x3f</span>];</span><br><span class="line">    	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(len-i == <span class="number">2</span>)&#123;</span><br><span class="line">            encodeStr[k++] = base64[(<span class="type">unsigned</span> <span class="type">char</span>)str[i] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">            encodeStr[k++] = base64[((<span class="type">unsigned</span> <span class="type">char</span>)str[i]&amp;<span class="number">0x03</span>) &lt;&lt; <span class="number">4</span> | ((<span class="type">unsigned</span> <span class="type">char</span>)str[++i] &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">            encodeStr[k++] = base64[((<span class="type">unsigned</span> <span class="type">char</span>)str[i]&amp;<span class="number">0x0f</span>) &lt;&lt; <span class="number">2</span>];</span><br><span class="line">            encodeStr[k++] = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">    	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    		encodeStr[k++] = base64[(<span class="type">unsigned</span> <span class="type">char</span>)str[i] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">            encodeStr[k++] = base64[((<span class="type">unsigned</span> <span class="type">char</span>)str[i] &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">4</span>];                                                                                                              <span class="comment">//末尾补两个等于号</span></span><br><span class="line">            encodeStr[k++] = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">            encodeStr[k++] = <span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    encodeStr[k] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    *in = encodeStr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 解码既编码的逆过程，先找出编码后的字符在编码之前代表的数字</span></span><br><span class="line"><span class="comment">* 编码中将3位个字符变成4个字符，得到这4个字符的每个字符代表的原本数字</span></span><br><span class="line"><span class="comment">* 因为在编码中间每个字符用base64码表进行了替换，所以这里要先换回来</span></span><br><span class="line"><span class="comment">* 在对换回来的数字进行位运算使其还原成3个字符</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decodeBase64</span><span class="params">(<span class="type">char</span>* str,<span class="type">int</span> len,<span class="type">char</span>** in)</span>&#123;</span><br><span class="line">	<span class="type">char</span> base64[<span class="number">65</span>] = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>;</span><br><span class="line">    <span class="type">char</span> ascill[<span class="number">129</span>];</span><br><span class="line">    <span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">64</span>;i++)&#123;</span><br><span class="line">        ascill[base64[i]] = k++;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="type">int</span> decodeStrlen = len / <span class="number">4</span> * <span class="number">3</span> + <span class="number">1</span>;</span><br><span class="line">	<span class="type">char</span>* decodeStr = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">char</span>)*decodeStrlen);</span><br><span class="line">	k = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        decodeStr[k++] = (ascill[str[i]] &lt;&lt; <span class="number">2</span>) | (ascill[str[++i]] &gt;&gt; <span class="number">4</span>);</span><br><span class="line">		<span class="keyword">if</span>(str[i+<span class="number">1</span>] == <span class="string">&#x27;=&#x27;</span>)&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">        decodeStr[k++] = (ascill[str[i]] &lt;&lt; <span class="number">4</span>) |  (ascill[str[++i]] &gt;&gt; <span class="number">2</span>);</span><br><span class="line">		<span class="keyword">if</span>(str[i+<span class="number">1</span>] == <span class="string">&#x27;=&#x27;</span>)&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">        decodeStr[k++] = (ascill[str[i]] &lt;&lt; <span class="number">6</span>) | (ascill[str[++i]]);</span><br><span class="line">	&#125;</span><br><span class="line">	decodeStr[k] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">	*in = decodeStr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后贴这个题的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">enc=<span class="string">&quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&quot;</span></span><br><span class="line">model=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="comment">#model:标准码表</span></span><br><span class="line">table=<span class="built_in">list</span>(<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span>)</span><br><span class="line"><span class="comment">#table:现码表</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    v=table[i]</span><br><span class="line">    table[i]=table[<span class="number">19</span>-i]</span><br><span class="line">    table[<span class="number">19</span>-i]=v</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">dec=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)-<span class="number">2</span>):</span><br><span class="line">    dec += model[table.index(enc[i])]</span><br><span class="line">dec+=<span class="string">&#x27;==&#x27;</span></span><br><span class="line"><span class="built_in">print</span> (base64.b64decode(dec))</span><br></pre></td></tr></table></figure>

<p>最后贴个base64变表的解码伪代码……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">enc=<span class="string">&quot;密文&quot;</span></span><br><span class="line">model=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"><span class="comment">#model:标准码表，不变</span></span><br><span class="line">table=<span class="built_in">list</span>(<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span>)</span><br><span class="line"><span class="comment">#table:更改后的码表</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">对table变换，更改为所用码表</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">dec=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):<span class="comment">#此处视情况，根据等号个数减去相应长度</span></span><br><span class="line">    dec += model[table.index(enc[i])]</span><br><span class="line">  </span><br><span class="line">dec+=<span class="string">&#x27;==&#x27;</span><span class="comment">#若原密文有等号，则在此处添加等号</span></span><br><span class="line"><span class="built_in">print</span> (base64.b64decode(dec))</span><br></pre></td></tr></table></figure>

<h2 id="WUSTCTF2020-Cr0ssfun"><a href="#WUSTCTF2020-Cr0ssfun" class="headerlink" title="[WUSTCTF2020]Cr0ssfun"></a>[WUSTCTF2020]Cr0ssfun</h2><p>很少见的抠ASCII码就能出来的题目……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">a1=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">    a1.append(<span class="number">0</span>)</span><br><span class="line">a1[<span class="number">10</span>]=<span class="number">112</span></span><br><span class="line">a1[<span class="number">13</span>]=<span class="number">64</span></span><br><span class="line">a1[<span class="number">0</span>]=<span class="number">119</span></span><br><span class="line">a1[<span class="number">6</span>] = <span class="number">50</span> </span><br><span class="line">a1[<span class="number">22</span>] = <span class="number">115</span> </span><br><span class="line">a1[<span class="number">31</span>] = <span class="number">110</span> </span><br><span class="line">a1[<span class="number">12</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">13</span>] = <span class="number">64</span></span><br><span class="line">a1[<span class="number">3</span>] = <span class="number">102</span></span><br><span class="line">a1[<span class="number">26</span>] = <span class="number">114</span></span><br><span class="line">a1[<span class="number">20</span>] = <span class="number">101</span></span><br><span class="line">a1[<span class="number">7</span>] = <span class="number">48</span></span><br><span class="line">a1[<span class="number">23</span>]=<span class="number">101</span></span><br><span class="line">a1[<span class="number">11</span>]=<span class="number">112</span></span><br><span class="line">a1[<span class="number">30</span>]=<span class="number">117</span></span><br><span class="line">a1[<span class="number">16</span>]=<span class="number">95</span></span><br><span class="line">a1[<span class="number">15</span>] = <span class="number">100</span></span><br><span class="line">a1[<span class="number">8</span>] = <span class="number">123</span></span><br><span class="line">a1[<span class="number">18</span>] = <span class="number">51</span></span><br><span class="line">a1[<span class="number">28</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">21</span>] = <span class="number">114</span></span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">116</span></span><br><span class="line">a1[<span class="number">9</span>] = <span class="number">99</span></span><br><span class="line">a1[<span class="number">32</span>] = <span class="number">125</span></span><br><span class="line">a1[<span class="number">19</span>] = <span class="number">118</span></span><br><span class="line">a1[<span class="number">5</span>] = <span class="number">48</span></span><br><span class="line">a1[<span class="number">14</span>] = <span class="number">110</span></span><br><span class="line">a1[<span class="number">4</span>] = <span class="number">50</span> </span><br><span class="line">a1[<span class="number">29</span>] = <span class="number">102</span> </span><br><span class="line">a1[<span class="number">17</span>] = <span class="number">114</span> </span><br><span class="line">a1[<span class="number">17</span>] = <span class="number">114</span> </span><br><span class="line">a1[<span class="number">24</span>] = <span class="number">95</span></span><br><span class="line">a1[<span class="number">1</span>] = <span class="number">99</span> </span><br><span class="line">a1[<span class="number">25</span>] = <span class="number">64</span> </span><br><span class="line">a1[<span class="number">27</span>] = <span class="number">101</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a1:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="BJDCTF2020-BJD-hamburger-competition-net逆向"><a href="#BJDCTF2020-BJD-hamburger-competition-net逆向" class="headerlink" title="[BJDCTF2020]BJD hamburger competition(.net逆向)"></a>[BJDCTF2020]BJD hamburger competition(.net逆向)</h2><p>看来很有必要了解一下.net和安卓逆向…… <del>（懒，先咕……）</del><br><br>甩个目录：<strong>attachment\BJD hamburger competition_Data\Managed\Assembly-CSharp.dll</strong> <br> C#源代码就在这里<br>关键函数：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (name == <span class="string">&quot;汉堡顶&quot;</span> &amp;&amp; Init.spawnCount == <span class="number">5</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				Init.secret ^= <span class="number">127</span>;</span><br><span class="line">				<span class="built_in">string</span> str = Init.secret.ToString();</span><br><span class="line">				<span class="keyword">if</span> (ButtonSpawnFruit.Sha1(str) == <span class="string">&quot;DD01903921EA24941C26A48F2CEC24E0BB0E8CC7&quot;</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">this</span>.result = <span class="string">&quot;BJDCTF&#123;&quot;</span> + ButtonSpawnFruit.Md5(str) + <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">					Debug.Log(<span class="keyword">this</span>.result);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到就是一个字符串的哈希值，SHA1已经给出来了，然后去看看ButtonSpawnFruit</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ButtonSpawnFruit</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// Token: 0x0600000A RID: 10 RVA: 0x00002110 File Offset: 0x00000310</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Md5</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">byte</span>[] bytes = Encoding.UTF8.GetBytes(str);</span><br><span class="line">		<span class="built_in">byte</span>[] array = MD5.Create().ComputeHash(bytes);</span><br><span class="line">		StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		<span class="keyword">foreach</span> (<span class="built_in">byte</span> b <span class="keyword">in</span> array)</span><br><span class="line">		&#123;</span><br><span class="line">			stringBuilder.Append(b.ToString(<span class="string">&quot;X2&quot;</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> stringBuilder.ToString().Substring(<span class="number">0</span>, <span class="number">20</span>);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>取了前20位的MD5，找个在线网站解一下SHA1，然后跑一下MD5，注意转成大写就好了，python都用的小写……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">s=<span class="string">&#x27;1001&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(s.encode(<span class="string">&#x27;utf8&#x27;</span>)).hexdigest()[<span class="number">0</span>:<span class="number">20</span>])</span><br><span class="line">s2=<span class="string">&#x27;b8c37e33defde51cf91e&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(s2.upper())</span><br></pre></td></tr></table></figure>

<h2 id="FlareOn6-Overlong"><a href="#FlareOn6-Overlong" class="headerlink" title="[FlareOn6]Overlong"></a>[FlareOn6]Overlong</h2><p>我真傻，真的，我竟然少写一个else，好多字符跑不出来，绝了……<br>看了下题解，这个好像是修改长度就行的…… <del>又小丑了……</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">encry=[<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0x89</span>,<span class="number">0xC0</span>,<span class="number">0xA0</span>,<span class="number">0xC1</span>,<span class="number">0xAE</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xA5</span>,<span class="number">0xC1</span>,<span class="number">0xB6</span>,<span class="number">0xF0</span>,<span class="number">0x80</span>,<span class="number">0x81</span>,<span class="number">0xA5</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xB2</span>,<span class="number">0xF0</span>,<span class="number">0x80</span>,<span class="number">0x80</span>,<span class="number">0xA0</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xA2</span>,<span class="number">0x72</span>,<span class="number">0x6F</span>,<span class="number">0xC1</span>,<span class="number">0xAB</span>,<span class="number">0x65</span>,<span class="number">0xE0</span>,<span class="number">0x80</span>,<span class="number">0xA0</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xB4</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xA8</span>,<span class="number">0xC1</span>,<span class="number">0xA5</span>,<span class="number">0x20</span>,<span class="number">0xC1</span>,<span class="number">0xA5</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xAE</span>,<span class="number">0x63</span>,<span class="number">0xC1</span>,<span class="number">0xAF</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xA4</span>,<span class="number">0xF0</span>,<span class="number">0x80</span>,<span class="number">0x81</span>,<span class="number">0xA9</span>,<span class="number">0x6E</span>,<span class="number">0xC1</span>,<span class="number">0xA7</span>,<span class="number">0xC0</span>,<span class="number">0xBA</span>,<span class="number">0x20</span>,<span class="number">0x49</span> ,<span class="number">0xF0</span>,<span class="number">0x80</span>,<span class="number">0x81</span>,<span class="number">0x9F</span>,<span class="number">0xC1</span>,<span class="number">0xA1</span>,<span class="number">0xC1</span>,<span class="number">0x9F</span>,<span class="number">0xC1</span>,<span class="number">0x8D</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0x9F</span>,<span class="number">0xC1</span>,<span class="number">0xB4</span>,<span class="number">0xF0</span>,<span class="number">0x80</span>,<span class="number">0x81</span>,<span class="number">0x9F</span>,<span class="number">0xF0</span>,<span class="number">0x80</span> ,<span class="number">0x81</span>,<span class="number">0xA8</span>,<span class="number">0xC1</span>,<span class="number">0x9F</span>,<span class="number">0xF0</span>,<span class="number">0x80</span>,<span class="number">0x81</span>,<span class="number">0xA5</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0x9F</span>,<span class="number">0xC1</span>,<span class="number">0xA5</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0x9F</span>,<span class="number">0xF0</span>,<span class="number">0x80</span>,<span class="number">0x81</span>,<span class="number">0xAE</span>,<span class="number">0xC1</span>,<span class="number">0x9F</span>,<span class="number">0xF0</span>,<span class="number">0x80</span>,<span class="number">0x81</span>,<span class="number">0x83</span>,<span class="number">0xC1</span>,<span class="number">0x9F</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xAF</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0x9F</span>,<span class="number">0xC1</span>,<span class="number">0x84</span>,<span class="number">0x5F</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xA9</span>,<span class="number">0xF0</span>,<span class="number">0x80</span> ,<span class="number">0x81</span>,<span class="number">0x9F</span>,<span class="number">0x6E</span> ,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0x9F</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xA7</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0x80</span> ,<span class="number">0xF0</span>,<span class="number">0x80</span> ,<span class="number">0x81</span>,<span class="number">0xA6</span>,<span class="number">0xF0</span>,<span class="number">0x80</span>,<span class="number">0x81</span>,<span class="number">0xAC</span>,<span class="number">0xE0</span>,<span class="number">0x81</span>,<span class="number">0xA1</span>,<span class="number">0xC1</span>,<span class="number">0xB2</span>,<span class="number">0xC1</span>,<span class="number">0xA5</span>,<span class="number">0xF0</span>,<span class="number">0x80</span> ,<span class="number">0x80</span> ,<span class="number">0xAD</span>,<span class="number">0xF0</span>,<span class="number">0x80</span> ,<span class="number">0x81</span>,<span class="number">0xAF</span>,<span class="number">0x6E</span> ,<span class="number">0xC0</span>,<span class="number">0xAE</span>,<span class="number">0xF0</span>,<span class="number">0x80</span> ,<span class="number">0x81</span>,<span class="number">0xA3</span>,<span class="number">0x6F</span> ,<span class="number">0xF0</span>,<span class="number">0x80</span> ,<span class="number">0x81</span>,<span class="number">0xAD</span>]</span><br><span class="line">text=[]</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="built_in">len</span>(encry):</span><br><span class="line">    <span class="keyword">if</span> encry[i]&gt;&gt;<span class="number">3</span>==<span class="number">30</span>:</span><br><span class="line">        text.append(encry[i+<span class="number">3</span>]&amp;<span class="number">0x3f</span>|(encry[i+<span class="number">2</span>]&amp;<span class="number">0x3f</span>)&lt;&lt;<span class="number">6</span>)</span><br><span class="line">        v3=<span class="number">4</span></span><br><span class="line">    <span class="keyword">elif</span> encry[i]&gt;&gt;<span class="number">4</span>==<span class="number">14</span>:</span><br><span class="line">        text.append(encry[i+<span class="number">2</span>]&amp;<span class="number">0x3f</span>|(encry[i+<span class="number">1</span>]&amp;<span class="number">0x3f</span>)&lt;&lt;<span class="number">6</span>)</span><br><span class="line">        v3=<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> encry[i]&gt;&gt;<span class="number">5</span>==<span class="number">6</span>:</span><br><span class="line">        text.append(encry[i+<span class="number">1</span>]&amp;<span class="number">0x3f</span>|(encry[i]&amp;<span class="number">0x1f</span>)&lt;&lt;<span class="number">6</span>)</span><br><span class="line">        v3=<span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        text.append(encry[i])</span><br><span class="line">        v3=<span class="number">1</span></span><br><span class="line">    i+=v3</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="ACTF新生赛2020-Oruga"><a href="#ACTF新生赛2020-Oruga" class="headerlink" title="[ACTF新生赛2020]Oruga"></a>[ACTF新生赛2020]Oruga</h2><p>最大的教训：看见四个字符还有一堆数据的一定要想到迷宫<br><br>迷宫题，真的很离谱啊这个……这个是走一次遇到障碍物停，不是一步一步走的<br>搜了下题解都是手动走迷宫的……<del>我干，手动也太强了</del>我一定要学会写深搜走迷宫啊啊啊啊啊<br><del>但是现在数据结构还在摆烂，所以就咕……</del></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__ __ __ __ 35 __ __ __ __ __ __ __ 35 35 35 35 </span><br><span class="line">__ __ __ 35 35 __ __ __ 79 79 __ __ __ __ __ __</span><br><span class="line">__ __ __ __ __ __ __ __ 79 79 __ 80 80 __ __ __</span><br><span class="line">__ __ __ 76 __ 79 79 __ 79 79 __ 80 80 __ __ __</span><br><span class="line">__ __ __ 76 __ 79 79 __ 79 79 __ 80 __ __ __ __</span><br><span class="line">__ __ 76 76 __ 79 79 __ __ __ __ 80 __ __ __ __</span><br><span class="line">35 __ __ __ __ __ __ __ __ __ __ __ __ __ __ __</span><br><span class="line">__ __ __ __ __ __ __ __ __ __ __ __ 35 __ __ __</span><br><span class="line">__ __ __ __ __ __ 77 77 77 __ __ __ 35 __ __ __</span><br><span class="line">__ __ __ __ __ __ __ 77 77 77 __ __ __ __ 69 69</span><br><span class="line">__ __ __ 48 __ 77 __ 77 __ 77 __ __ __ __ 69 __</span><br><span class="line">__ __ __ __ __ __ __ __ __ __ __ __ __ __ 69 69</span><br><span class="line">84 84 84 73 __ 77 __ 77 __ 77 __ __ __ __ 69 __</span><br><span class="line">__ 84 __ 73 __ 77 __ 77 __ 77 __ __ __ __ 69 __</span><br><span class="line">__ 84 __ 73 __ 77 __ 77 __ 77 33 __ __ __ 69 69</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="FlareOn3-Challenge1"><a href="#FlareOn3-Challenge1" class="headerlink" title="[FlareOn3]Challenge1"></a>[FlareOn3]Challenge1</h2><p>emmm还是base64变表，没啥好说的，用以前的脚本跑跑就好了。</p>
<h2 id="Zer0pts2020-easy-strcmp-hook"><a href="#Zer0pts2020-easy-strcmp-hook" class="headerlink" title="[Zer0pts2020]easy strcmp(hook)"></a>[Zer0pts2020]easy strcmp(hook)</h2><p>要学动调啊啊啊啊啊啊啊啊啊啊<br>草，，，裂开，，，，，看了好久才看懂这题，直接改DLL地址真的太强了……<br>先咕了，明天再写(bushi，这个题给我的震撼实在太过强烈…… <del>主要是网上所有题解都用同一段代码就nm离谱</del> 翻到一个外国人写的wp，然后再结合那个全网复制粘贴的wp才看懂到底怎么回事……<br>wp先贴这里</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#外国选手的</span></span><br><span class="line">v = [<span class="number">0x42</span>, <span class="number">0x09</span>, <span class="number">0x4a</span>, <span class="number">0x49</span>, <span class="number">0x35</span>, <span class="number">0x43</span>, <span class="number">0x0a</span>, <span class="number">0x41</span>, <span class="number">0xf0</span>, <span class="number">0x19</span>, <span class="number">0xe6</span>, <span class="number">0x0b</span>, <span class="number">0xf5</span>, <span class="number">0xf2</span>, <span class="number">0x0e</span>, <span class="number">0x0b</span>, <span class="number">0x2b</span>, <span class="number">0x28</span>, <span class="number">0x35</span>, <span class="number">0x4a</span>, <span class="number">0x06</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x4f</span>]</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">pattern = <span class="string">&#x27;********CENSORED********&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v)):</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> (<span class="number">9</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">14</span>):</span><br><span class="line">        res += (<span class="built_in">chr</span>((<span class="built_in">ord</span>(pattern[i]) + v[i] + <span class="number">1</span>) % <span class="number">256</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res += (<span class="built_in">chr</span>((<span class="built_in">ord</span>(pattern[i]) + v[i]) % <span class="number">256</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;zer0pts&#123;&quot;</span> + res + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#全网复制粘贴的(x</span></span><br><span class="line"><span class="comment">#不过不得不说写的是真的很简洁</span></span><br><span class="line">enc = <span class="string">&quot;********CENSORED********&quot;</span></span><br><span class="line">m = [<span class="number">0x410A4335494A0942</span>, <span class="number">0x0B0EF2F50BE619F0</span>, <span class="number">0x4F0A3A064A35282B</span>]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"> </span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    p = enc[i*<span class="number">8</span>:(i+<span class="number">1</span>)*<span class="number">8</span>]</span><br><span class="line">    a = binascii.b2a_hex(p.encode(<span class="string">&#x27;ascii&#x27;</span>)[::-<span class="number">1</span>])</span><br><span class="line">    b = binascii.a2b_hex(<span class="built_in">hex</span>(<span class="built_in">int</span>(a,<span class="number">16</span>) + m[i])[<span class="number">2</span>:])[::-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(p,a,b)</span><br><span class="line">    flag += b</span><br><span class="line"><span class="built_in">print</span> (flag)</span><br></pre></td></tr></table></figure>

<p>因为是有进位的问题，题目里是long直接加的，分组加的话有的进位就舍弃掉了，外国选手是动调发现这几个索引位置加了1，看了下bbs里track说他是看出来哪里进位的233~不过大概也就是，ASCII码大写字符是0x41到0x5a，那些f，e打头的肯定溢出啊</p>
<h2 id="UTCTF2020-basic-re"><a href="#UTCTF2020-basic-re" class="headerlink" title="[UTCTF2020]basic-re"></a>[UTCTF2020]basic-re</h2><p>拖进IDA就有flag，交上去竟然对了……</p>
<h2 id="crackMe"><a href="#crackMe" class="headerlink" title="crackMe"></a>crackMe</h2><p>代码逻辑都很好理解，花指令也很好认，主要是怎么获得byte_416050数组里拿来跟’dbappsec’异或的数据。<br>看了很多题解都说是动调，然后我个大傻子动调一直把jz改成jmp，这样有点小问题，改成jnz就可以了。然后树师傅告诉我这个其实可以静态分析出来，具体做法就是抠byte_416050里的数据，然后根据加密过程写脚本。不过byte_416050里的数据其实还是动调得出来的 <del>（我个大菜逼后来写脚本自己复现的时候才想到呜呜呜）</del><br>树师傅说这个玩意是rc4，好的，我又双叒叕要开始挖坑了……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="number">0x5E</span>,<span class="number">0xBE</span>,<span class="number">0x4D</span>,<span class="number">0x43</span>,<span class="number">0x24</span>,<span class="number">0xEB</span>,<span class="number">0x58</span>,<span class="number">0xE4</span> ,<span class="number">0xC2</span>,<span class="number">0x5C</span>,<span class="number">0xBD</span>,<span class="number">0xC4</span>,<span class="number">0xAB</span>,<span class="number">0x39</span>,<span class="number">0x1D</span>,<span class="number">0x73</span>,<span class="number">0x27</span>,<span class="number">0xD7</span>,<span class="number">0x88</span>,<span class="number">0xB8</span>,<span class="number">0xF6</span>,<span class="number">0xF9</span>,<span class="number">0x01</span>,<span class="number">0xF4</span> ,<span class="number">0x6D</span>,<span class="number">0xEF</span>,<span class="number">0x00</span>,<span class="number">0x15</span>,<span class="number">0x8C</span>,<span class="number">0xD5</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0xA5</span>,<span class="number">0x25</span>,<span class="number">0x36</span>,<span class="number">0x1A</span>,<span class="number">0x21</span>,<span class="number">0x47</span>,<span class="number">0xB4</span>,<span class="number">0x50</span> ,<span class="number">0xDA</span>,<span class="number">0xBF</span>,<span class="number">0x31</span>,<span class="number">0x32</span>,<span class="number">0x70</span>,<span class="number">0xC3</span>,<span class="number">0x60</span>,<span class="number">0xB9</span>,<span class="number">0xDB</span>,<span class="number">0x81</span>,<span class="number">0xAD</span>,<span class="number">0xF2</span>,<span class="number">0xE0</span>,<span class="number">0xC5</span>,<span class="number">0xAC</span>,<span class="number">0xC0</span> ,<span class="number">0x6F</span>,<span class="number">0x05</span>,<span class="number">0xB3</span>,<span class="number">0x51</span>,<span class="number">0xE7</span>,<span class="number">0xA6</span>,<span class="number">0xAE</span>,<span class="number">0x6B</span>,<span class="number">0x8F</span>,<span class="number">0x7D</span>,<span class="number">0xCF</span>,<span class="number">0x7B</span>,<span class="number">0xA3</span>,<span class="number">0x56</span>,<span class="number">0x5A</span>,<span class="number">0x9A</span> ,<span class="number">0xD4</span>,<span class="number">0x76</span>,<span class="number">0x42</span>,<span class="number">0x9F</span>,<span class="number">0x53</span>,<span class="number">0x80</span>,<span class="number">0xB5</span>,<span class="number">0x0F</span>,<span class="number">0xA0</span>,<span class="number">0xCB</span>,<span class="number">0x8B</span>,<span class="number">0xA1</span>,<span class="number">0x13</span>,<span class="number">0x2D</span>,<span class="number">0x85</span>,<span class="number">0x93</span> ,<span class="number">0xFE</span>,<span class="number">0xCC</span>,<span class="number">0x1B</span>,<span class="number">0xF0</span>,<span class="number">0x54</span>,<span class="number">0x61</span>,<span class="number">0x20</span>,<span class="number">0x1C</span>,<span class="number">0xFB</span>,<span class="number">0x7F</span>,<span class="number">0x17</span>,<span class="number">0x64</span>,<span class="number">0x4A</span>,<span class="number">0x9D</span>,<span class="number">0xD0</span>,<span class="number">0x03</span> ,<span class="number">0xA8</span>,<span class="number">0x2F</span>,<span class="number">0x37</span>,<span class="number">0x30</span>,<span class="number">0x3D</span>,<span class="number">0x33</span>,<span class="number">0xE2</span>,<span class="number">0x83</span>,<span class="number">0x8E</span>,<span class="number">0xD9</span>,<span class="number">0xB7</span>,<span class="number">0x18</span>,<span class="number">0xF7</span>,<span class="number">0x59</span>,<span class="number">0xDC</span>,<span class="number">0x0B</span> ,<span class="number">0x77</span>,<span class="number">0xAF</span>,<span class="number">0xEA</span>,<span class="number">0xB1</span>,<span class="number">0x10</span>,<span class="number">0x35</span>,<span class="number">0x7C</span>,<span class="number">0x55</span>,<span class="number">0x4B</span>,<span class="number">0x74</span>,<span class="number">0x26</span>,<span class="number">0xB2</span>,<span class="number">0x8D</span>,<span class="number">0x8A</span>,<span class="number">0x91</span>,<span class="number">0x97</span> ,<span class="number">0x89</span>,<span class="number">0xE8</span>,<span class="number">0xD2</span>,<span class="number">0x79</span>,<span class="number">0x3C</span>,<span class="number">0x44</span>,<span class="number">0x40</span>,<span class="number">0x5D</span>,<span class="number">0xCE</span>,<span class="number">0x9E</span>,<span class="number">0x9C</span>,<span class="number">0x3E</span>,<span class="number">0x75</span>,<span class="number">0x29</span>,<span class="number">0x72</span>,<span class="number">0x2B</span> ,<span class="number">0xBB</span>,<span class="number">0x1E</span>,<span class="number">0x6A</span>,<span class="number">0x28</span>,<span class="number">0x2E</span>,<span class="number">0x62</span>,<span class="number">0xDF</span>,<span class="number">0xA2</span>,<span class="number">0x02</span>,<span class="number">0x09</span>,<span class="number">0xBA</span>,<span class="number">0xC6</span>,<span class="number">0x3A</span>,<span class="number">0xB6</span>,<span class="number">0x4E</span>,<span class="number">0x7A</span> ,<span class="number">0x71</span>,<span class="number">0x38</span>,<span class="number">0x99</span>,<span class="number">0x65</span>,<span class="number">0xAA</span>,<span class="number">0x9B</span>,<span class="number">0x4C</span>,<span class="number">0xE6</span>,<span class="number">0x0C</span>,<span class="number">0x6C</span>,<span class="number">0xCD</span>,<span class="number">0xA7</span>,<span class="number">0xE3</span>,<span class="number">0x16</span>,<span class="number">0xD3</span>,<span class="number">0x19</span> ,<span class="number">0x49</span>,<span class="number">0xF5</span>,<span class="number">0x12</span>,<span class="number">0xC8</span>,<span class="number">0x41</span>,<span class="number">0xDE</span>,<span class="number">0x06</span>,<span class="number">0x07</span>,<span class="number">0x95</span>,<span class="number">0xD8</span>,<span class="number">0xFA</span>,<span class="number">0x66</span>,<span class="number">0x2A</span>,<span class="number">0x7E</span>,<span class="number">0x94</span>,<span class="number">0x0D</span> ,<span class="number">0x48</span>,<span class="number">0x90</span>,<span class="number">0xCA</span>,<span class="number">0x04</span>,<span class="number">0xED</span>,<span class="number">0x67</span>,<span class="number">0xE5</span>,<span class="number">0x4F</span>,<span class="number">0x2C</span>,<span class="number">0x1F</span>,<span class="number">0x14</span>,<span class="number">0xC1</span>,<span class="number">0xC9</span>,<span class="number">0xA4</span>,<span class="number">0xF8</span>,<span class="number">0x08</span> ,<span class="number">0xE1</span>,<span class="number">0xB0</span>,<span class="number">0xEC</span>,<span class="number">0xE9</span>,<span class="number">0xA9</span>,<span class="number">0x34</span>,<span class="number">0xDD</span>,<span class="number">0x57</span>,<span class="number">0x23</span>,<span class="number">0x87</span>,<span class="number">0xC7</span>,<span class="number">0xEE</span>,<span class="number">0x3B</span>,<span class="number">0x5B</span>,<span class="number">0x46</span>,<span class="number">0x69</span> ,<span class="number">0x84</span>,<span class="number">0x86</span>,<span class="number">0x0E</span>,<span class="number">0x96</span>,<span class="number">0x78</span>,<span class="number">0xD1</span>,<span class="number">0xFD</span>,<span class="number">0xFF</span>,<span class="number">0x68</span>,<span class="number">0xBC</span>,<span class="number">0x63</span>,<span class="number">0xF3</span>,<span class="number">0xD6</span>,<span class="number">0xFC</span>,<span class="number">0x82</span>,<span class="number">0x3F</span> ,<span class="number">0x92</span>,<span class="number">0x52</span>,<span class="number">0x6E</span>,<span class="number">0x5F</span>,<span class="number">0x22</span>,<span class="number">0xF1</span>,<span class="number">0x0A</span>,<span class="number">0x45</span>]</span><br><span class="line">v5,v11,v10=<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> v5&lt;<span class="number">8</span>:</span><br><span class="line">    v11+=<span class="number">1</span></span><br><span class="line">    v10+=enc[v11]</span><br><span class="line">    v12=enc[v11]</span><br><span class="line">    v10&amp;=<span class="number">0xff</span></span><br><span class="line">    v7=enc[v10]</span><br><span class="line">    enc[v10]=v12</span><br><span class="line">    enc[v11]=v7</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(enc[(v7+v12)&amp;<span class="number">0xff</span>]),end=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    v5+=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">s1=<span class="string">&#x27;dbappsec&#x27;</span></span><br><span class="line">passwd = <span class="string">&quot;&quot;</span></span><br><span class="line">byte_416050 = [<span class="number">0x2a</span>, <span class="number">0xd7</span>, <span class="number">0x92</span>, <span class="number">0xe9</span>, <span class="number">0x53</span>, <span class="number">0xe2</span>, <span class="number">0xc4</span>, <span class="number">0xcd</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    passwd += <span class="built_in">hex</span>(byte_416050[i]^<span class="built_in">ord</span>(s1[i]))[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(passwd.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest())</span><br></pre></td></tr></table></figure>

<h2 id="ACTF新生赛2020-Universe-final-answer-z3"><a href="#ACTF新生赛2020-Universe-final-answer-z3" class="headerlink" title="[ACTF新生赛2020]Universe_final_answer(z3)"></a>[ACTF新生赛2020]Universe_final_answer(z3)</h2><p>emmm就是z3解方程，直接上脚本，但是最后的flag不是这个，输入程序进去跑一下，会多出来个‘42’</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">s = Solver()</span><br><span class="line">v1 =Int(<span class="string">&#x27;v1&#x27;</span>)</span><br><span class="line">v2 =Int(<span class="string">&#x27;v2&#x27;</span>)</span><br><span class="line">v3 =Int(<span class="string">&#x27;v3&#x27;</span>)</span><br><span class="line">v4 =Int(<span class="string">&#x27;v4&#x27;</span>)</span><br><span class="line">v5 =Int(<span class="string">&#x27;v5&#x27;</span>)</span><br><span class="line">v6 =Int(<span class="string">&#x27;v6&#x27;</span>)</span><br><span class="line">v7 =Int(<span class="string">&#x27;v7&#x27;</span>)</span><br><span class="line">v8 =Int(<span class="string">&#x27;v8&#x27;</span>)</span><br><span class="line">v9 =Int(<span class="string">&#x27;v9&#x27;</span>)</span><br><span class="line">v11=Int(<span class="string">&#x27;v11&#x27;</span>)</span><br><span class="line">s.add(-<span class="number">85</span> * v9 + <span class="number">58</span> * v8 + <span class="number">97</span> * v6 + v7 + -<span class="number">45</span> * v5 + <span class="number">84</span> * v4 + <span class="number">95</span> * v2 - <span class="number">20</span> * v1 + <span class="number">12</span> * v3 == <span class="number">12613</span>)</span><br><span class="line">s.add(<span class="number">30</span> * v11 + -<span class="number">70</span> * v9 + -<span class="number">122</span> * v6 + -<span class="number">81</span> * v7 + -<span class="number">66</span> * v5 + -<span class="number">115</span> * v4 + -<span class="number">41</span> * v3 + -<span class="number">86</span> * v1 - <span class="number">15</span> * v2 - <span class="number">30</span> * v8 == -<span class="number">54400</span>)</span><br><span class="line">s.add(-<span class="number">103</span> * v11 + <span class="number">120</span> * v8 + <span class="number">108</span> * v7 + <span class="number">48</span> * v4 + -<span class="number">89</span> * v3 + <span class="number">78</span> * v1 - <span class="number">41</span> * v2 + <span class="number">31</span> * v5 - (v6 *<span class="number">64</span>) - <span class="number">120</span> * v9 == -<span class="number">10283</span>)</span><br><span class="line">s.add(<span class="number">71</span> * v6 + (v7 *<span class="number">128</span>) + <span class="number">99</span> * v5 + -<span class="number">111</span> * v3 + <span class="number">85</span> * v1 + <span class="number">79</span> * v2 - <span class="number">30</span> * v4 - <span class="number">119</span> * v8 + <span class="number">48</span> * v9 - <span class="number">16</span> * v11 == <span class="number">22855</span>)</span><br><span class="line">s.add(<span class="number">5</span> * v11 + <span class="number">23</span> * v9 + <span class="number">122</span> * v8 + -<span class="number">19</span> * v6 + <span class="number">99</span> * v7 + -<span class="number">117</span> * v5 + -<span class="number">69</span> * v3 + <span class="number">22</span> * v1 - <span class="number">98</span> * v2 + <span class="number">10</span> * v4 == -<span class="number">2944</span>)</span><br><span class="line">s.add(-<span class="number">54</span> * v11 + -<span class="number">23</span> * v8 + -<span class="number">82</span> * v3 + -<span class="number">85</span> * v2 + <span class="number">124</span> * v1 - <span class="number">11</span> * v4 - <span class="number">8</span> * v5 - <span class="number">60</span> * v7 + <span class="number">95</span> * v6 + <span class="number">100</span> * v9 == -<span class="number">2222</span>)</span><br><span class="line">s.add(-<span class="number">83</span> * v11 + -<span class="number">111</span> * v7 + -<span class="number">57</span> * v2 + <span class="number">41</span> * v1 + <span class="number">73</span> * v3 - <span class="number">18</span> * v4 + <span class="number">26</span> * v5 + <span class="number">16</span> * v6 + <span class="number">77</span> * v8 - <span class="number">63</span> * v9 == -<span class="number">13258</span>)</span><br><span class="line">s.add(<span class="number">81</span> * v11 + -<span class="number">48</span> * v9 + <span class="number">66</span> * v8 + -<span class="number">104</span> * v6 + -<span class="number">121</span> * v7 + <span class="number">95</span> * v5 + <span class="number">85</span> * v4 + <span class="number">60</span> * v3 + -<span class="number">85</span> * v2 + <span class="number">80</span> * v1 == -<span class="number">1559</span>)</span><br><span class="line">s.add(<span class="number">101</span> * v11 + -<span class="number">85</span> * v9 + <span class="number">7</span> * v6 + <span class="number">117</span> * v7 + -<span class="number">83</span> * v5 + -<span class="number">101</span> * v4 + <span class="number">90</span> * v3 + -<span class="number">28</span> * v1 + <span class="number">18</span> * v2 - v8 == <span class="number">6308</span>)</span><br><span class="line">s.add(<span class="number">99</span> * v11 + -<span class="number">28</span> * v9 + <span class="number">5</span> * v8 + <span class="number">93</span> * v6 + -<span class="number">18</span> * v7 + -<span class="number">127</span> * v5 + <span class="number">6</span> * v4 + -<span class="number">9</span> * v3 + -<span class="number">93</span> * v1 + <span class="number">58</span> * v2 == -<span class="number">1697</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    result = s.model()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">a1=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    a1.append(<span class="number">0</span>)</span><br><span class="line">v1 = <span class="number">48</span></span><br><span class="line">v6 = <span class="number">95</span></span><br><span class="line">v2 = <span class="number">70</span></span><br><span class="line">v4 = <span class="number">82</span></span><br><span class="line">v11 = <span class="number">64</span></span><br><span class="line">v3 = <span class="number">117</span></span><br><span class="line">v5 = <span class="number">84</span></span><br><span class="line">v7 = <span class="number">121</span></span><br><span class="line">v9 = <span class="number">119</span></span><br><span class="line">v8 = <span class="number">55</span></span><br><span class="line">a1[<span class="number">1</span>]=v1</span><br><span class="line">a1[<span class="number">0</span>]=v2</span><br><span class="line">a1[<span class="number">2</span>]=v3</span><br><span class="line">a1[<span class="number">3</span>]=v4</span><br><span class="line">a1[<span class="number">4</span>]=v5</span><br><span class="line">a1[<span class="number">6</span>]=v6</span><br><span class="line">a1[<span class="number">5</span>]=v7</span><br><span class="line">a1[<span class="number">7</span>]=v8</span><br><span class="line">a1[<span class="number">8</span>]=v9</span><br><span class="line">a1[<span class="number">9</span>]=v11</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a1:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="WUSTCTF2020-level4-二叉树遍历算法"><a href="#WUSTCTF2020-level4-二叉树遍历算法" class="headerlink" title="[WUSTCTF2020]level4(二叉树遍历算法)"></a>[WUSTCTF2020]level4(二叉树遍历算法)</h2><p>忘了，这题竟然没看过……俩二叉树遍历<br>看来还是得先跑一下程序看看再逆……输出来一个中序遍历一个后序遍历的结果，在网上嫖算法跑一下(bushi</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="type">char</span> post[] = &#123;<span class="string">&quot;20f0Th&#123;2tsIS_icArE&#125;e7__w&quot;</span>&#125;;  </span><br><span class="line"><span class="type">char</span> mid[] = &#123;<span class="string">&quot;2f0t02T&#123;hcsiI_SwA__r7Ee&#125;&quot;</span>&#125;;  </span><br><span class="line"><span class="type">void</span> <span class="title function_">pre</span><span class="params">(<span class="type">int</span> root, <span class="type">int</span> start, <span class="type">int</span> end)</span> </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">if</span>(start &gt; end)   </span><br><span class="line">        <span class="keyword">return</span> ;  </span><br><span class="line">    <span class="type">int</span> i = start;  </span><br><span class="line">    <span class="keyword">while</span>(i &lt; end &amp;&amp; mid[i] != post[root]) i++;  <span class="comment">//定位根在中序的位置</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,mid[i]);  <span class="comment">//访问当前处理的树的根</span></span><br><span class="line">    pre(root<span class="number">-1</span>-(end-i), start, i - <span class="number">1</span>);  <span class="comment">//递归处理左子树</span></span><br><span class="line">    pre(root<span class="number">-1</span>, i + <span class="number">1</span>, end);  <span class="comment">//递归处理右子树  </span></span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    pre(<span class="number">24</span>, <span class="number">0</span>, <span class="number">24</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="网鼎杯-2020-青龙组-singal"><a href="#网鼎杯-2020-青龙组-singal" class="headerlink" title="[网鼎杯 2020 青龙组]singal"></a>[网鼎杯 2020 青龙组]singal</h2><p><del>VM逆向，裂开，看不懂……</del><br>草了，第一次见识angr这种东西，嫖一下树师傅的代码<br>by the way:angr这个库搜了下安装教程全是linux，开开心心在kali上装好之后怀着激动的心情一用，发现自己完全忘了这个题的文件是exe，又爬回windows装angr……装了一下午一直报错，有点绝望就收拾东西准备去操场打个卡。准备走的时候突然想到是不是跟梯子有关系，于是连忙打开电脑关了梯子，直接pip install angr就装好了……md，我是小丑……<br>但是我不理解，这库在什么时候能用什么时候不能用呢？<del>那就……挖个坑吧~(bushi</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line">proj = angr.Project(<span class="string">&#x27;signal.exe&#x27;</span>,auto_load_libs = <span class="literal">False</span>)</span><br><span class="line">state = proj.factory.entry_state() <span class="comment"># 根据镜像创建进程</span></span><br><span class="line">simgr = proj.factory.simgr(state)  <span class="comment"># 创建一个模拟器，用来模拟执行求解</span></span><br><span class="line">simgr.explore(find = <span class="number">0x40179E</span>,avoid = <span class="number">0x401539</span>)  <span class="comment"># 成功的地址和失败的地址</span></span><br><span class="line"><span class="built_in">print</span> (simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>))  <span class="comment"># 把要找的结果输出</span></span><br></pre></td></tr></table></figure>

<p>复现，大概有点理解VM了。by the way，IDA里是什么数据类型，写脚本就用什么数据类型，不然会出锅……我tm把程序变量名都改成WP里的变量名一个一个对比，结果发现是char类型的锅，用unsigned char就好了……半年没用C语言真的不会写程序了都……<br>IDA里直接贴的代码，有点丑，就这样吧懒得修了hhh</p>
<p>首先是根据case7找对比的字符，即密文。然后去找opcode调用的索引，然后根据索引逆序写解密。为什么不能直接写逆序而要先去找调用的索引？因为opcode根据case的不同有不同的偏移，从后往前找调用索引的话要先知道前一个opcode的偏移是多少，但是要去找前一个又要找前一个，hhh，所以只能先找索引。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> opcode[]=&#123;<span class="number">0xa</span>,<span class="number">0x4</span>,<span class="number">0x10</span>,<span class="number">0x8</span>,<span class="number">0x3</span>,<span class="number">0x5</span>,<span class="number">0x1</span>,<span class="number">0x4</span>,<span class="number">0x20</span>,<span class="number">0x8</span>,<span class="number">0x5</span>,<span class="number">0x3</span>,<span class="number">0x1</span>,<span class="number">0x3</span>,<span class="number">0x2</span>,<span class="number">0x8</span>,<span class="number">0xb</span>,<span class="number">0x1</span>,<span class="number">0xc</span>,<span class="number">0x8</span>,<span class="number">0x4</span>,<span class="number">0x4</span>,<span class="number">0x1</span>,<span class="number">0x5</span>,<span class="number">0x3</span>,<span class="number">0x8</span>,<span class="number">0x3</span>,<span class="number">0x21</span>,<span class="number">0x1</span>,<span class="number">0xb</span>,<span class="number">0x8</span>,<span class="number">0xb</span>,<span class="number">0x1</span>,<span class="number">0x4</span>,<span class="number">0x9</span>,<span class="number">0x8</span>,<span class="number">0x3</span>,<span class="number">0x20</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x51</span>,<span class="number">0x8</span>,<span class="number">0x4</span>,<span class="number">0x24</span>,<span class="number">0x1</span>,<span class="number">0xc</span>,<span class="number">0x8</span>,<span class="number">0xb</span>,<span class="number">0x1</span>,<span class="number">0x5</span>,<span class="number">0x2</span>,<span class="number">0x8</span>,<span class="number">0x2</span>,<span class="number">0x25</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x36</span>,<span class="number">0x8</span>,<span class="number">0x4</span>,<span class="number">0x41</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x20</span>,<span class="number">0x8</span>,<span class="number">0x5</span>,<span class="number">0x1</span>,<span class="number">0x1</span>,<span class="number">0x5</span>,<span class="number">0x3</span>,<span class="number">0x8</span>,<span class="number">0x2</span>,<span class="number">0x25</span>,<span class="number">0x1</span>,<span class="number">0x4</span>,<span class="number">0x9</span>,<span class="number">0x8</span>,<span class="number">0x3</span>,<span class="number">0x20</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x41</span>,<span class="number">0x8</span>,<span class="number">0xc</span>,<span class="number">0x1</span>,<span class="number">0x7</span>,<span class="number">0x22</span>,<span class="number">0x7</span>,<span class="number">0x3f</span>,<span class="number">0x7</span>,<span class="number">0x34</span>,<span class="number">0x7</span>,<span class="number">0x32</span>,<span class="number">0x7</span>,<span class="number">0x72</span>,<span class="number">0x7</span>,<span class="number">0x33</span>,<span class="number">0x7</span>,<span class="number">0x18</span>,<span class="number">0x7</span>,<span class="number">0xffffffa7</span>,<span class="number">0x7</span>,<span class="number">0x31</span>,<span class="number">0x7</span>,<span class="number">0xfffffff1</span>,<span class="number">0x7</span>,<span class="number">0x28</span>,<span class="number">0x7</span>,<span class="number">0xffffff84</span>,<span class="number">0x7</span>,<span class="number">0xffffffc1</span>,<span class="number">0x7</span>,<span class="number">0x1e</span>,<span class="number">0x7</span>,<span class="number">0x7a</span>&#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> v4[]=&#123;<span class="number">0x22</span>,<span class="number">0x3f</span>,<span class="number">0x34</span>,<span class="number">0x32</span>,<span class="number">0x72</span>,<span class="number">0x33</span>,<span class="number">0x18</span>,<span class="number">0xffffffa7</span>,<span class="number">0x31</span>,<span class="number">0xfffffff1</span>,<span class="number">0x28</span>,<span class="number">0xffffff84</span>,<span class="number">0xffffffc1</span>,<span class="number">0x1e</span>,<span class="number">0x7a</span>&#125;;</span><br><span class="line">	<span class="type">int</span> index[<span class="number">100</span>]=&#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>,<span class="number">33</span>,<span class="number">35</span>,<span class="number">36</span>,<span class="number">38</span>,<span class="number">39</span>,<span class="number">41</span>,<span class="number">42</span>,<span class="number">44</span>,<span class="number">45</span>,<span class="number">46</span>,<span class="number">47</span>,<span class="number">48</span>,<span class="number">49</span>,<span class="number">51</span>,<span class="number">52</span>,<span class="number">54</span>,<span class="number">55</span>,<span class="number">57</span>,<span class="number">58</span>,<span class="number">60</span>,<span class="number">61</span>,<span class="number">63</span>,<span class="number">64</span>,<span class="number">66</span>,<span class="number">67</span>,<span class="number">69</span>,<span class="number">70</span>,<span class="number">72</span>,<span class="number">73</span>,<span class="number">75</span>,<span class="number">76</span>,<span class="number">78</span>,<span class="number">79</span>,<span class="number">81</span>,<span class="number">82</span>,<span class="number">83</span>,<span class="number">84</span>&#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> flag[<span class="number">200</span>];</span><br><span class="line">	<span class="type">int</span> vm_eip;</span><br><span class="line">	<span class="type">int</span> m=<span class="number">15</span>,z=<span class="number">15</span>,x=<span class="number">15</span>,v7=<span class="number">15</span>,v5;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">60</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">		vm_eip=index[i];</span><br><span class="line">    <span class="keyword">switch</span> ( opcode[vm_eip] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        --z;</span><br><span class="line">        --x;</span><br><span class="line">		v5=v4[z];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:                                   <span class="comment">// 2:rot(v)</span></span><br><span class="line">        flag[x] = v5 - opcode[vm_eip + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:                                   <span class="comment">// 3:rot(-v)</span></span><br><span class="line">        flag[x] = v5 + opcode[vm_eip + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:                                   <span class="comment">// 4:xor</span></span><br><span class="line">        flag[x] = opcode[vm_eip + <span class="number">1</span>] ^ v5;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:                                   <span class="comment">// 5:mult</span></span><br><span class="line">        flag[x] = v5 / opcode[vm_eip + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:                                   <span class="comment">// 6:nop</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:                                   <span class="comment">// 8:mov</span></span><br><span class="line">        v5 = flag[--m];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">11</span>:                                  <span class="comment">// 11:rot(-1)</span></span><br><span class="line">        flag[x] = v5 + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">12</span>:                                  <span class="comment">// 12:rot(1)</span></span><br><span class="line">        flag[x] = v5 - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,flag);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="firmware-固件逆向"><a href="#firmware-固件逆向" class="headerlink" title="firmware(固件逆向)"></a>firmware(固件逆向)</h2><p>装包装了一晚上…… <del>要死</del>最后还是拆出来了，太感动了呜呜呜呜呜<br>kali整了半天，最后还是屈服于ubuntu了……<br>谷歌yyds，ubuntu的报错微软浏览器根本搜不到，还是谷歌救我狗命……</p>
<h2 id="GUET-CTF2019-number-game"><a href="#GUET-CTF2019-number-game" class="headerlink" title="[GUET-CTF2019]number_game"></a>[GUET-CTF2019]number_game</h2><p>裂开……当时没理解前边两个函数在做什么变换，后面赋值和检查操作猜出来应该是数独，自己手动解出来交上去不对，去搜题解才知道前面那两个没看懂的函数是二叉树遍历……昨天晚上才给室友讲了中序遍历，那两个遍历函数就是一个先序一个中序把输入顺序重新排布了一下，我竟然没反应过来，太小丑了，我还奇怪这一堆递归是在干什么……<br> <del>数据结构不能再摆烂了呜呜呜呜呜</del>二叉树手动走的，下标0-9构造二叉查找树，然后手动中序遍历一下，下标打出来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">maze=[<span class="number">0x31</span>,<span class="number">0x34</span>,<span class="number">0x23</span>,<span class="number">0x32</span>,<span class="number">0x33</span>,<span class="number">0x33</span>,<span class="number">0x30</span>,<span class="number">0x23</span>,<span class="number">0x31</span>,<span class="number">0x23</span>,<span class="number">0x30</span>,<span class="number">0x23</span>,<span class="number">0x32</span>,<span class="number">0x33</span>,<span class="number">0x23</span>,<span class="number">0x23</span>,<span class="number">0x33</span>,<span class="number">0x23</span>,<span class="number">0x23</span>,<span class="number">0x30</span>,<span class="number">0x34</span>,<span class="number">0x32</span>,<span class="number">0x23</span>,<span class="number">0x23</span>,<span class="number">0x31</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(maze)):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">5</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">if</span> maze[i]==<span class="number">0x23</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;#&quot;</span>,end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(maze[i]),end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">1 4 # 2 3</span></span><br><span class="line"><span class="string">3 0 # 1 #</span></span><br><span class="line"><span class="string">0 # 2 3 #</span></span><br><span class="line"><span class="string"># 3 # # 0</span></span><br><span class="line"><span class="string">4 2 # # 1</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">f=<span class="string">&#x27;0421421430&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">table=[<span class="number">7</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">6</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(f)):</span><br><span class="line">    flag+=f[table.index(i)]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="特殊的-BASE64"><a href="#特殊的-BASE64" class="headerlink" title="特殊的 BASE64"></a>特殊的 BASE64</h2><p>变表，没啥好说的，抄脚本跑就好了……</p>
<h2 id="findKey"><a href="#findKey" class="headerlink" title="findKey"></a>findKey</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s1=<span class="string">&#x27;0kk`d1a`55k222k2a776jbfgd`06cjjb&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s1:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(<span class="string">&#x27;S&#x27;</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">enc=<span class="string">&#x27;123321&#x27;</span></span><br><span class="line">s2=[<span class="number">0x57</span>,<span class="number">0x5E</span>,<span class="number">0x52</span>,<span class="number">0x54</span>,<span class="number">0x49</span>,<span class="number">0x5F</span>,<span class="number">0x01</span>,<span class="number">0x6D</span> ,<span class="number">0x69</span>,<span class="number">0x46</span>,<span class="number">0x02</span>,<span class="number">0x6E</span>,<span class="number">0x5F</span>,<span class="number">0x02</span>,<span class="number">0x6C</span>,<span class="number">0x57</span>,<span class="number">0x5B</span>,<span class="number">0x54</span>,<span class="number">0x4C</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s2)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(s2[i]^<span class="built_in">ord</span>(enc[i%<span class="number">6</span>])),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="GXYCTF2019-simple-CPP"><a href="#GXYCTF2019-simple-CPP" class="headerlink" title="[GXYCTF2019]simple CPP"></a>[GXYCTF2019]simple CPP</h2><p>看了一晚上，属实是麻中麻中麻，最后发现复制错了一个数据，woc………………不想再看了，代码扔这吧……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x,y,z,w=BitVecs(<span class="string">&#x27;x y z w&#x27;</span>,<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">s=Solver()</span><br><span class="line"></span><br><span class="line">s.add((~x)&amp;z==<span class="number">0x11204161012</span>)</span><br><span class="line">s.add(((z&amp;~x)|(x&amp;y)|(z&amp;(~y))|(x&amp;(~y)))^w==<span class="number">0x3E3A4717050F791F</span>)</span><br><span class="line">s.add(((z&amp;~y)&amp;x|z&amp;((x&amp;y)|y&amp;~x|~(y|x)))==<span class="number">0x8020717153E3013</span>)</span><br><span class="line">s.add(((z&amp;~x)|(x&amp;y)|(z&amp;~y)|(x&amp;~y))==<span class="number">0x3E3A4717373E7F1F</span>)</span><br><span class="line">s.add(((z&amp;(~x)) | (x&amp;y) | y &amp; z) == (((~x)&amp; z)|<span class="number">0xC00020130082C0C</span>))</span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line">m = s.model()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%s = 0x%x&quot;</span>%(i,m[i].as_long()))flag=[<span class="number">0x3E</span>,<span class="number">0x3A</span>,<span class="number">0x46</span>,<span class="number">0x05</span>,<span class="number">0x33</span>,<span class="number">0x28</span>,<span class="number">0x6F</span>,<span class="number">0x0D</span>,</span><br><span class="line"><span class="number">0x8C</span>,<span class="number">0x00</span>,<span class="number">0x8A</span>,<span class="number">0x09</span>,<span class="number">0x78</span>,<span class="number">0x49</span>,<span class="number">0x2C</span>,<span class="number">0xAC</span>,</span><br><span class="line"><span class="number">0x08</span>,<span class="number">0x02</span>,<span class="number">0x07</span>,<span class="number">0x17</span>,<span class="number">0x15</span>,<span class="number">0x3E</span>,<span class="number">0x30</span>,<span class="number">0x13</span>,<span class="number">0x32</span>,<span class="number">0x31</span>,<span class="number">0x06</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">y = <span class="number">0x0c00020130082c0c</span></span><br><span class="line">x = <span class="number">0x3e3a460533286f0d</span></span><br><span class="line">w = <span class="number">0x32310600</span></span><br><span class="line">z = <span class="number">0x08020717153e3013</span></span><br><span class="line">s=<span class="string">&#x27;i_will_check_is_debug_or_not&#x27;</span></span><br><span class="line">flag=[<span class="number">0x3e</span>,<span class="number">0x3a</span>,<span class="number">0x46</span>,<span class="number">0x05</span>,<span class="number">0x33</span>,<span class="number">0x28</span>,<span class="number">0x6f</span>,<span class="number">0x0d</span>,</span><br><span class="line"><span class="number">0x0c</span>,<span class="number">0x00</span>,<span class="number">0x02</span>,<span class="number">0x01</span>,<span class="number">0x30</span>,<span class="number">0x08</span>,<span class="number">0x2c</span>,<span class="number">0x0c</span>,</span><br><span class="line"><span class="number">0x08</span>,<span class="number">0x02</span>,<span class="number">0x07</span>,<span class="number">0x17</span>,<span class="number">0x15</span>,<span class="number">0x3E</span>,<span class="number">0x30</span>,<span class="number">0x13</span>,<span class="number">0x32</span>,<span class="number">0x31</span>,<span class="number">0x06</span>]</span><br><span class="line"></span><br><span class="line">t=<span class="string">&#x27;We1l_D0ne!P0or_algebra_am_i&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">ord</span>(t[i])^<span class="built_in">ord</span>(s[i])),end=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="GWCTF-2019-re3"><a href="#GWCTF-2019-re3" class="headerlink" title="[GWCTF 2019]re3"></a>[GWCTF 2019]re3</h2><p>神奇的题，忘了写了，那就~咕……</p>
<h2 id="FlareOn5-Minesweeper-Championship-Registration"><a href="#FlareOn5-Minesweeper-Championship-Registration" class="headerlink" title="[FlareOn5]Minesweeper Championship Registration"></a>[FlareOn5]Minesweeper Championship Registration</h2><p>属于是打开就有flag……</p>
<h2 id="网鼎杯-2020-青龙组-jocker"><a href="#网鼎杯-2020-青龙组-jocker" class="headerlink" title="[网鼎杯 2020 青龙组]jocker"></a>[网鼎杯 2020 青龙组]jocker</h2><p><del>麻中麻中麻中麻中麻中麻</del>一个简单的SMC，解密之后直接分析就好了，然后看伪代码。蚌埠住了，，，都是靠猜的……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">buff=<span class="string">&#x27;hahahaha_do_you_find_me?&#x27;</span></span><br><span class="line">a=[<span class="number">0x0E</span>,<span class="number">0x0D</span>,<span class="number">0x09</span>,<span class="number">0x06</span>,<span class="number">0x13</span>,<span class="number">0x05</span>,<span class="number">0x58</span>,<span class="number">0x56</span>,<span class="number">0x3E</span>,<span class="number">0x06</span>,<span class="number">0x0C</span>,<span class="number">0x3C</span>,<span class="number">0x1F</span>,<span class="number">0x57</span>,<span class="number">0x14</span>,<span class="number">0x6B</span>,<span class="number">0x57</span>,<span class="number">0x59</span>,<span class="number">0x0D</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(buff[i])^a[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">b=<span class="string">&#x27;%tp&amp;:&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(b[i])^<span class="number">0x3a</span>^<span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="2019红帽杯-xx"><a href="#2019红帽杯-xx" class="headerlink" title="[2019红帽杯]xx"></a>[2019红帽杯]xx</h2><p>非常屑的题……转小端序的时候有一个数据小于16所以一个数据中间少打个0，nm这个错误我查了一晚上。啥也不说了，上脚本转大小端序，我真就不信了。<br>话说这两个过程竟然是一个加密一个解密，不过我不理解为什么解密过程不用逆序……（试了一下逆序也可以……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="number">206</span>, <span class="number">188</span>, <span class="number">64</span>, <span class="number">165</span>, <span class="number">178</span>, <span class="number">244</span>, <span class="number">231</span>, <span class="number">178</span>, <span class="number">157</span>, <span class="number">169</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">200</span>, <span class="number">174</span>, <span class="number">91</span>, <span class="number">16</span>, <span class="number">6</span>, <span class="number">61</span>, <span class="number">29</span>, <span class="number">215</span>, <span class="number">248</span>, <span class="number">220</span>, <span class="number">220</span>, <span class="number">112</span>]</span><br><span class="line">dec=[<span class="number">206</span>, <span class="number">188</span>, <span class="number">64</span>, <span class="number">107</span>, <span class="number">124</span>, <span class="number">58</span>, <span class="number">149</span>, <span class="number">192</span>, <span class="number">239</span>, <span class="number">155</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">145</span>, <span class="number">247</span>, <span class="number">2</span>, <span class="number">53</span>, <span class="number">35</span>, <span class="number">24</span>, <span class="number">2</span>, <span class="number">200</span>, <span class="number">231</span>, <span class="number">86</span>, <span class="number">86</span>, <span class="number">250</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i//<span class="number">3</span>):</span><br><span class="line">        enc[i]^=enc[j]</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i//<span class="number">3</span>):</span><br><span class="line">        dec[i]^=dec[j]</span><br><span class="line"><span class="built_in">print</span>(dec)</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">xxtea</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n, <span class="type">uint32_t</span>* key)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)             <span class="comment">// encrypt</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">// decrypt</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds * DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">6</span>] = &#123;<span class="number">0x40cea5bc</span>,<span class="number">0xe7b2b2f4</span>,<span class="number">0x129d12a9</span>,<span class="number">0x5bc810ae</span>,<span class="number">0x1d06d73d</span>,<span class="number">0xdcf870dc</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> k[<span class="number">4</span>]= &#123;<span class="number">0x67616c66</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">6</span>;</span><br><span class="line">    <span class="type">char</span> *s;</span><br><span class="line">    s=(<span class="type">char</span>*)v;</span><br><span class="line"></span><br><span class="line">    xxtea(v, -n, k);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">19</span>;i++)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="type">char</span>)s[i]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ACTF新生赛2020-SoulLike"><a href="#ACTF新生赛2020-SoulLike" class="headerlink" title="[ACTF新生赛2020]SoulLike"></a>[ACTF新生赛2020]SoulLike</h2><p>代码太长反编译挂了，去配置文件里改了max_funcsize就能反编译出来<br>不会用pwntools只能复制代码用C强行爆了（捂嘴 <br><del>怪不得说逆向手也得会点pwn呜呜呜（不就是懒得学pwn</del> <br>中间的代码太长就不贴了，就是把IDA里的代码复制出来，然后用多光标简单处理一下（结尾u去掉，前面加0X）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">char</span> a1[<span class="number">11</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">sub</span><span class="params">(<span class="type">char</span>* a1)</span></span><br><span class="line">&#123;</span><br><span class="line">    ……</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-44h]</span></span><br><span class="line">    <span class="type">int</span> v3[<span class="number">14</span>],j,x; <span class="comment">// [rsp+20h] [rbp-40h]</span></span><br><span class="line">    <span class="type">char</span> t[<span class="number">20</span>];</span><br><span class="line">    v3[<span class="number">0</span>] = <span class="number">126</span>;</span><br><span class="line">    v3[<span class="number">1</span>] = <span class="number">50</span>;</span><br><span class="line">    v3[<span class="number">2</span>] = <span class="number">37</span>;</span><br><span class="line">    v3[<span class="number">3</span>] = <span class="number">88</span>;</span><br><span class="line">    v3[<span class="number">4</span>] = <span class="number">89</span>;</span><br><span class="line">    v3[<span class="number">5</span>] = <span class="number">107</span>;</span><br><span class="line">    v3[<span class="number">6</span>] = <span class="number">53</span>;</span><br><span class="line">    v3[<span class="number">7</span>] = <span class="number">110</span>;</span><br><span class="line">    v3[<span class="number">8</span>] = <span class="number">0</span>;</span><br><span class="line">    v3[<span class="number">9</span>] = <span class="number">19</span>;</span><br><span class="line">    v3[<span class="number">10</span>] = <span class="number">30</span>;</span><br><span class="line">    v3[<span class="number">11</span>] = <span class="number">56</span>;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">11</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">0x7e</span>;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(x=<span class="number">0</span>;x&lt;i;x++)</span><br><span class="line">            a1[x]=t[x];</span><br><span class="line"></span><br><span class="line">            a1[i]=j;</span><br><span class="line">            sub(a1);</span><br><span class="line">            <span class="keyword">if</span>(v3[i] == a1[i] )</span><br><span class="line">                t[i]=j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,t);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="FlareOn5-Ultimate-Minesweeper"><a href="#FlareOn5-Ultimate-Minesweeper" class="headerlink" title="[FlareOn5]Ultimate Minesweeper"></a>[FlareOn5]Ultimate Minesweeper</h2><p>C#，难顶。把检测错误的代码注释掉，然后跑程序，所有雷都点出来硬莽……看有的师傅的题解是可以查看local类里的数据拿到三个正确的地址，不过不知道为什么我的看不了……还在研究这个问题……</p>
<h2 id="FlareOn1-Bob-Doge"><a href="#FlareOn1-Bob-Doge" class="headerlink" title="[FlareOn1]Bob Doge"></a>[FlareOn1]Bob Doge</h2><p>.net逆向，虽然动调更快一些，但还是想学一下怎么在dnspy里dump数据出来。<br>查看加密函数，是对dat_secret解密，解密后对flag进行一些没啥用的处理，然后显示出来。<br>左侧资源里有dat_secret，点进去有地址，光标悬停就会显示dat_secret的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">s=&#x27;A1B5448414E4A1B5D470B491B470D491E4C496F45484B5C440647470A46444&#x27;</span><br><span class="line">data=[]</span><br><span class="line">text=&#x27;&#x27;</span><br><span class="line">for i in range(0,len(s),2):</span><br><span class="line">    data.append(int(s[i:i+2],16))</span><br><span class="line">for i in data:</span><br><span class="line">    text+=chr((i&gt;&gt;4|(i&lt;&lt;4&amp;240))^41)</span><br><span class="line">print(text)</span><br></pre></td></tr></table></figure>

<h2 id="equation"><a href="#equation" class="headerlink" title="equation"></a>equation</h2><p>emmm js混淆，嫖段代码解码一下brainfuck混淆</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">s=<span class="string">&quot;……&quot;</span></span><br><span class="line">#s里写入网站源代码<span class="title class_">Sources</span>里面<span class="keyword">if</span>里的一长串，太长就不贴了……</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;s.<span class="property">length</span>;i++)&#123;</span><br><span class="line">	num_z = <span class="number">1</span></span><br><span class="line">	num_f = <span class="number">0</span></span><br><span class="line">	<span class="keyword">if</span>(s[i] == <span class="string">&#x27;l&#x27;</span>)&#123;</span><br><span class="line">		<span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;l[&quot;</span>)</span><br><span class="line">		i += <span class="number">2</span></span><br><span class="line">		a = <span class="string">&quot;&quot;</span></span><br><span class="line">		<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(s[i] == <span class="string">&#x27;[&#x27;</span>)&#123;num_z += <span class="number">1</span>&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(s[i] == <span class="string">&#x27;]&#x27;</span>)&#123;num_f += <span class="number">1</span>&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(num_f == num_z)&#123;num_z = <span class="number">1</span>;num_f = <span class="number">0</span>;<span class="keyword">break</span>&#125;</span><br><span class="line">			</span><br><span class="line">			a = a + s[i]</span><br><span class="line">			i += <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="built_in">eval</span>(a))</span><br><span class="line">		<span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;]&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(s[i] == <span class="string">&#x27;=&#x27;</span>)&#123;</span><br><span class="line">		<span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot; == &quot;</span>)</span><br><span class="line">		i += <span class="number">2</span></span><br><span class="line">		b = <span class="string">&quot;&quot;</span></span><br><span class="line">		<span class="keyword">while</span>(s[i] != <span class="string">&#x27;&amp;&#x27;</span> &amp;&amp; s[i])&#123;</span><br><span class="line">			b += s[i]</span><br><span class="line">			i++</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="built_in">eval</span>(b))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[i] == <span class="string">&#x27;&amp;&#x27;</span>)&#123;</span><br><span class="line">			<span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;br/&gt;&#x27;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable language_">document</span>.<span class="title function_">write</span>(s[i])</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>随便扔到一个网站打开跑一下，获得方程组，然后z3解密。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">l=[Int(<span class="string">&quot;l[%d]&quot;</span>%i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x2a</span>)]</span><br><span class="line"></span><br><span class="line">s=Solver()</span><br><span class="line">s.add(l[<span class="number">40</span>]+l[<span class="number">35</span>]+l[<span class="number">34</span>]-l[<span class="number">0</span>]-l[<span class="number">15</span>]-l[<span class="number">37</span>]+l[<span class="number">7</span>]+l[<span class="number">6</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]+l[<span class="number">19</span>]+l[<span class="number">8</span>]-l[<span class="number">17</span>]-l[<span class="number">14</span>]-l[<span class="number">38</span>]+l[<span class="number">1</span>]-l[<span class="number">9</span>]+l[<span class="number">22</span>]+l[<span class="number">41</span>]+l[<span class="number">3</span>]-l[<span class="number">29</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]+l[<span class="number">5</span>]+l[<span class="number">32</span>]-l[<span class="number">16</span>]+l[<span class="number">12</span>]-l[<span class="number">24</span>]+l[<span class="number">30</span>]+l[<span class="number">39</span>]+l[<span class="number">10</span>]+l[<span class="number">2</span>]+l[<span class="number">27</span>]+l[<span class="number">28</span>]+l[<span class="number">21</span>]+l[<span class="number">33</span>]-l[<span class="number">18</span>]+l[<span class="number">4</span>] == <span class="number">861</span>)</span><br><span class="line">s.add(l[<span class="number">31</span>]+l[<span class="number">26</span>]+l[<span class="number">11</span>]-l[<span class="number">33</span>]+l[<span class="number">27</span>]-l[<span class="number">3</span>]+l[<span class="number">12</span>]+l[<span class="number">30</span>]+l[<span class="number">1</span>]+l[<span class="number">32</span>]-l[<span class="number">16</span>]+l[<span class="number">7</span>]+l[<span class="number">10</span>]-l[<span class="number">25</span>]+l[<span class="number">38</span>]-l[<span class="number">41</span>]-l[<span class="number">14</span>]-l[<span class="number">19</span>]+l[<span class="number">29</span>]+l[<span class="number">36</span>]-l[<span class="number">9</span>]-l[<span class="number">28</span>]-l[<span class="number">6</span>]-l[<span class="number">0</span>]-l[<span class="number">22</span>]-l[<span class="number">18</span>]+l[<span class="number">20</span>]-l[<span class="number">37</span>]+l[<span class="number">4</span>]-l[<span class="number">24</span>]+l[<span class="number">34</span>]-l[<span class="number">21</span>]-l[<span class="number">39</span>]-l[<span class="number">23</span>]-l[<span class="number">8</span>]-l[<span class="number">40</span>]+l[<span class="number">15</span>]-l[<span class="number">35</span>] == -<span class="number">448</span>)</span><br><span class="line">s.add(l[<span class="number">26</span>]+l[<span class="number">14</span>]+l[<span class="number">15</span>]+l[<span class="number">9</span>]+l[<span class="number">13</span>]+l[<span class="number">30</span>]-l[<span class="number">11</span>]+l[<span class="number">18</span>]+l[<span class="number">23</span>]+l[<span class="number">7</span>]+l[<span class="number">3</span>]+l[<span class="number">12</span>]+l[<span class="number">25</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]-l[<span class="number">35</span>]-l[<span class="number">20</span>]+l[<span class="number">40</span>]-l[<span class="number">8</span>]+l[<span class="number">10</span>]-l[<span class="number">5</span>]-l[<span class="number">33</span>]-l[<span class="number">31</span>]+l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">21</span>]-l[<span class="number">6</span>]+l[<span class="number">1</span>]+l[<span class="number">16</span>]+l[<span class="number">17</span>]+l[<span class="number">29</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">36</span>]+l[<span class="number">41</span>]+l[<span class="number">38</span>]+l[<span class="number">2</span>]+l[<span class="number">0</span>] == <span class="number">1244</span>)</span><br><span class="line">s.add(l[<span class="number">5</span>]+l[<span class="number">22</span>]+l[<span class="number">15</span>]+l[<span class="number">2</span>]-l[<span class="number">28</span>]-l[<span class="number">10</span>]-l[<span class="number">3</span>]-l[<span class="number">13</span>]-l[<span class="number">18</span>]+l[<span class="number">30</span>]-l[<span class="number">9</span>]+l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">34</span>]+l[<span class="number">23</span>]-l[<span class="number">17</span>]+l[<span class="number">16</span>]-l[<span class="number">7</span>]+l[<span class="number">24</span>]-l[<span class="number">39</span>]+l[<span class="number">8</span>]-l[<span class="number">12</span>]-l[<span class="number">40</span>]-l[<span class="number">25</span>]+l[<span class="number">37</span>]-l[<span class="number">35</span>]+l[<span class="number">11</span>]-l[<span class="number">14</span>]+l[<span class="number">20</span>]-l[<span class="number">27</span>]+l[<span class="number">4</span>]-l[<span class="number">33</span>]-l[<span class="number">21</span>]+l[<span class="number">31</span>]-l[<span class="number">6</span>]+l[<span class="number">1</span>]+l[<span class="number">38</span>]-l[<span class="number">29</span>] == -<span class="number">39</span>)</span><br><span class="line">s.add(l[<span class="number">41</span>]-l[<span class="number">29</span>]+l[<span class="number">23</span>]-l[<span class="number">4</span>]+l[<span class="number">20</span>]-l[<span class="number">33</span>]+l[<span class="number">35</span>]+l[<span class="number">3</span>]-l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">11</span>]+l[<span class="number">26</span>]-l[<span class="number">24</span>]-l[<span class="number">17</span>]+l[<span class="number">37</span>]+l[<span class="number">1</span>]+l[<span class="number">16</span>]-l[<span class="number">0</span>]-l[<span class="number">13</span>]+l[<span class="number">7</span>]+l[<span class="number">10</span>]+l[<span class="number">14</span>]+l[<span class="number">22</span>]+l[<span class="number">39</span>]-l[<span class="number">40</span>]+l[<span class="number">34</span>]-l[<span class="number">38</span>]+l[<span class="number">32</span>]+l[<span class="number">25</span>]-l[<span class="number">2</span>]+l[<span class="number">15</span>]+l[<span class="number">6</span>]+l[<span class="number">28</span>]-l[<span class="number">8</span>]-l[<span class="number">5</span>]-l[<span class="number">31</span>]-l[<span class="number">30</span>]-l[<span class="number">27</span>] == <span class="number">485</span>)</span><br><span class="line">s.add(l[<span class="number">13</span>]+l[<span class="number">19</span>]+l[<span class="number">21</span>]-l[<span class="number">2</span>]-l[<span class="number">33</span>]-l[<span class="number">0</span>]+l[<span class="number">39</span>]+l[<span class="number">31</span>]-l[<span class="number">23</span>]-l[<span class="number">41</span>]+l[<span class="number">38</span>]-l[<span class="number">29</span>]+l[<span class="number">36</span>]+l[<span class="number">24</span>]-l[<span class="number">20</span>]-l[<span class="number">9</span>]-l[<span class="number">32</span>]+l[<span class="number">37</span>]-l[<span class="number">35</span>]+l[<span class="number">40</span>]+l[<span class="number">7</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">10</span>]-l[<span class="number">6</span>]-l[<span class="number">16</span>]-l[<span class="number">4</span>]-l[<span class="number">5</span>]-l[<span class="number">30</span>]-l[<span class="number">14</span>]-l[<span class="number">22</span>]-l[<span class="number">25</span>]-l[<span class="number">34</span>]-l[<span class="number">17</span>]-l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">1</span>]-l[<span class="number">28</span>] == -<span class="number">1068</span>)</span><br><span class="line">s.add(l[<span class="number">32</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]+l[<span class="number">14</span>]+l[<span class="number">11</span>]+l[<span class="number">18</span>]-l[<span class="number">13</span>]+l[<span class="number">24</span>]-l[<span class="number">2</span>]-l[<span class="number">15</span>]+l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">1</span>]+l[<span class="number">39</span>]-l[<span class="number">8</span>]-l[<span class="number">3</span>]+l[<span class="number">33</span>]+l[<span class="number">6</span>]-l[<span class="number">5</span>]-l[<span class="number">35</span>]-l[<span class="number">28</span>]+l[<span class="number">25</span>]-l[<span class="number">41</span>]+l[<span class="number">22</span>]-l[<span class="number">17</span>]+l[<span class="number">10</span>]+l[<span class="number">40</span>]+l[<span class="number">34</span>]+l[<span class="number">27</span>]-l[<span class="number">20</span>]+l[<span class="number">23</span>]+l[<span class="number">31</span>]-l[<span class="number">16</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">30</span>]+l[<span class="number">29</span>]-l[<span class="number">4</span>] == <span class="number">939</span>)</span><br><span class="line">s.add(l[<span class="number">19</span>]+l[<span class="number">11</span>]+l[<span class="number">20</span>]-l[<span class="number">16</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]+l[<span class="number">1</span>]-l[<span class="number">31</span>]+l[<span class="number">28</span>]-l[<span class="number">23</span>]+l[<span class="number">14</span>]-l[<span class="number">9</span>]-l[<span class="number">27</span>]+l[<span class="number">35</span>]+l[<span class="number">39</span>]-l[<span class="number">37</span>]-l[<span class="number">8</span>]-l[<span class="number">22</span>]+l[<span class="number">5</span>]-l[<span class="number">6</span>]+l[<span class="number">0</span>]-l[<span class="number">32</span>]+l[<span class="number">24</span>]+l[<span class="number">33</span>]+l[<span class="number">29</span>]+l[<span class="number">38</span>]+l[<span class="number">15</span>]-l[<span class="number">2</span>]+l[<span class="number">30</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">3</span>]-l[<span class="number">17</span>]+l[<span class="number">34</span>]+l[<span class="number">41</span>]-l[<span class="number">4</span>]-l[<span class="number">13</span>]-l[<span class="number">26</span>] == <span class="number">413</span>)</span><br><span class="line">s.add(l[<span class="number">22</span>]+l[<span class="number">4</span>]-l[<span class="number">9</span>]+l[<span class="number">34</span>]+l[<span class="number">35</span>]+l[<span class="number">17</span>]+l[<span class="number">3</span>]-l[<span class="number">24</span>]+l[<span class="number">38</span>]-l[<span class="number">5</span>]-l[<span class="number">41</span>]-l[<span class="number">31</span>]-l[<span class="number">0</span>]-l[<span class="number">25</span>]+l[<span class="number">33</span>]+l[<span class="number">15</span>]-l[<span class="number">1</span>]-l[<span class="number">10</span>]+l[<span class="number">16</span>]-l[<span class="number">29</span>]-l[<span class="number">12</span>]+l[<span class="number">26</span>]-l[<span class="number">39</span>]-l[<span class="number">21</span>]-l[<span class="number">18</span>]-l[<span class="number">6</span>]-l[<span class="number">40</span>]-l[<span class="number">13</span>]+l[<span class="number">8</span>]+l[<span class="number">37</span>]+l[<span class="number">19</span>]+l[<span class="number">14</span>]+l[<span class="number">32</span>]+l[<span class="number">28</span>]-l[<span class="number">11</span>]+l[<span class="number">23</span>]+l[<span class="number">36</span>]+l[<span class="number">7</span>] == <span class="number">117</span>)</span><br><span class="line">s.add(l[<span class="number">32</span>]+l[<span class="number">16</span>]+l[<span class="number">3</span>]+l[<span class="number">11</span>]+l[<span class="number">34</span>]-l[<span class="number">31</span>]+l[<span class="number">14</span>]+l[<span class="number">25</span>]+l[<span class="number">1</span>]-l[<span class="number">30</span>]-l[<span class="number">33</span>]-l[<span class="number">40</span>]-l[<span class="number">4</span>]-l[<span class="number">29</span>]+l[<span class="number">18</span>]-l[<span class="number">27</span>]+l[<span class="number">13</span>]-l[<span class="number">19</span>]-l[<span class="number">12</span>]+l[<span class="number">23</span>]-l[<span class="number">39</span>]-l[<span class="number">41</span>]-l[<span class="number">8</span>]+l[<span class="number">22</span>]-l[<span class="number">5</span>]-l[<span class="number">38</span>]-l[<span class="number">9</span>]-l[<span class="number">37</span>]+l[<span class="number">17</span>]-l[<span class="number">36</span>]+l[<span class="number">24</span>]-l[<span class="number">21</span>]+l[<span class="number">2</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]-l[<span class="number">7</span>]+l[<span class="number">35</span>]-l[<span class="number">0</span>] == -<span class="number">313</span>)</span><br><span class="line">s.add(l[<span class="number">40</span>]-l[<span class="number">1</span>]+l[<span class="number">5</span>]+l[<span class="number">7</span>]+l[<span class="number">33</span>]+l[<span class="number">29</span>]+l[<span class="number">12</span>]+l[<span class="number">38</span>]-l[<span class="number">31</span>]+l[<span class="number">2</span>]+l[<span class="number">14</span>]-l[<span class="number">35</span>]-l[<span class="number">8</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]-l[<span class="number">9</span>]-l[<span class="number">28</span>]+l[<span class="number">23</span>]-l[<span class="number">17</span>]-l[<span class="number">22</span>]-l[<span class="number">26</span>]+l[<span class="number">32</span>]-l[<span class="number">11</span>]+l[<span class="number">4</span>]-l[<span class="number">36</span>]+l[<span class="number">10</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]-l[<span class="number">16</span>]+l[<span class="number">6</span>]-l[<span class="number">0</span>]+l[<span class="number">3</span>]-l[<span class="number">30</span>]+l[<span class="number">37</span>]-l[<span class="number">19</span>]+l[<span class="number">21</span>]+l[<span class="number">25</span>]-l[<span class="number">15</span>] == -<span class="number">42</span>)</span><br><span class="line">s.add(l[<span class="number">21</span>]+l[<span class="number">26</span>]-l[<span class="number">17</span>]-l[<span class="number">25</span>]+l[<span class="number">27</span>]-l[<span class="number">22</span>]-l[<span class="number">39</span>]-l[<span class="number">23</span>]-l[<span class="number">15</span>]-l[<span class="number">20</span>]-l[<span class="number">32</span>]+l[<span class="number">12</span>]+l[<span class="number">3</span>]-l[<span class="number">6</span>]+l[<span class="number">28</span>]+l[<span class="number">31</span>]+l[<span class="number">13</span>]-l[<span class="number">16</span>]-l[<span class="number">37</span>]-l[<span class="number">30</span>]-l[<span class="number">5</span>]+l[<span class="number">41</span>]+l[<span class="number">29</span>]+l[<span class="number">36</span>]+l[<span class="number">1</span>]+l[<span class="number">11</span>]+l[<span class="number">24</span>]+l[<span class="number">18</span>]-l[<span class="number">40</span>]+l[<span class="number">19</span>]-l[<span class="number">35</span>]+l[<span class="number">2</span>]-l[<span class="number">38</span>]+l[<span class="number">14</span>]-l[<span class="number">9</span>]+l[<span class="number">4</span>]+l[<span class="number">0</span>]-l[<span class="number">33</span>] == <span class="number">289</span>)</span><br><span class="line">s.add(l[<span class="number">29</span>]+l[<span class="number">31</span>]+l[<span class="number">32</span>]-l[<span class="number">17</span>]-l[<span class="number">7</span>]+l[<span class="number">34</span>]+l[<span class="number">2</span>]+l[<span class="number">14</span>]+l[<span class="number">23</span>]-l[<span class="number">4</span>]+l[<span class="number">3</span>]+l[<span class="number">35</span>]-l[<span class="number">33</span>]-l[<span class="number">9</span>]-l[<span class="number">20</span>]-l[<span class="number">37</span>]+l[<span class="number">24</span>]-l[<span class="number">27</span>]+l[<span class="number">36</span>]+l[<span class="number">15</span>]-l[<span class="number">18</span>]-l[<span class="number">0</span>]+l[<span class="number">12</span>]+l[<span class="number">11</span>]-l[<span class="number">38</span>]+l[<span class="number">6</span>]+l[<span class="number">22</span>]+l[<span class="number">39</span>]-l[<span class="number">25</span>]-l[<span class="number">10</span>]-l[<span class="number">19</span>]-l[<span class="number">1</span>]+l[<span class="number">13</span>]-l[<span class="number">41</span>]+l[<span class="number">30</span>]-l[<span class="number">16</span>]+l[<span class="number">28</span>]-l[<span class="number">26</span>] == -<span class="number">117</span>)</span><br><span class="line">s.add(l[<span class="number">5</span>]+l[<span class="number">37</span>]-l[<span class="number">39</span>]+l[<span class="number">0</span>]-l[<span class="number">27</span>]+l[<span class="number">12</span>]+l[<span class="number">41</span>]-l[<span class="number">22</span>]+l[<span class="number">8</span>]-l[<span class="number">16</span>]-l[<span class="number">38</span>]+l[<span class="number">9</span>]+l[<span class="number">15</span>]-l[<span class="number">35</span>]-l[<span class="number">29</span>]+l[<span class="number">18</span>]+l[<span class="number">6</span>]-l[<span class="number">25</span>]-l[<span class="number">28</span>]+l[<span class="number">36</span>]+l[<span class="number">34</span>]+l[<span class="number">32</span>]-l[<span class="number">14</span>]-l[<span class="number">1</span>]+l[<span class="number">20</span>]+l[<span class="number">40</span>]-l[<span class="number">19</span>]-l[<span class="number">4</span>]-l[<span class="number">7</span>]+l[<span class="number">26</span>]+l[<span class="number">30</span>]-l[<span class="number">10</span>]+l[<span class="number">13</span>]-l[<span class="number">21</span>]+l[<span class="number">2</span>]-l[<span class="number">23</span>]-l[<span class="number">3</span>]-l[<span class="number">33</span>] == -<span class="number">252</span>)</span><br><span class="line">s.add(l[<span class="number">29</span>]+l[<span class="number">10</span>]-l[<span class="number">41</span>]-l[<span class="number">9</span>]+l[<span class="number">12</span>]-l[<span class="number">28</span>]+l[<span class="number">11</span>]+l[<span class="number">40</span>]-l[<span class="number">27</span>]-l[<span class="number">8</span>]+l[<span class="number">32</span>]-l[<span class="number">25</span>]-l[<span class="number">23</span>]+l[<span class="number">39</span>]-l[<span class="number">1</span>]-l[<span class="number">36</span>]-l[<span class="number">15</span>]+l[<span class="number">33</span>]-l[<span class="number">20</span>]+l[<span class="number">18</span>]+l[<span class="number">22</span>]-l[<span class="number">3</span>]+l[<span class="number">6</span>]-l[<span class="number">34</span>]-l[<span class="number">21</span>]+l[<span class="number">19</span>]+l[<span class="number">26</span>]+l[<span class="number">13</span>]-l[<span class="number">4</span>]+l[<span class="number">7</span>]-l[<span class="number">37</span>]+l[<span class="number">38</span>]-l[<span class="number">2</span>]-l[<span class="number">30</span>]-l[<span class="number">0</span>]-l[<span class="number">35</span>]+l[<span class="number">5</span>]+l[<span class="number">17</span>] == -<span class="number">183</span>)</span><br><span class="line">s.add(l[<span class="number">6</span>]-l[<span class="number">8</span>]-l[<span class="number">20</span>]+l[<span class="number">34</span>]-l[<span class="number">33</span>]-l[<span class="number">25</span>]-l[<span class="number">4</span>]+l[<span class="number">3</span>]+l[<span class="number">17</span>]-l[<span class="number">13</span>]-l[<span class="number">15</span>]-l[<span class="number">40</span>]+l[<span class="number">1</span>]-l[<span class="number">30</span>]-l[<span class="number">14</span>]-l[<span class="number">28</span>]-l[<span class="number">35</span>]+l[<span class="number">38</span>]-l[<span class="number">22</span>]+l[<span class="number">2</span>]+l[<span class="number">24</span>]-l[<span class="number">29</span>]+l[<span class="number">5</span>]+l[<span class="number">9</span>]+l[<span class="number">37</span>]+l[<span class="number">23</span>]-l[<span class="number">18</span>]+l[<span class="number">19</span>]-l[<span class="number">21</span>]+l[<span class="number">11</span>]+l[<span class="number">36</span>]+l[<span class="number">41</span>]-l[<span class="number">7</span>]-l[<span class="number">32</span>]+l[<span class="number">10</span>]+l[<span class="number">26</span>]-l[<span class="number">0</span>]+l[<span class="number">31</span>] == <span class="number">188</span>)</span><br><span class="line">s.add(l[<span class="number">3</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]+l[<span class="number">10</span>]+l[<span class="number">39</span>]+l[<span class="number">37</span>]+l[<span class="number">1</span>]+l[<span class="number">8</span>]+l[<span class="number">21</span>]+l[<span class="number">24</span>]+l[<span class="number">29</span>]+l[<span class="number">12</span>]+l[<span class="number">27</span>]-l[<span class="number">38</span>]+l[<span class="number">11</span>]+l[<span class="number">23</span>]+l[<span class="number">28</span>]+l[<span class="number">33</span>]-l[<span class="number">31</span>]+l[<span class="number">14</span>]-l[<span class="number">5</span>]+l[<span class="number">32</span>]-l[<span class="number">17</span>]+l[<span class="number">40</span>]-l[<span class="number">34</span>]+l[<span class="number">20</span>]-l[<span class="number">22</span>]-l[<span class="number">16</span>]+l[<span class="number">19</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]-l[<span class="number">7</span>]+l[<span class="number">18</span>]+l[<span class="number">15</span>]+l[<span class="number">26</span>]-l[<span class="number">0</span>]-l[<span class="number">4</span>]+l[<span class="number">35</span>] == <span class="number">1036</span>)</span><br><span class="line">s.add(l[<span class="number">28</span>]-l[<span class="number">33</span>]+l[<span class="number">2</span>]+l[<span class="number">37</span>]-l[<span class="number">12</span>]-l[<span class="number">9</span>]-l[<span class="number">39</span>]+l[<span class="number">16</span>]-l[<span class="number">32</span>]+l[<span class="number">8</span>]-l[<span class="number">36</span>]+l[<span class="number">31</span>]+l[<span class="number">10</span>]-l[<span class="number">4</span>]+l[<span class="number">21</span>]-l[<span class="number">25</span>]+l[<span class="number">18</span>]+l[<span class="number">24</span>]-l[<span class="number">0</span>]+l[<span class="number">29</span>]-l[<span class="number">26</span>]+l[<span class="number">35</span>]-l[<span class="number">22</span>]-l[<span class="number">41</span>]-l[<span class="number">6</span>]+l[<span class="number">15</span>]+l[<span class="number">19</span>]+l[<span class="number">40</span>]+l[<span class="number">7</span>]+l[<span class="number">34</span>]+l[<span class="number">17</span>]-l[<span class="number">3</span>]-l[<span class="number">13</span>]+l[<span class="number">5</span>]+l[<span class="number">23</span>]+l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">1</span>] == <span class="number">328</span>)</span><br><span class="line">s.add(l[<span class="number">22</span>]-l[<span class="number">32</span>]+l[<span class="number">17</span>]-l[<span class="number">9</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>]-l[<span class="number">34</span>]+l[<span class="number">23</span>]+l[<span class="number">36</span>]-l[<span class="number">35</span>]-l[<span class="number">38</span>]+l[<span class="number">27</span>]+l[<span class="number">4</span>]-l[<span class="number">5</span>]-l[<span class="number">41</span>]+l[<span class="number">29</span>]+l[<span class="number">33</span>]+l[<span class="number">0</span>]-l[<span class="number">37</span>]+l[<span class="number">28</span>]-l[<span class="number">40</span>]-l[<span class="number">11</span>]-l[<span class="number">12</span>]+l[<span class="number">7</span>]+l[<span class="number">1</span>]+l[<span class="number">2</span>]-l[<span class="number">26</span>]-l[<span class="number">16</span>]-l[<span class="number">8</span>]+l[<span class="number">24</span>]-l[<span class="number">25</span>]+l[<span class="number">3</span>]-l[<span class="number">6</span>]-l[<span class="number">19</span>]-l[<span class="number">39</span>]-l[<span class="number">14</span>]-l[<span class="number">31</span>]+l[<span class="number">10</span>] == -<span class="number">196</span>)</span><br><span class="line">s.add(l[<span class="number">11</span>]+l[<span class="number">13</span>]+l[<span class="number">14</span>]-l[<span class="number">15</span>]-l[<span class="number">29</span>]-l[<span class="number">2</span>]+l[<span class="number">7</span>]+l[<span class="number">20</span>]+l[<span class="number">30</span>]-l[<span class="number">36</span>]-l[<span class="number">33</span>]-l[<span class="number">19</span>]+l[<span class="number">31</span>]+l[<span class="number">0</span>]-l[<span class="number">39</span>]-l[<span class="number">4</span>]-l[<span class="number">6</span>]+l[<span class="number">38</span>]+l[<span class="number">35</span>]-l[<span class="number">28</span>]+l[<span class="number">34</span>]-l[<span class="number">9</span>]-l[<span class="number">23</span>]-l[<span class="number">26</span>]+l[<span class="number">37</span>]-l[<span class="number">8</span>]-l[<span class="number">27</span>]+l[<span class="number">5</span>]-l[<span class="number">41</span>]+l[<span class="number">3</span>]+l[<span class="number">17</span>]+l[<span class="number">40</span>]-l[<span class="number">10</span>]+l[<span class="number">25</span>]+l[<span class="number">12</span>]-l[<span class="number">24</span>]+l[<span class="number">18</span>]+l[<span class="number">32</span>] == <span class="number">7</span>)</span><br><span class="line">s.add(l[<span class="number">34</span>]-l[<span class="number">37</span>]-l[<span class="number">40</span>]+l[<span class="number">4</span>]-l[<span class="number">22</span>]-l[<span class="number">31</span>]-l[<span class="number">6</span>]+l[<span class="number">38</span>]+l[<span class="number">13</span>]-l[<span class="number">28</span>]+l[<span class="number">8</span>]+l[<span class="number">30</span>]-l[<span class="number">20</span>]-l[<span class="number">7</span>]-l[<span class="number">32</span>]+l[<span class="number">26</span>]+l[<span class="number">1</span>]-l[<span class="number">18</span>]+l[<span class="number">5</span>]+l[<span class="number">35</span>]-l[<span class="number">24</span>]-l[<span class="number">41</span>]+l[<span class="number">9</span>]-l[<span class="number">0</span>]-l[<span class="number">2</span>]-l[<span class="number">15</span>]-l[<span class="number">10</span>]+l[<span class="number">12</span>]-l[<span class="number">36</span>]+l[<span class="number">33</span>]-l[<span class="number">16</span>]-l[<span class="number">14</span>]-l[<span class="number">25</span>]-l[<span class="number">29</span>]-l[<span class="number">21</span>]+l[<span class="number">27</span>]+l[<span class="number">3</span>]-l[<span class="number">17</span>] == -<span class="number">945</span>)</span><br><span class="line">s.add(l[<span class="number">12</span>]-l[<span class="number">30</span>]-l[<span class="number">8</span>]+l[<span class="number">20</span>]-l[<span class="number">2</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]-l[<span class="number">0</span>]-l[<span class="number">19</span>]-l[<span class="number">28</span>]-l[<span class="number">7</span>]-l[<span class="number">11</span>]-l[<span class="number">33</span>]+l[<span class="number">4</span>]-l[<span class="number">23</span>]+l[<span class="number">10</span>]-l[<span class="number">41</span>]+l[<span class="number">39</span>]-l[<span class="number">32</span>]+l[<span class="number">27</span>]+l[<span class="number">18</span>]+l[<span class="number">15</span>]+l[<span class="number">34</span>]+l[<span class="number">13</span>]-l[<span class="number">40</span>]+l[<span class="number">29</span>]-l[<span class="number">6</span>]+l[<span class="number">37</span>]-l[<span class="number">14</span>]-l[<span class="number">16</span>]+l[<span class="number">38</span>]-l[<span class="number">26</span>]+l[<span class="number">17</span>]+l[<span class="number">31</span>]-l[<span class="number">22</span>]-l[<span class="number">35</span>]+l[<span class="number">5</span>]-l[<span class="number">1</span>] == -<span class="number">480</span>)</span><br><span class="line">s.add(l[<span class="number">36</span>]-l[<span class="number">11</span>]-l[<span class="number">34</span>]+l[<span class="number">8</span>]+l[<span class="number">0</span>]+l[<span class="number">15</span>]+l[<span class="number">28</span>]-l[<span class="number">39</span>]-l[<span class="number">32</span>]-l[<span class="number">2</span>]-l[<span class="number">27</span>]+l[<span class="number">22</span>]+l[<span class="number">16</span>]-l[<span class="number">30</span>]-l[<span class="number">3</span>]+l[<span class="number">31</span>]-l[<span class="number">26</span>]+l[<span class="number">20</span>]+l[<span class="number">17</span>]-l[<span class="number">29</span>]-l[<span class="number">18</span>]+l[<span class="number">19</span>]-l[<span class="number">10</span>]+l[<span class="number">6</span>]-l[<span class="number">5</span>]-l[<span class="number">38</span>]-l[<span class="number">25</span>]-l[<span class="number">24</span>]+l[<span class="number">4</span>]+l[<span class="number">23</span>]+l[<span class="number">9</span>]+l[<span class="number">14</span>]+l[<span class="number">21</span>]-l[<span class="number">37</span>]+l[<span class="number">13</span>]-l[<span class="number">41</span>]-l[<span class="number">12</span>]+l[<span class="number">35</span>] == -<span class="number">213</span>)</span><br><span class="line">s.add(l[<span class="number">19</span>]-l[<span class="number">36</span>]-l[<span class="number">12</span>]+l[<span class="number">33</span>]-l[<span class="number">27</span>]-l[<span class="number">37</span>]-l[<span class="number">25</span>]+l[<span class="number">38</span>]+l[<span class="number">16</span>]-l[<span class="number">18</span>]+l[<span class="number">22</span>]-l[<span class="number">39</span>]+l[<span class="number">13</span>]-l[<span class="number">7</span>]-l[<span class="number">31</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">10</span>]-l[<span class="number">9</span>]-l[<span class="number">2</span>]-l[<span class="number">30</span>]-l[<span class="number">11</span>]+l[<span class="number">41</span>]-l[<span class="number">4</span>]+l[<span class="number">24</span>]+l[<span class="number">34</span>]+l[<span class="number">5</span>]+l[<span class="number">17</span>]+l[<span class="number">14</span>]+l[<span class="number">6</span>]+l[<span class="number">8</span>]-l[<span class="number">21</span>]-l[<span class="number">23</span>]+l[<span class="number">32</span>]-l[<span class="number">1</span>]-l[<span class="number">29</span>]-l[<span class="number">0</span>]+l[<span class="number">3</span>] == -<span class="number">386</span>)</span><br><span class="line">s.add(l[<span class="number">0</span>]+l[<span class="number">7</span>]-l[<span class="number">28</span>]-l[<span class="number">38</span>]+l[<span class="number">19</span>]+l[<span class="number">31</span>]-l[<span class="number">5</span>]+l[<span class="number">24</span>]-l[<span class="number">3</span>]+l[<span class="number">33</span>]-l[<span class="number">12</span>]-l[<span class="number">29</span>]+l[<span class="number">32</span>]+l[<span class="number">1</span>]-l[<span class="number">34</span>]-l[<span class="number">9</span>]-l[<span class="number">25</span>]+l[<span class="number">26</span>]-l[<span class="number">8</span>]+l[<span class="number">4</span>]-l[<span class="number">10</span>]+l[<span class="number">40</span>]-l[<span class="number">15</span>]-l[<span class="number">11</span>]-l[<span class="number">27</span>]+l[<span class="number">36</span>]+l[<span class="number">14</span>]+l[<span class="number">41</span>]-l[<span class="number">35</span>]-l[<span class="number">13</span>]-l[<span class="number">17</span>]-l[<span class="number">21</span>]-l[<span class="number">18</span>]+l[<span class="number">39</span>]-l[<span class="number">2</span>]+l[<span class="number">20</span>]-l[<span class="number">23</span>]-l[<span class="number">22</span>] == -<span class="number">349</span>)</span><br><span class="line">s.add(l[<span class="number">10</span>]+l[<span class="number">22</span>]+l[<span class="number">21</span>]-l[<span class="number">0</span>]+l[<span class="number">15</span>]-l[<span class="number">6</span>]+l[<span class="number">20</span>]-l[<span class="number">29</span>]-l[<span class="number">30</span>]-l[<span class="number">33</span>]+l[<span class="number">19</span>]+l[<span class="number">23</span>]-l[<span class="number">28</span>]+l[<span class="number">41</span>]-l[<span class="number">27</span>]-l[<span class="number">12</span>]-l[<span class="number">37</span>]-l[<span class="number">32</span>]+l[<span class="number">34</span>]-l[<span class="number">36</span>]+l[<span class="number">3</span>]+l[<span class="number">1</span>]-l[<span class="number">13</span>]+l[<span class="number">18</span>]+l[<span class="number">14</span>]+l[<span class="number">9</span>]+l[<span class="number">7</span>]-l[<span class="number">39</span>]+l[<span class="number">8</span>]+l[<span class="number">2</span>]-l[<span class="number">31</span>]-l[<span class="number">5</span>]-l[<span class="number">40</span>]+l[<span class="number">38</span>]-l[<span class="number">26</span>]-l[<span class="number">4</span>]+l[<span class="number">16</span>]-l[<span class="number">25</span>] == <span class="number">98</span>)</span><br><span class="line">s.add(l[<span class="number">28</span>]+l[<span class="number">38</span>]+l[<span class="number">20</span>]+l[<span class="number">0</span>]-l[<span class="number">5</span>]-l[<span class="number">34</span>]-l[<span class="number">41</span>]+l[<span class="number">22</span>]-l[<span class="number">26</span>]+l[<span class="number">11</span>]+l[<span class="number">29</span>]+l[<span class="number">31</span>]-l[<span class="number">3</span>]-l[<span class="number">16</span>]+l[<span class="number">23</span>]+l[<span class="number">17</span>]-l[<span class="number">18</span>]+l[<span class="number">9</span>]-l[<span class="number">4</span>]-l[<span class="number">12</span>]-l[<span class="number">19</span>]-l[<span class="number">40</span>]-l[<span class="number">27</span>]+l[<span class="number">33</span>]+l[<span class="number">8</span>]-l[<span class="number">37</span>]+l[<span class="number">2</span>]+l[<span class="number">15</span>]-l[<span class="number">24</span>]-l[<span class="number">39</span>]+l[<span class="number">10</span>]+l[<span class="number">35</span>]-l[<span class="number">1</span>]+l[<span class="number">30</span>]-l[<span class="number">36</span>]-l[<span class="number">25</span>]-l[<span class="number">14</span>]-l[<span class="number">32</span>] == -<span class="number">412</span>)</span><br><span class="line">s.add(l[<span class="number">1</span>]-l[<span class="number">24</span>]-l[<span class="number">29</span>]+l[<span class="number">39</span>]+l[<span class="number">41</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]-l[<span class="number">19</span>]+l[<span class="number">6</span>]-l[<span class="number">37</span>]-l[<span class="number">22</span>]+l[<span class="number">32</span>]+l[<span class="number">21</span>]+l[<span class="number">28</span>]+l[<span class="number">36</span>]+l[<span class="number">4</span>]-l[<span class="number">17</span>]+l[<span class="number">20</span>]-l[<span class="number">13</span>]-l[<span class="number">35</span>]-l[<span class="number">5</span>]+l[<span class="number">33</span>]-l[<span class="number">27</span>]-l[<span class="number">30</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]-l[<span class="number">18</span>]+l[<span class="number">34</span>]-l[<span class="number">3</span>]-l[<span class="number">10</span>]-l[<span class="number">16</span>]-l[<span class="number">23</span>]-l[<span class="number">38</span>]+l[<span class="number">8</span>]-l[<span class="number">14</span>]-l[<span class="number">11</span>]-l[<span class="number">7</span>]+l[<span class="number">12</span>] == -<span class="number">95</span>)</span><br><span class="line">s.add(l[<span class="number">2</span>]-l[<span class="number">24</span>]+l[<span class="number">31</span>]+l[<span class="number">0</span>]+l[<span class="number">9</span>]-l[<span class="number">6</span>]+l[<span class="number">7</span>]-l[<span class="number">1</span>]-l[<span class="number">22</span>]+l[<span class="number">8</span>]-l[<span class="number">23</span>]+l[<span class="number">40</span>]+l[<span class="number">20</span>]-l[<span class="number">38</span>]-l[<span class="number">11</span>]-l[<span class="number">14</span>]+l[<span class="number">18</span>]-l[<span class="number">36</span>]+l[<span class="number">15</span>]-l[<span class="number">4</span>]-l[<span class="number">41</span>]-l[<span class="number">12</span>]-l[<span class="number">34</span>]+l[<span class="number">32</span>]-l[<span class="number">35</span>]+l[<span class="number">17</span>]-l[<span class="number">21</span>]-l[<span class="number">10</span>]-l[<span class="number">29</span>]+l[<span class="number">39</span>]-l[<span class="number">16</span>]+l[<span class="number">27</span>]+l[<span class="number">26</span>]-l[<span class="number">3</span>]-l[<span class="number">5</span>]+l[<span class="number">13</span>]+l[<span class="number">25</span>]-l[<span class="number">28</span>] == -<span class="number">379</span>)</span><br><span class="line">s.add(l[<span class="number">19</span>]-l[<span class="number">17</span>]+l[<span class="number">31</span>]+l[<span class="number">14</span>]+l[<span class="number">6</span>]-l[<span class="number">12</span>]+l[<span class="number">16</span>]-l[<span class="number">8</span>]+l[<span class="number">27</span>]-l[<span class="number">13</span>]+l[<span class="number">41</span>]+l[<span class="number">2</span>]-l[<span class="number">7</span>]+l[<span class="number">32</span>]+l[<span class="number">1</span>]+l[<span class="number">25</span>]-l[<span class="number">9</span>]+l[<span class="number">37</span>]+l[<span class="number">34</span>]-l[<span class="number">18</span>]-l[<span class="number">40</span>]-l[<span class="number">11</span>]-l[<span class="number">10</span>]+l[<span class="number">38</span>]+l[<span class="number">21</span>]+l[<span class="number">3</span>]-l[<span class="number">0</span>]+l[<span class="number">24</span>]+l[<span class="number">15</span>]+l[<span class="number">23</span>]-l[<span class="number">20</span>]+l[<span class="number">26</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">28</span>]-l[<span class="number">5</span>]+l[<span class="number">39</span>]+l[<span class="number">35</span>] == <span class="number">861</span>)</span><br><span class="line">s.add(l[<span class="number">35</span>]+l[<span class="number">36</span>]-l[<span class="number">16</span>]-l[<span class="number">26</span>]-l[<span class="number">31</span>]+l[<span class="number">0</span>]+l[<span class="number">21</span>]-l[<span class="number">13</span>]+l[<span class="number">14</span>]+l[<span class="number">39</span>]+l[<span class="number">7</span>]+l[<span class="number">4</span>]+l[<span class="number">34</span>]+l[<span class="number">38</span>]+l[<span class="number">17</span>]+l[<span class="number">22</span>]+l[<span class="number">32</span>]+l[<span class="number">5</span>]+l[<span class="number">15</span>]+l[<span class="number">8</span>]-l[<span class="number">29</span>]+l[<span class="number">40</span>]+l[<span class="number">24</span>]+l[<span class="number">6</span>]+l[<span class="number">30</span>]-l[<span class="number">2</span>]+l[<span class="number">25</span>]+l[<span class="number">23</span>]+l[<span class="number">1</span>]+l[<span class="number">12</span>]+l[<span class="number">9</span>]-l[<span class="number">10</span>]-l[<span class="number">3</span>]-l[<span class="number">19</span>]+l[<span class="number">20</span>]-l[<span class="number">37</span>]-l[<span class="number">33</span>]-l[<span class="number">18</span>] == <span class="number">1169</span>)</span><br><span class="line">s.add(l[<span class="number">13</span>]+l[<span class="number">0</span>]-l[<span class="number">25</span>]-l[<span class="number">32</span>]-l[<span class="number">21</span>]-l[<span class="number">34</span>]-l[<span class="number">14</span>]-l[<span class="number">9</span>]-l[<span class="number">8</span>]-l[<span class="number">15</span>]-l[<span class="number">16</span>]+l[<span class="number">38</span>]-l[<span class="number">35</span>]-l[<span class="number">30</span>]-l[<span class="number">40</span>]-l[<span class="number">12</span>]+l[<span class="number">3</span>]-l[<span class="number">19</span>]+l[<span class="number">4</span>]-l[<span class="number">41</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]+l[<span class="number">37</span>]+l[<span class="number">17</span>]-l[<span class="number">1</span>]+l[<span class="number">26</span>]-l[<span class="number">39</span>]-l[<span class="number">10</span>]-l[<span class="number">33</span>]+l[<span class="number">5</span>]-l[<span class="number">27</span>]-l[<span class="number">23</span>]-l[<span class="number">24</span>]-l[<span class="number">7</span>]+l[<span class="number">31</span>]-l[<span class="number">28</span>]-l[<span class="number">18</span>]+l[<span class="number">6</span>] == -<span class="number">1236</span>)</span><br><span class="line">s.add(l[<span class="number">20</span>]+l[<span class="number">27</span>]-l[<span class="number">29</span>]-l[<span class="number">25</span>]-l[<span class="number">3</span>]+l[<span class="number">28</span>]-l[<span class="number">32</span>]-l[<span class="number">11</span>]+l[<span class="number">10</span>]+l[<span class="number">31</span>]+l[<span class="number">16</span>]+l[<span class="number">21</span>]-l[<span class="number">7</span>]+l[<span class="number">4</span>]-l[<span class="number">24</span>]-l[<span class="number">35</span>]+l[<span class="number">26</span>]+l[<span class="number">12</span>]-l[<span class="number">37</span>]+l[<span class="number">6</span>]+l[<span class="number">23</span>]+l[<span class="number">41</span>]-l[<span class="number">39</span>]-l[<span class="number">38</span>]+l[<span class="number">40</span>]-l[<span class="number">36</span>]+l[<span class="number">8</span>]-l[<span class="number">9</span>]-l[<span class="number">5</span>]-l[<span class="number">1</span>]-l[<span class="number">13</span>]-l[<span class="number">14</span>]+l[<span class="number">19</span>]+l[<span class="number">0</span>]-l[<span class="number">34</span>]-l[<span class="number">15</span>]+l[<span class="number">17</span>]+l[<span class="number">22</span>] == -<span class="number">114</span>)</span><br><span class="line">s.add(l[<span class="number">12</span>]-l[<span class="number">28</span>]-l[<span class="number">13</span>]-l[<span class="number">23</span>]-l[<span class="number">33</span>]+l[<span class="number">18</span>]+l[<span class="number">10</span>]+l[<span class="number">11</span>]+l[<span class="number">2</span>]-l[<span class="number">36</span>]+l[<span class="number">41</span>]-l[<span class="number">16</span>]+l[<span class="number">39</span>]+l[<span class="number">34</span>]+l[<span class="number">32</span>]+l[<span class="number">37</span>]-l[<span class="number">38</span>]+l[<span class="number">20</span>]+l[<span class="number">6</span>]+l[<span class="number">7</span>]+l[<span class="number">31</span>]+l[<span class="number">5</span>]+l[<span class="number">22</span>]-l[<span class="number">4</span>]-l[<span class="number">15</span>]-l[<span class="number">24</span>]+l[<span class="number">17</span>]-l[<span class="number">3</span>]+l[<span class="number">1</span>]-l[<span class="number">35</span>]-l[<span class="number">9</span>]+l[<span class="number">30</span>]+l[<span class="number">25</span>]-l[<span class="number">0</span>]-l[<span class="number">8</span>]-l[<span class="number">14</span>]+l[<span class="number">26</span>]+l[<span class="number">21</span>] == <span class="number">659</span>)</span><br><span class="line">s.add(l[<span class="number">21</span>]-l[<span class="number">3</span>]+l[<span class="number">7</span>]-l[<span class="number">27</span>]+l[<span class="number">0</span>]-l[<span class="number">32</span>]-l[<span class="number">24</span>]-l[<span class="number">37</span>]+l[<span class="number">4</span>]-l[<span class="number">22</span>]+l[<span class="number">20</span>]-l[<span class="number">5</span>]-l[<span class="number">30</span>]-l[<span class="number">31</span>]-l[<span class="number">1</span>]+l[<span class="number">15</span>]+l[<span class="number">41</span>]+l[<span class="number">12</span>]+l[<span class="number">40</span>]+l[<span class="number">38</span>]-l[<span class="number">17</span>]-l[<span class="number">39</span>]+l[<span class="number">19</span>]-l[<span class="number">13</span>]+l[<span class="number">23</span>]+l[<span class="number">18</span>]-l[<span class="number">2</span>]+l[<span class="number">6</span>]-l[<span class="number">33</span>]-l[<span class="number">9</span>]+l[<span class="number">28</span>]+l[<span class="number">8</span>]-l[<span class="number">16</span>]-l[<span class="number">10</span>]-l[<span class="number">14</span>]+l[<span class="number">34</span>]+l[<span class="number">35</span>]-l[<span class="number">11</span>] == -<span class="number">430</span>)</span><br><span class="line">s.add(l[<span class="number">11</span>]-l[<span class="number">23</span>]-l[<span class="number">9</span>]-l[<span class="number">19</span>]+l[<span class="number">17</span>]+l[<span class="number">38</span>]-l[<span class="number">36</span>]-l[<span class="number">22</span>]-l[<span class="number">10</span>]+l[<span class="number">27</span>]-l[<span class="number">14</span>]-l[<span class="number">4</span>]+l[<span class="number">5</span>]+l[<span class="number">31</span>]+l[<span class="number">2</span>]+l[<span class="number">0</span>]-l[<span class="number">16</span>]-l[<span class="number">8</span>]-l[<span class="number">28</span>]+l[<span class="number">3</span>]+l[<span class="number">40</span>]+l[<span class="number">25</span>]-l[<span class="number">33</span>]+l[<span class="number">13</span>]-l[<span class="number">32</span>]-l[<span class="number">35</span>]+l[<span class="number">26</span>]-l[<span class="number">20</span>]-l[<span class="number">41</span>]-l[<span class="number">30</span>]-l[<span class="number">12</span>]-l[<span class="number">7</span>]+l[<span class="number">37</span>]-l[<span class="number">39</span>]+l[<span class="number">15</span>]+l[<span class="number">18</span>]-l[<span class="number">29</span>]-l[<span class="number">21</span>] == -<span class="number">513</span>)</span><br><span class="line">s.add(l[<span class="number">32</span>]+l[<span class="number">19</span>]+l[<span class="number">4</span>]-l[<span class="number">13</span>]-l[<span class="number">17</span>]-l[<span class="number">30</span>]+l[<span class="number">5</span>]-l[<span class="number">33</span>]-l[<span class="number">37</span>]-l[<span class="number">15</span>]-l[<span class="number">18</span>]+l[<span class="number">7</span>]+l[<span class="number">25</span>]-l[<span class="number">14</span>]+l[<span class="number">35</span>]+l[<span class="number">40</span>]+l[<span class="number">16</span>]+l[<span class="number">1</span>]+l[<span class="number">2</span>]+l[<span class="number">26</span>]-l[<span class="number">3</span>]-l[<span class="number">39</span>]-l[<span class="number">22</span>]+l[<span class="number">23</span>]-l[<span class="number">36</span>]-l[<span class="number">27</span>]-l[<span class="number">9</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]-l[<span class="number">0</span>]-l[<span class="number">31</span>]-l[<span class="number">20</span>]+l[<span class="number">12</span>]-l[<span class="number">8</span>]+l[<span class="number">29</span>]-l[<span class="number">11</span>]-l[<span class="number">34</span>]+l[<span class="number">21</span>] == -<span class="number">502</span>)</span><br><span class="line">s.add(l[<span class="number">30</span>]-l[<span class="number">31</span>]-l[<span class="number">36</span>]+l[<span class="number">3</span>]+l[<span class="number">9</span>]-l[<span class="number">40</span>]-l[<span class="number">33</span>]+l[<span class="number">25</span>]+l[<span class="number">39</span>]-l[<span class="number">26</span>]+l[<span class="number">23</span>]-l[<span class="number">0</span>]-l[<span class="number">29</span>]-l[<span class="number">32</span>]-l[<span class="number">4</span>]+l[<span class="number">37</span>]+l[<span class="number">28</span>]+l[<span class="number">21</span>]+l[<span class="number">17</span>]+l[<span class="number">2</span>]+l[<span class="number">24</span>]+l[<span class="number">6</span>]+l[<span class="number">5</span>]+l[<span class="number">8</span>]+l[<span class="number">16</span>]+l[<span class="number">27</span>]+l[<span class="number">19</span>]+l[<span class="number">12</span>]+l[<span class="number">20</span>]+l[<span class="number">41</span>]-l[<span class="number">22</span>]+l[<span class="number">15</span>]-l[<span class="number">11</span>]+l[<span class="number">34</span>]-l[<span class="number">18</span>]-l[<span class="number">38</span>]+l[<span class="number">1</span>]-l[<span class="number">14</span>] == <span class="number">853</span>)</span><br><span class="line">s.add(l[<span class="number">38</span>]-l[<span class="number">10</span>]+l[<span class="number">16</span>]+l[<span class="number">8</span>]+l[<span class="number">21</span>]-l[<span class="number">25</span>]+l[<span class="number">36</span>]-l[<span class="number">30</span>]+l[<span class="number">31</span>]-l[<span class="number">3</span>]+l[<span class="number">5</span>]-l[<span class="number">15</span>]+l[<span class="number">23</span>]-l[<span class="number">28</span>]+l[<span class="number">7</span>]+l[<span class="number">12</span>]-l[<span class="number">29</span>]+l[<span class="number">22</span>]-l[<span class="number">0</span>]-l[<span class="number">37</span>]-l[<span class="number">14</span>]-l[<span class="number">11</span>]+l[<span class="number">32</span>]+l[<span class="number">33</span>]-l[<span class="number">9</span>]+l[<span class="number">39</span>]+l[<span class="number">41</span>]-l[<span class="number">19</span>]-l[<span class="number">1</span>]+l[<span class="number">18</span>]-l[<span class="number">4</span>]-l[<span class="number">6</span>]+l[<span class="number">13</span>]+l[<span class="number">20</span>]-l[<span class="number">2</span>]-l[<span class="number">35</span>]-l[<span class="number">26</span>]+l[<span class="number">27</span>] == -<span class="number">28</span>)</span><br><span class="line">s.add(l[<span class="number">11</span>]+l[<span class="number">18</span>]-l[<span class="number">26</span>]+l[<span class="number">15</span>]-l[<span class="number">14</span>]-l[<span class="number">33</span>]+l[<span class="number">7</span>]-l[<span class="number">23</span>]-l[<span class="number">25</span>]+l[<span class="number">0</span>]-l[<span class="number">6</span>]-l[<span class="number">21</span>]-l[<span class="number">16</span>]+l[<span class="number">17</span>]-l[<span class="number">19</span>]-l[<span class="number">28</span>]-l[<span class="number">38</span>]-l[<span class="number">37</span>]+l[<span class="number">9</span>]+l[<span class="number">20</span>]-l[<span class="number">8</span>]-l[<span class="number">3</span>]+l[<span class="number">22</span>]-l[<span class="number">35</span>]-l[<span class="number">10</span>]-l[<span class="number">31</span>]-l[<span class="number">2</span>]+l[<span class="number">41</span>]-l[<span class="number">1</span>]-l[<span class="number">4</span>]+l[<span class="number">24</span>]-l[<span class="number">34</span>]+l[<span class="number">39</span>]+l[<span class="number">40</span>]+l[<span class="number">32</span>]-l[<span class="number">5</span>]+l[<span class="number">36</span>]-l[<span class="number">27</span>] == -<span class="number">529</span>)</span><br><span class="line">s.add(l[<span class="number">38</span>]+l[<span class="number">8</span>]+l[<span class="number">36</span>]+l[<span class="number">35</span>]-l[<span class="number">23</span>]-l[<span class="number">34</span>]+l[<span class="number">13</span>]-l[<span class="number">4</span>]-l[<span class="number">27</span>]-l[<span class="number">24</span>]+l[<span class="number">26</span>]+l[<span class="number">31</span>]-l[<span class="number">30</span>]-l[<span class="number">5</span>]-l[<span class="number">40</span>]+l[<span class="number">28</span>]-l[<span class="number">11</span>]-l[<span class="number">2</span>]-l[<span class="number">39</span>]+l[<span class="number">15</span>]+l[<span class="number">10</span>]-l[<span class="number">17</span>]+l[<span class="number">3</span>]+l[<span class="number">19</span>]+l[<span class="number">22</span>]+l[<span class="number">33</span>]+l[<span class="number">0</span>]+l[<span class="number">37</span>]+l[<span class="number">16</span>]-l[<span class="number">9</span>]-l[<span class="number">32</span>]+l[<span class="number">25</span>]-l[<span class="number">21</span>]-l[<span class="number">12</span>]+l[<span class="number">6</span>]-l[<span class="number">41</span>]+l[<span class="number">20</span>]-l[<span class="number">18</span>] == -<span class="number">12</span>)</span><br><span class="line">s.add(l[<span class="number">6</span>]-l[<span class="number">30</span>]-l[<span class="number">20</span>]-l[<span class="number">27</span>]-l[<span class="number">14</span>]-l[<span class="number">39</span>]+l[<span class="number">41</span>]-l[<span class="number">33</span>]-l[<span class="number">0</span>]+l[<span class="number">25</span>]-l[<span class="number">32</span>]-l[<span class="number">3</span>]+l[<span class="number">26</span>]-l[<span class="number">12</span>]+l[<span class="number">8</span>]-l[<span class="number">35</span>]-l[<span class="number">24</span>]+l[<span class="number">15</span>]+l[<span class="number">9</span>]-l[<span class="number">4</span>]+l[<span class="number">13</span>]+l[<span class="number">36</span>]+l[<span class="number">34</span>]+l[<span class="number">1</span>]-l[<span class="number">28</span>]-l[<span class="number">21</span>]+l[<span class="number">18</span>]+l[<span class="number">23</span>]+l[<span class="number">29</span>]-l[<span class="number">10</span>]-l[<span class="number">38</span>]+l[<span class="number">22</span>]+l[<span class="number">37</span>]+l[<span class="number">5</span>]+l[<span class="number">19</span>]+l[<span class="number">7</span>]+l[<span class="number">16</span>]-l[<span class="number">31</span>] == <span class="number">81</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check()==sat:</span><br><span class="line">    m=s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x2a</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">str</span>(m[l[i]]))),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="MRCTF2020-PixelShooter"><a href="#MRCTF2020-PixelShooter" class="headerlink" title="[MRCTF2020]PixelShooter"></a>[MRCTF2020]PixelShooter</h2><p>jeb打开，C#源文件，得到flag……</p>
<h2 id="2019红帽杯-childRE"><a href="#2019红帽杯-childRE" class="headerlink" title="[2019红帽杯]childRE"></a>[2019红帽杯]childRE</h2><p>我有病，又是抄错一个数据检查半年……如果看不懂加密逻辑，那就爆吧~（手动滑稽</p>
<p>复现此题 <del>感觉以前的解法实在是太憨批了，</del> 遂改了一下代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">model=<span class="string">&#x27;1234567890-=!@#$%^&amp;*()_+qwertyuiop[]QWERTYUIOP&#123;&#125;asdfghjkl;&#x27;</span>+<span class="built_in">chr</span>(<span class="number">0x27</span>)+<span class="string">&#x27;A&#x27;</span>+<span class="string">&#x27;SDFGHJKL:&quot;ZXCVBNM&lt;&gt;?zxcvbnm,./&#x27;</span></span><br><span class="line">s1=<span class="string">&#x27;55565653255552225565565555243466334653663544426565555525555222&#x27;</span><span class="comment">#整除</span></span><br><span class="line">s2=<span class="string">&#x27;(_@4620!08!6_0*0442!@186%%0@3=66!!974*3234=&amp;0^3&amp;1@=&amp;0908!6_0*&amp;&#x27;</span><span class="comment">#取余</span></span><br><span class="line">output=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x3e</span>):</span><br><span class="line">    output+=<span class="built_in">chr</span>(model.find(s1[i])*<span class="number">23</span>+model.find(s2[i]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure>

<p>打出output，然后按照函数名称修饰规则对函数名修饰。最上面一步是个二叉树的排序，就是改变了一下字符串的顺序。懒得逆算法了，就直接打进去一串无重复的字符，然后动调看顺序，把密文按照这个顺序重新排列就好了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">t=<span class="string">&#x27;0123456789qwertyuiopasdfghjklzx&#x27;</span></span><br><span class="line">d=<span class="string">&#x27;yu7io83pa9sdq41fgwhje5klrzxt620&#x27;</span></span><br><span class="line">enc=<span class="string">&#x27;?My_Aut0_PWN@R0Pxx@@AAEPADPAE@Z&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">    flag+=enc[d.index(t[i])]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(flag.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest())</span><br></pre></td></tr></table></figure>

<h2 id="SWPU2019-ReverseMe"><a href="#SWPU2019-ReverseMe" class="headerlink" title="[SWPU2019]ReverseMe"></a>[SWPU2019]ReverseMe</h2><p>这动调真的太恶心了……真的调到自闭了属于是…… <del>彻底治好了不敢看汇编的毛病</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">box1=[</span><br><span class="line">  <span class="number">0xB3</span>, <span class="number">0x37</span>, <span class="number">0x0F</span>, <span class="number">0xF8</span>, <span class="number">0xBC</span>, <span class="number">0xBC</span>, <span class="number">0xAE</span>, <span class="number">0x5D</span>, <span class="number">0xBA</span>, <span class="number">0x5A</span>, </span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x86</span>, <span class="number">0x44</span>, <span class="number">0x97</span>, <span class="number">0x62</span>, <span class="number">0xD3</span>, <span class="number">0x4F</span>, <span class="number">0xBA</span>, <span class="number">0x24</span>, <span class="number">0x16</span>, </span><br><span class="line">  <span class="number">0x0B</span>, <span class="number">0x9F</span>, <span class="number">0x72</span>, <span class="number">0x1A</span>, <span class="number">0x65</span>, <span class="number">0x68</span>, <span class="number">0x6D</span>, <span class="number">0x26</span>, <span class="number">0xBA</span>, <span class="number">0x6B</span>, </span><br><span class="line">  <span class="number">0xC8</span>, <span class="number">0x67</span></span><br><span class="line">]</span><br><span class="line">box2=[</span><br><span class="line">  <span class="number">0x86</span>, <span class="number">0x0C</span>, <span class="number">0x3E</span>, <span class="number">0xCA</span>, <span class="number">0x98</span>, <span class="number">0xD7</span>, <span class="number">0xAE</span>, <span class="number">0x19</span>, <span class="number">0xE2</span>, <span class="number">0x77</span>, </span><br><span class="line">  <span class="number">0x6B</span>, <span class="number">0xA6</span>, <span class="number">0x6A</span>, <span class="number">0xA1</span>, <span class="number">0x77</span>, <span class="number">0xB0</span>, <span class="number">0x69</span>, <span class="number">0x91</span>, <span class="number">0x37</span>, <span class="number">0x05</span>, </span><br><span class="line">  <span class="number">0x7A</span>, <span class="number">0xF9</span>, <span class="number">0x7B</span>, <span class="number">0x30</span>, <span class="number">0x43</span>, <span class="number">0x5A</span>, <span class="number">0x4B</span>, <span class="number">0x10</span>, <span class="number">0x86</span>, <span class="number">0x7D</span>, </span><br><span class="line">  <span class="number">0xD4</span>, <span class="number">0x28</span></span><br><span class="line">]</span><br><span class="line">s=<span class="string">&quot;SWPU_2019_CTF&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[i%<span class="built_in">len</span>(s)])^box1[i]^box2[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="羊城杯-2020-easyre"><a href="#羊城杯-2020-easyre" class="headerlink" title="[羊城杯 2020]easyre"></a>[羊城杯 2020]easyre</h2><p>白给题，base64加密之后13个一组移位，然后凯撒位移3……<br><del>（虽然我这个sb因为加减写反了检查了好久……</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">enc3=<span class="string">&#x27;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3=cT6QckkPckoRG&#x27;</span></span><br><span class="line">enc2=<span class="string">&#x27;&#x27;</span></span><br><span class="line">enc1=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc3:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(i)&lt;=<span class="built_in">ord</span>(<span class="string">&#x27;@&#x27;</span>) <span class="keyword">or</span> <span class="built_in">ord</span>(i)&gt;<span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(i)&lt;=<span class="built_in">ord</span>(<span class="string">&#x27;`&#x27;</span>) <span class="keyword">or</span> <span class="built_in">ord</span>(i)&gt;<span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">ord</span>(i)&lt;=<span class="number">47</span> <span class="keyword">or</span> <span class="built_in">ord</span>(i)&gt;<span class="number">57</span>:</span><br><span class="line">                enc2+=i</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                enc2+=<span class="built_in">chr</span>((<span class="built_in">ord</span>(i)-<span class="number">48</span>-<span class="number">3</span>)%<span class="number">10</span>+<span class="number">48</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            enc2+=<span class="built_in">chr</span>((<span class="built_in">ord</span>(i)-<span class="number">97</span>-<span class="number">3</span>)%<span class="number">26</span>+<span class="number">97</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        enc2+=<span class="built_in">chr</span>((<span class="built_in">ord</span>(i)-<span class="number">65</span>-<span class="number">3</span>)%<span class="number">26</span>+<span class="number">65</span>)</span><br><span class="line">enc1+=enc2[<span class="number">13</span>:<span class="number">26</span>]</span><br><span class="line">enc1+=enc2[<span class="number">39</span>:<span class="number">52</span>]</span><br><span class="line">enc1+=enc2[<span class="number">0</span>:<span class="number">13</span>]</span><br><span class="line">enc1+=enc2[<span class="number">26</span>:<span class="number">39</span>]</span><br><span class="line"><span class="built_in">print</span> (base64.b64decode(enc1))</span><br></pre></td></tr></table></figure>

<h2 id="CFI-CTF-2018-IntroToPE"><a href="#CFI-CTF-2018-IntroToPE" class="headerlink" title="[CFI-CTF 2018]IntroToPE"></a>[CFI-CTF 2018]IntroToPE</h2><p>dnspy打开，看到关键判断函数，跳转，base64，获得flag……</p>
<h2 id="安洵杯-2019-crackMe"><a href="#安洵杯-2019-crackMe" class="headerlink" title="[安洵杯 2019]crackMe"></a>[安洵杯 2019]crackMe</h2><p>SM4+base64换表<br>学了密码之后再看这种块加密和流加密的题感觉还是不错的哈哈哈</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> pysm4 <span class="keyword">import</span> decrypt</span><br><span class="line"></span><br><span class="line">initial=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">enc=<span class="string">&#x27;1UTAOIkpyOSWGv/mOYFY4R==&#x27;</span></span><br><span class="line">enc_base=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(enc),<span class="number">2</span>):</span><br><span class="line">    enc_base+=enc[i+<span class="number">1</span>]</span><br><span class="line">    enc_base+=enc[i]</span><br><span class="line"></span><br><span class="line">initial=initial.swapcase()</span><br><span class="line">new_list=initial[<span class="number">24</span>:]+initial[:<span class="number">24</span>]</span><br><span class="line">model = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">tmp=base64.b64decode(enc_base.translate(<span class="built_in">str</span>.maketrans(new_list,model)))</span><br><span class="line"></span><br><span class="line">enc_sm4 = <span class="built_in">int</span>(tmp.<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">key=<span class="built_in">int</span>(<span class="string">b&#x27;where_are_u_now?&#x27;</span>.<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">dec=decrypt(enc_sm4,key)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(dec)[<span class="number">2</span>:]).decode()+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="WUSTCTF2020-funnyre"><a href="#WUSTCTF2020-funnyre" class="headerlink" title="[WUSTCTF2020]funnyre"></a>[WUSTCTF2020]funnyre</h2><p>忘记记录++……</p>
<h2 id="QCTF2018-Xman-babymips"><a href="#QCTF2018-Xman-babymips" class="headerlink" title="[QCTF2018]Xman-babymips"></a>[QCTF2018]Xman-babymips</h2><p>刚开始一直以为我爆破写错了，结果是我漏了前面一个异或的步骤 <del>裂开</del>什么时候才能不再犯这种神比错误</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">box=[</span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0xFD</span>, <span class="number">0x16</span>, <span class="number">0xA4</span>, <span class="number">0x89</span>, <span class="number">0xBD</span>, <span class="number">0x92</span>, <span class="number">0x80</span>, <span class="number">0x13</span>, <span class="number">0x41</span>, </span><br><span class="line">  <span class="number">0x54</span>, <span class="number">0xA0</span>, <span class="number">0x8D</span>, <span class="number">0x45</span>, <span class="number">0x18</span>, <span class="number">0x81</span>, <span class="number">0xDE</span>, <span class="number">0xFC</span>, <span class="number">0x95</span>, <span class="number">0xF0</span>, </span><br><span class="line">  <span class="number">0x16</span>, <span class="number">0x79</span>, <span class="number">0x1A</span>, <span class="number">0x15</span>, <span class="number">0x5B</span>, <span class="number">0x75</span>, <span class="number">0x1F</span></span><br><span class="line">]</span><br><span class="line">flag=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="built_in">len</span>(box)+<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">if</span> i&amp;<span class="number">1</span>!=<span class="number">0</span>:</span><br><span class="line">            v=((box[i-<span class="number">5</span>]&gt;&gt;<span class="number">6</span>)|(box[i-<span class="number">5</span>]&lt;&lt;<span class="number">2</span>))&amp;<span class="number">0xff</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v=((box[i-<span class="number">5</span>]&lt;&lt;<span class="number">6</span>)|(box[i-<span class="number">5</span>]&gt;&gt;<span class="number">2</span>))&amp;<span class="number">0xff</span></span><br><span class="line">        flag.append(v^(<span class="number">32</span>-i))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="羊城杯-2020-login"><a href="#羊城杯-2020-login" class="headerlink" title="[羊城杯 2020]login"></a>[羊城杯 2020]login</h2><p>pyinstxtractor.py用着真的很烦……为什么要去掉头文件……<br>这个题基本一大半时间在查这个包怎么用，winhex怎么插文件头，插几个字节……<br><del>uncompyle6被雷劈了，目前懒得修，先用在线网站凑合凑合……</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a1 =Int(<span class="string">&#x27;a1&#x27;</span>)</span><br><span class="line">a2 =Int(<span class="string">&#x27;a2&#x27;</span>)</span><br><span class="line">a3 =Int(<span class="string">&#x27;a3&#x27;</span>)</span><br><span class="line">a4 =Int(<span class="string">&#x27;a4&#x27;</span>)</span><br><span class="line">a5 =Int(<span class="string">&#x27;a5&#x27;</span>)</span><br><span class="line">a6 =Int(<span class="string">&#x27;a6&#x27;</span>)</span><br><span class="line">a7 =Int(<span class="string">&#x27;a7&#x27;</span>)</span><br><span class="line">a8 =Int(<span class="string">&#x27;a8&#x27;</span>)</span><br><span class="line">a9 =Int(<span class="string">&#x27;a9&#x27;</span>)</span><br><span class="line">a10 =Int(<span class="string">&#x27;a10&#x27;</span>)</span><br><span class="line">a11 =Int(<span class="string">&#x27;a11&#x27;</span>)</span><br><span class="line">a12 =Int(<span class="string">&#x27;a12&#x27;</span>)</span><br><span class="line">a13 =Int(<span class="string">&#x27;a13&#x27;</span>)</span><br><span class="line">a14 =Int(<span class="string">&#x27;a14&#x27;</span>)</span><br><span class="line"></span><br><span class="line">s=Solver()</span><br><span class="line">s.add((((a1 * <span class="number">88</span> + a2 * <span class="number">67</span> + a3 * <span class="number">65</span> - a4 * <span class="number">5</span>) + a5 * <span class="number">43</span> + a6 * <span class="number">89</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">36</span>) + a10 * <span class="number">15</span> + a11 * <span class="number">11</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span>) + a14 * <span class="number">29</span> == <span class="number">22748</span>) </span><br><span class="line">s.add((((a1 * <span class="number">89</span> + a2 * <span class="number">7</span> + a3 * <span class="number">12</span> - a4 * <span class="number">25</span>) + a5 * <span class="number">41</span> + a6 * <span class="number">23</span> + a7 * <span class="number">20</span> - a8 * <span class="number">66</span>) + a9 * <span class="number">31</span> + a10 * <span class="number">8</span> + a11 * <span class="number">2</span> - a12 * <span class="number">41</span> - a13 * <span class="number">39</span>) + a14 * <span class="number">17</span> == <span class="number">7258</span>) </span><br><span class="line">s.add((((a1 * <span class="number">28</span> + a2 * <span class="number">35</span> + a3 * <span class="number">16</span> - a4 * <span class="number">65</span>) + a5 * <span class="number">53</span> + a6 * <span class="number">39</span> + a7 * <span class="number">27</span> + a8 * <span class="number">15</span> - a9 * <span class="number">33</span>) + a10 * <span class="number">13</span> + a11 * <span class="number">101</span> + a12 * <span class="number">90</span> - a13 * <span class="number">34</span>) + a14 * <span class="number">23</span> == <span class="number">26190</span>) </span><br><span class="line">s.add((((a1 * <span class="number">23</span> + a2 * <span class="number">34</span> + a3 * <span class="number">35</span> - a4 * <span class="number">59</span>) + a5 * <span class="number">49</span> + a6 * <span class="number">81</span> + a7 * <span class="number">25</span> + (a8 *<span class="number">128</span>) - a9 * <span class="number">32</span>) + a10 * <span class="number">75</span> + a11 * <span class="number">81</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span>) + a14 * <span class="number">29</span> == <span class="number">37136</span>) </span><br><span class="line">s.add(((a1 * <span class="number">38</span> + a2 * <span class="number">97</span> + a3 * <span class="number">35</span> - a4 * <span class="number">52</span>) + a5 * <span class="number">42</span> + a6 * <span class="number">79</span> + a7 * <span class="number">90</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span>) + a10 * <span class="number">57</span> + a11 * <span class="number">81</span> + a12 * <span class="number">42</span> - a13 * <span class="number">62</span> - a14 * <span class="number">11</span> == <span class="number">27915</span>) </span><br><span class="line">s.add((((a1 * <span class="number">22</span> + a2 * <span class="number">27</span> + a3 * <span class="number">35</span> - a4 * <span class="number">45</span>) + a5 * <span class="number">47</span> + a6 * <span class="number">49</span> + a7 * <span class="number">29</span> + a8 * <span class="number">18</span> - a9 * <span class="number">26</span>) + a10 * <span class="number">35</span> + a11 * <span class="number">41</span> + a12 * <span class="number">40</span> - a13 * <span class="number">61</span>) + a14 * <span class="number">28</span> == <span class="number">17298</span>) </span><br><span class="line">s.add((((a1 * <span class="number">12</span> + a2 * <span class="number">45</span> + a3 * <span class="number">35</span> - a4 * <span class="number">9</span> - a5 * <span class="number">42</span>) + a6 * <span class="number">86</span> + a7 * <span class="number">23</span> + a8 * <span class="number">85</span> - a9 * <span class="number">47</span>) + a10 * <span class="number">34</span> + a11 * <span class="number">76</span> + a12 * <span class="number">43</span> - a13 * <span class="number">44</span>) + a14 * <span class="number">65</span> == <span class="number">19875</span>) </span><br><span class="line">s.add(((a1 * <span class="number">79</span> + a2 * <span class="number">62</span> + a3 * <span class="number">35</span> - a4 * <span class="number">85</span>) + a5 * <span class="number">33</span> + a6 * <span class="number">79</span> + a7 * <span class="number">86</span> + a8 * <span class="number">14</span> - a9 * <span class="number">30</span>) + a10 * <span class="number">25</span> + a11 * <span class="number">11</span> + a12 * <span class="number">57</span> - a13 * <span class="number">50</span> - a14 * <span class="number">9</span> == <span class="number">22784</span>) </span><br><span class="line">s.add((((a1 * <span class="number">8</span> + a2 * <span class="number">6</span> + a3 * <span class="number">64</span> - a4 * <span class="number">85</span>) + a5 * <span class="number">73</span> + a6 * <span class="number">29</span> + a7 * <span class="number">2</span> + a8 * <span class="number">23</span> - a9 * <span class="number">36</span>) + a10 * <span class="number">5</span> + a11 * <span class="number">2</span> + a12 * <span class="number">47</span> - a13 * <span class="number">64</span>) + a14 * <span class="number">27</span> == <span class="number">9710</span>) </span><br><span class="line">s.add(((((a1 * <span class="number">67</span> - a2 * <span class="number">68</span>) + a3 * <span class="number">68</span> - a4 * <span class="number">51</span> - a5 * <span class="number">43</span>) + a6 * <span class="number">81</span> + a7 * <span class="number">22</span> - a8 * <span class="number">12</span> - a9 * <span class="number">38</span>) + a10 * <span class="number">75</span> + a11 * <span class="number">41</span> + a12 * <span class="number">27</span> - a13 * <span class="number">52</span>) + a14 * <span class="number">31</span> == <span class="number">13376</span>) </span><br><span class="line">s.add((((a1 * <span class="number">85</span> + a2 * <span class="number">63</span> + a3 * <span class="number">5</span> - a4 * <span class="number">51</span>) + a5 * <span class="number">44</span> + a6 * <span class="number">36</span> + a7 * <span class="number">28</span> + a8 * <span class="number">15</span> - a9 * <span class="number">6</span>) + a10 * <span class="number">45</span> + a11 * <span class="number">31</span> + a12 * <span class="number">7</span> - a13 * <span class="number">67</span>) + a14 * <span class="number">78</span> == <span class="number">24065</span>) </span><br><span class="line">s.add((((a1 * <span class="number">47</span> + a2 * <span class="number">64</span> + a3 * <span class="number">66</span> - a4 * <span class="number">5</span>) + a5 * <span class="number">43</span> + a6 * <span class="number">112</span> + a7 * <span class="number">25</span> + a8 * <span class="number">13</span> - a9 * <span class="number">35</span>) + a10 * <span class="number">95</span> + a11 * <span class="number">21</span> + a12 * <span class="number">43</span> - a13 * <span class="number">61</span>) + a14 * <span class="number">20</span> == <span class="number">27687</span>) </span><br><span class="line">s.add(((a1 * <span class="number">89</span> + a2 * <span class="number">67</span> + a3 * <span class="number">85</span> - a4 * <span class="number">25</span>) + a5 * <span class="number">49</span> + a6 * <span class="number">89</span> + a7 * <span class="number">23</span> + a8 * <span class="number">56</span> - a9 * <span class="number">92</span>) + a10 * <span class="number">14</span> + a11 * <span class="number">89</span> + a12 * <span class="number">47</span> - a13 * <span class="number">61</span> - a14 * <span class="number">29</span> == <span class="number">29250</span>) </span><br><span class="line">s.add(((a1 * <span class="number">95</span> + a2 * <span class="number">34</span> + a3 * <span class="number">62</span> - a4 * <span class="number">9</span> - a5 * <span class="number">43</span>) + a6 * <span class="number">83</span> + a7 * <span class="number">25</span> + a8 * <span class="number">12</span> - a9 * <span class="number">36</span>) + a10 * <span class="number">16</span> + a11 * <span class="number">51</span> + a12 * <span class="number">47</span> - a13 * <span class="number">60</span> - a14 * <span class="number">24</span> == <span class="number">15317</span>)</span><br><span class="line"><span class="keyword">if</span> s.check()==sat:</span><br><span class="line">	<span class="built_in">print</span>(s.model())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">code=[<span class="number">0</span>]*<span class="number">14</span></span><br><span class="line">a13 = <span class="number">88</span></span><br><span class="line">a3 = <span class="number">10</span></span><br><span class="line">a4 = <span class="number">7</span></span><br><span class="line">a10 = <span class="number">108</span></span><br><span class="line">a12 = <span class="number">74</span></span><br><span class="line">a1 = <span class="number">119</span></span><br><span class="line">a7 = <span class="number">28</span></span><br><span class="line">a6 = <span class="number">43</span></span><br><span class="line">a9 = <span class="number">52</span></span><br><span class="line">a14 = <span class="number">33</span></span><br><span class="line">a5 = <span class="number">104</span></span><br><span class="line">a8 = <span class="number">91</span></span><br><span class="line">a2 = <span class="number">24</span></span><br><span class="line">a11 = <span class="number">88</span></span><br><span class="line">code[<span class="number">2</span>]=a1</span><br><span class="line">code[<span class="number">1</span>]=a2</span><br><span class="line">code[<span class="number">0</span>]=a3</span><br><span class="line">code[<span class="number">3</span>]=a4</span><br><span class="line">code[<span class="number">4</span>]=a5</span><br><span class="line">code[<span class="number">5</span>]=a6</span><br><span class="line">code[<span class="number">6</span>]=a7</span><br><span class="line">code[<span class="number">7</span>]=a8</span><br><span class="line">code[<span class="number">9</span>]=a9</span><br><span class="line">code[<span class="number">8</span>]=a10</span><br><span class="line">code[<span class="number">10</span>]=a11</span><br><span class="line">code[<span class="number">11</span>]=a12</span><br><span class="line">code[<span class="number">12</span>]=a13</span><br><span class="line">code[<span class="number">13</span>]=a14</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    code[i]=code[i]^code[i+<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> code:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#U_G07_th3_k3y!</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">f=<span class="string">&#x27;U_G07_th3_k3y!&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(f.encode()).hexdigest())</span><br></pre></td></tr></table></figure>

<h2 id="RoarCTF2019-polyre"><a href="#RoarCTF2019-polyre" class="headerlink" title="[RoarCTF2019]polyre"></a>[RoarCTF2019]polyre</h2><p>学习了去除控制流平坦化和用idapython脚本去除永真条件……<br>感觉很nb <a href="htftps://security.tencent.com/index.php/blog/msg/112">原文链接</a><br><del>其实都是抄脚本QAQ</del><br>然后就是逆这个CRC64了，好久没做题了，真费劲……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="number">0x96</span>, <span class="number">0x62</span>, <span class="number">0x53</span>, <span class="number">0x43</span>, <span class="number">0x6D</span>, <span class="number">0xF2</span>, <span class="number">0x8F</span>, <span class="number">0xBC</span>, <span class="number">0x16</span>, <span class="number">0xEE</span>, </span><br><span class="line">  <span class="number">0x30</span>, <span class="number">0x05</span>, <span class="number">0x78</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x52</span>, <span class="number">0xEC</span>, <span class="number">0x08</span>, <span class="number">0x5F</span>, <span class="number">0x93</span>, </span><br><span class="line">  <span class="number">0xEA</span>, <span class="number">0xB5</span>, <span class="number">0xC0</span>, <span class="number">0x4D</span>, <span class="number">0x50</span>, <span class="number">0xF4</span>, <span class="number">0x53</span>, <span class="number">0xD8</span>, <span class="number">0xAF</span>, <span class="number">0x90</span>, </span><br><span class="line">  <span class="number">0x2B</span>, <span class="number">0x34</span>, <span class="number">0x81</span>, <span class="number">0x36</span>, <span class="number">0x2C</span>, <span class="number">0xAA</span>, <span class="number">0xBC</span>, <span class="number">0x0E</span>, <span class="number">0x25</span>, <span class="number">0x8B</span>, </span><br><span class="line">  <span class="number">0xE4</span>, <span class="number">0x8A</span>, <span class="number">0xC6</span>, <span class="number">0xA2</span>, <span class="number">0x81</span>, <span class="number">0x9F</span>, <span class="number">0x75</span>, <span class="number">0x55</span>, <span class="number">0xB3</span>, <span class="number">0x26</span>, </span><br><span class="line">  <span class="number">0xFA</span>, <span class="number">0x79</span>, <span class="number">0x76</span>, <span class="number">0x4B</span>, <span class="number">0x00</span>, <span class="number">0xB0</span>]</span><br><span class="line">key=<span class="number">0xB0004B7679FA26B3</span></span><br><span class="line">table=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(enc),<span class="number">8</span>):</span><br><span class="line">    t=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        t&lt;&lt;=<span class="number">8</span></span><br><span class="line">        t+=enc[i+<span class="number">7</span>-j]</span><br><span class="line">    table.append(t)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        f=i&amp;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> f==<span class="number">1</span>:</span><br><span class="line">            i^=key</span><br><span class="line">        i&gt;&gt;=<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> f==<span class="number">1</span>:</span><br><span class="line">            i|=<span class="number">0x8000000000000000</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(i))</span><br><span class="line"></span><br><span class="line">enc=[<span class="number">0x6666367b67616c66</span>,<span class="number">0x63362d3039333932</span>,<span class="number">0x2d363563342d3032</span>,<span class="number">0x3539612d30376162</span>,<span class="number">0x6631643365383537</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(i&amp;<span class="number">0xff</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        i&gt;&gt;=<span class="number">8</span></span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">0x38</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">0x7d</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>


<h2 id="NPUCTF2020-你好sao啊"><a href="#NPUCTF2020-你好sao啊" class="headerlink" title="[NPUCTF2020]你好sao啊"></a>[NPUCTF2020]你好sao啊</h2><p>呜呜，是rx大人出的题<br>我麻了，被一个base64折磨一个多小时，屈服了，直接嫖代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line">s = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234&#123;&#125;789+/&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">My_base64_encode</span>():</span><br><span class="line">    inputs = <span class="string">b&#x27;\x9e\x9b\x9c\xb5\xfe\x70\xd3\x0f\xb2\xd1\x4f\x9c\x02\x7f\xab\xde\x59\x65\x63\xe7\x40\x9d\xcd\xfa\x04&#x27;</span></span><br><span class="line">    <span class="comment"># 将字符串转化为2进制</span></span><br><span class="line">    bin_str = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> inputs:</span><br><span class="line">        x = <span class="built_in">str</span>(<span class="built_in">bin</span>(i)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        bin_str.append(<span class="string">&#x27;&#123;:0&gt;8&#125;&#x27;</span>.<span class="built_in">format</span>(x))</span><br><span class="line">    <span class="built_in">print</span>(bin_str)</span><br><span class="line">    <span class="comment"># 输出的字符串</span></span><br><span class="line">    outputs = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 不够三倍数，需补齐的次数</span></span><br><span class="line">    nums = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> bin_str:</span><br><span class="line">        <span class="comment"># 每次取三个字符的二进制</span></span><br><span class="line">        temp_list = bin_str[:<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(temp_list) != <span class="number">3</span>):</span><br><span class="line">            nums = <span class="number">3</span> - <span class="built_in">len</span>(temp_list)</span><br><span class="line">            <span class="keyword">while</span> <span class="built_in">len</span>(temp_list) &lt; <span class="number">3</span>:</span><br><span class="line">                temp_list += [<span class="string">&#x27;0&#x27;</span> * <span class="number">8</span>]</span><br><span class="line">        temp_str = <span class="string">&quot;&quot;</span>.join(temp_list)</span><br><span class="line">        <span class="comment"># print(temp_str)</span></span><br><span class="line">        <span class="comment"># 将三个8字节的二进制转换为4个十进制</span></span><br><span class="line">        temp_str_list = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">4</span>):</span><br><span class="line">            temp_str_list.append(<span class="built_in">int</span>(temp_str[i*<span class="number">6</span>:(i+<span class="number">1</span>)*<span class="number">6</span>], <span class="number">2</span>))</span><br><span class="line">        <span class="comment"># print(temp_str_list)</span></span><br><span class="line">        <span class="keyword">if</span> nums:</span><br><span class="line">            temp_str_list = temp_str_list[<span class="number">0</span>:<span class="number">4</span> - nums]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> temp_str_list:</span><br><span class="line">            outputs += s[i]</span><br><span class="line">        bin_str = bin_str[<span class="number">3</span>:]</span><br><span class="line">    outputs += nums * <span class="string">&#x27;=&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Encrypted String:\n%s &quot;</span> % outputs)</span><br><span class="line">My_base64_encode()</span><br></pre></td></tr></table></figure>

<h2 id="UTCTF2020-babymips"><a href="#UTCTF2020-babymips" class="headerlink" title="[UTCTF2020]babymips"></a>[UTCTF2020]babymips</h2><p>神tm，出来一堆乱码我还以为又错了，结果交了竟然是对的……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">box=[</span><br><span class="line"> <span class="number">0x62</span>, <span class="number">0x6C</span>, <span class="number">0x7F</span>, <span class="number">0x76</span>, <span class="number">0x7A</span>, <span class="number">0x7B</span>, <span class="number">0x66</span>, <span class="number">0x73</span>, <span class="number">0x76</span>, <span class="number">0x50</span>, </span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0x7D</span>, <span class="number">0x40</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x79</span>, <span class="number">0x40</span>, <span class="number">0x49</span>, <span class="number">0x47</span>, <span class="number">0x4D</span>, </span><br><span class="line">  <span class="number">0x74</span>, <span class="number">0x19</span>, <span class="number">0x7B</span>, <span class="number">0x6A</span>, <span class="number">0x42</span>, <span class="number">0x0A</span>, <span class="number">0x4F</span>, <span class="number">0x52</span>, <span class="number">0x7D</span>, <span class="number">0x69</span>, </span><br><span class="line">  <span class="number">0x4F</span>, <span class="number">0x53</span>, <span class="number">0x0C</span>, <span class="number">0x64</span>, <span class="number">0x10</span>, <span class="number">0x0F</span>, <span class="number">0x1E</span>, <span class="number">0x4A</span>, <span class="number">0x67</span>, <span class="number">0x03</span>, </span><br><span class="line">  <span class="number">0x7C</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x6A</span>, <span class="number">0x31</span>, <span class="number">0x67</span>, <span class="number">0x61</span>, <span class="number">0x37</span>, <span class="number">0x7A</span>, <span class="number">0x62</span>, </span><br><span class="line">  <span class="number">0x2C</span>, <span class="number">0x2C</span>, <span class="number">0x0F</span>, <span class="number">0x6E</span>, <span class="number">0x17</span>, <span class="number">0x00</span>, <span class="number">0x16</span>, <span class="number">0x0F</span>, <span class="number">0x16</span>, <span class="number">0x0A</span>, </span><br><span class="line">  <span class="number">0x6D</span>, <span class="number">0x62</span>, <span class="number">0x73</span>, <span class="number">0x25</span>, <span class="number">0x39</span>, <span class="number">0x76</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0x63</span>, <span class="number">0x78</span>, </span><br><span class="line">  <span class="number">0x2B</span>, <span class="number">0x74</span>, <span class="number">0x32</span>, <span class="number">0x16</span>, <span class="number">0x20</span>, <span class="number">0x22</span>, <span class="number">0x44</span>, <span class="number">0x19</span> </span><br><span class="line">]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(box)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(box[i]^(i+<span class="number">23</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="安洵杯-2019-game"><a href="#安洵杯-2019-game" class="headerlink" title="[安洵杯 2019]game"></a>[安洵杯 2019]game</h2><p>控制流平坦化……代码真的难看……<br>check1里有两次交换，一次交换v12和v12+1，这个很好认，就是交换相邻位，判断是v12小于v4（v4是输入长度）。但是有一处交换v12和v11的，瞅了半天没看懂，网上都没有分析，直接交换前后两部分……后来仔细看了看v12和v11的交叉引用，v11的起始是0，往后自增，判断是小于v12&gt;&gt;1……我刚开始还挺疑惑这个<code>v11&lt;v12&gt;&gt;1</code>的，<del>感觉不像是碳基生物能写出来的代码</del> 后来仔细想了一下，<code>v12&gt;&gt;1</code>不就是除以2吗……然后每次给v11和v12自增并且交换，那就是换掉前后两部分……<br>汗……看起来奇奇怪怪的代码还是不能直接无视啊……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;4693641762894685722843556137219876255986&#x27;</span></span><br><span class="line">f=<span class="string">&#x27;&#x27;</span></span><br><span class="line">flag=[<span class="number">0</span>]*<span class="number">40</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(s),<span class="number">2</span>):</span><br><span class="line">    a=<span class="built_in">ord</span>(s[i])+<span class="number">20</span></span><br><span class="line">    b=<span class="built_in">ord</span>(s[i+<span class="number">1</span>])+<span class="number">20</span></span><br><span class="line">    a=(a&amp;<span class="number">0xf3</span>)|(~a&amp;<span class="number">0xc</span>)</span><br><span class="line">    b=(b&amp;<span class="number">0xf3</span>)|(~b&amp;<span class="number">0xc</span>)</span><br><span class="line">    f+=<span class="built_in">chr</span>(b)</span><br><span class="line">    f+=<span class="built_in">chr</span>(a)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    (flag[i],flag[i+<span class="number">20</span>]) = (f[i+<span class="number">20</span>], f[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(i,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="GUET-CTF2019-encrypt"><a href="#GUET-CTF2019-encrypt" class="headerlink" title="[GUET-CTF2019]encrypt"></a>[GUET-CTF2019]encrypt</h2><p>rc4+位交换，竟然觉得这种纯粹的逆加密算法题异常温柔……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">box=[<span class="number">0xB0</span> ,<span class="number">0x31</span>,<span class="number">0x75</span> ,<span class="number">0x70</span> ,<span class="number">0xF8</span> ,<span class="number">0xDF</span>,<span class="number">0x07</span> ,<span class="number">0x3C</span> ,<span class="number">0x78</span> ,<span class="number">0x71</span>,<span class="number">0x50</span> ,<span class="number">0x29</span> ,<span class="number">0x2C</span> ,<span class="number">0x16</span>,<span class="number">0x69</span> ,<span class="number">0x12</span> ,<span class="number">0xC8</span> ,<span class="number">0x2B</span>,<span class="number">0x3B</span> ,<span class="number">0x7F</span> ,<span class="number">0xB2</span> ,<span class="number">0xE7</span>,<span class="number">0x4B</span> ,<span class="number">0x68</span> ,<span class="number">0x8C</span> ,<span class="number">0xC5</span>,<span class="number">0xA6</span> ,<span class="number">0x15</span> ,<span class="number">0x03</span> ,<span class="number">0x58</span>,<span class="number">0x47</span> ,<span class="number">0x04</span> ,<span class="number">0x13</span> ,<span class="number">0x8D</span>,<span class="number">0x87</span> ,<span class="number">0x26</span> ,<span class="number">0x09</span> ,<span class="number">0xED</span>,<span class="number">0x17</span> ,<span class="number">0x8A</span> ,<span class="number">0xC2</span> ,<span class="number">0xF2</span>,<span class="number">0x43</span> ,<span class="number">0xC0</span> ,<span class="number">0xAC</span> ,<span class="number">0x59</span>,<span class="number">0x97</span> ,<span class="number">0xF5</span> ,<span class="number">0x3F</span> ,<span class="number">0x67</span>,<span class="number">0x5E</span> ,<span class="number">0x39</span> ,<span class="number">0x86</span> ,<span class="number">0xD5</span>,<span class="number">0x72</span> ,<span class="number">0x61</span> ,<span class="number">0xDA</span> ,<span class="number">0xF7</span>,<span class="number">0x01</span> ,<span class="number">0x05</span> ,<span class="number">0x8B</span> ,<span class="number">0xC3</span>,<span class="number">0xB1</span> ,<span class="number">0x77</span> ,<span class="number">0xAF</span> ,<span class="number">0x1D</span>,<span class="number">0x30</span> ,<span class="number">0xC6</span> ,<span class="number">0x45</span> ,<span class="number">0x0E</span>,<span class="number">0x5F</span> ,<span class="number">0xEE</span> ,<span class="number">0xAE</span> ,<span class="number">0xF0</span>,<span class="number">0x28</span> ,<span class="number">0xCE</span> ,<span class="number">0xCD</span> ,<span class="number">0xA7</span>,<span class="number">0x9B</span> ,<span class="number">0x2A</span> ,<span class="number">0x19</span> ,<span class="number">0x48</span>,<span class="number">0x08</span> ,<span class="number">0x44</span> ,<span class="number">0x20</span> ,<span class="number">0xFE</span>,<span class="number">0x6D</span> ,<span class="number">0xB5</span> ,<span class="number">0x2E</span> ,<span class="number">0x6A</span>,<span class="number">0xF1</span> ,<span class="number">0x34</span> ,<span class="number">0xBC</span> ,<span class="number">0x1E</span>,<span class="number">0x3E</span> ,<span class="number">0xCC</span> ,<span class="number">0x41</span> ,<span class="number">0x92</span>,<span class="number">0xD8</span> ,<span class="number">0xBD</span> ,<span class="number">0xA5</span> ,<span class="number">0xE8</span>,<span class="number">0x4D</span> ,<span class="number">0x0A</span> ,<span class="number">0x49</span> ,<span class="number">0x0D</span>,<span class="number">0xA2</span> ,<span class="number">0xFA</span> ,<span class="number">0x62</span> ,<span class="number">0x74</span>,<span class="number">0xD4</span> ,<span class="number">0x83</span> ,<span class="number">0x96</span> ,<span class="number">0x94</span>,<span class="number">0x3D</span> ,<span class="number">0xCB</span> ,<span class="number">0x18</span> ,<span class="number">0x63</span>,<span class="number">0x99</span> ,<span class="number">0x46</span> ,<span class="number">0xCA</span> ,<span class="number">0xB7</span>,<span class="number">0x8E</span> ,<span class="number">0xCF</span> ,<span class="number">0xFB</span> ,<span class="number">0xA3</span>,<span class="number">0x6C</span> ,<span class="number">0x7E</span> ,<span class="number">0x51</span> ,<span class="number">0x27</span>,<span class="number">0x60</span> ,<span class="number">0x9A</span> ,<span class="number">0x11</span> ,<span class="number">0xF3</span>,<span class="number">0x5C</span> ,<span class="number">0x6E</span> ,<span class="number">0xBA</span> ,<span class="number">0x42</span>,<span class="number">0x76</span> ,<span class="number">0x2F</span> ,<span class="number">0xEF</span> ,<span class="number">0xBF</span>,<span class="number">0x21</span> ,<span class="number">0xAA</span> ,<span class="number">0xE4</span> ,<span class="number">0xD6</span>,<span class="number">0x1B</span> ,<span class="number">0x55</span> ,<span class="number">0x7D</span> ,<span class="number">0xBE</span>,<span class="number">0xEA</span> ,<span class="number">0xD3</span> ,<span class="number">0x10</span> ,<span class="number">0xF4</span>,<span class="number">0xC7</span> ,<span class="number">0x4A</span> ,<span class="number">0x23</span> ,<span class="number">0x79</span>,<span class="number">0x84</span> ,<span class="number">0xA4</span> ,<span class="number">0x1C</span> ,<span class="number">0xAB</span>,<span class="number">0x14</span> ,<span class="number">0xDB</span> ,<span class="number">0x4C</span> ,<span class="number">0x3A</span>,<span class="number">0xB8</span> ,<span class="number">0x52</span> ,<span class="number">0xEC</span> ,<span class="number">0x37</span>,<span class="number">0x38</span> ,<span class="number">0xB6</span> ,<span class="number">0xD2</span> ,<span class="number">0xA0</span>,<span class="number">0x5A</span> ,<span class="number">0x5B</span> ,<span class="number">0x98</span> ,<span class="number">0x66</span>,<span class="number">0x54</span> ,<span class="number">0x9E</span> ,<span class="number">0x4E</span> ,<span class="number">0x4F</span>,<span class="number">0xB4</span> ,<span class="number">0xC4</span> ,<span class="number">0xC9</span> ,<span class="number">0xD0</span>,<span class="number">0x25</span> ,<span class="number">0x9C</span> ,<span class="number">0x80</span> ,<span class="number">0xDE</span>,<span class="number">0x2D</span> ,<span class="number">0x06</span> ,<span class="number">0x22</span> ,<span class="number">0x0B</span>,<span class="number">0x91</span> ,<span class="number">0x6B</span> ,<span class="number">0x9F</span> ,<span class="number">0xF6</span>,<span class="number">0xE6</span> ,<span class="number">0xE2</span> ,<span class="number">0xC1</span> ,<span class="number">0x0F</span>,<span class="number">0x93</span> ,<span class="number">0x90</span> ,<span class="number">0x7B</span> ,<span class="number">0x9D</span>,<span class="number">0x8F</span> ,<span class="number">0xDD</span> ,<span class="number">0xE5</span> ,<span class="number">0x65</span>,<span class="number">0x35</span> ,<span class="number">0xAD</span> ,<span class="number">0xA9</span> ,<span class="number">0xDC</span>,<span class="number">0x82</span> ,<span class="number">0xBB</span> ,<span class="number">0x00</span> ,<span class="number">0x53</span>,<span class="number">0xD1</span> ,<span class="number">0xA8</span> ,<span class="number">0x33</span> ,<span class="number">0xE9</span>,<span class="number">0x40</span> ,<span class="number">0x1A</span> ,<span class="number">0xFF</span> ,<span class="number">0xA1</span>,<span class="number">0x95</span> ,<span class="number">0x36</span> ,<span class="number">0xD9</span> ,<span class="number">0xEB</span>,<span class="number">0x89</span> ,<span class="number">0xE3</span> ,<span class="number">0x7C</span> ,<span class="number">0x73</span>,<span class="number">0x85</span> ,<span class="number">0x88</span> ,<span class="number">0x7A</span> ,<span class="number">0xE0</span>,<span class="number">0xFD</span> ,<span class="number">0x64</span> ,<span class="number">0x0C</span> ,<span class="number">0x57</span>,<span class="number">0x32</span> ,<span class="number">0xB3</span> ,<span class="number">0xB9</span> ,<span class="number">0x1F</span>,<span class="number">0xD7</span> ,<span class="number">0xFC</span> ,<span class="number">0x81</span> ,<span class="number">0xE1</span>,<span class="number">0x02</span> ,<span class="number">0xF9</span> ,<span class="number">0x5D</span> ,<span class="number">0x56</span>,<span class="number">0x6F</span> ,<span class="number">0x24</span>]</span><br><span class="line">v5=<span class="number">0</span></span><br><span class="line">v6=<span class="number">0</span></span><br><span class="line">xor=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    v5+=<span class="number">1</span></span><br><span class="line">    v5&amp;=<span class="number">0xff</span></span><br><span class="line">    v7=box[v5]</span><br><span class="line">    v6=(v6+v7)&amp;<span class="number">0xff</span></span><br><span class="line">    v8=box[v6]</span><br><span class="line">    box[v5]=v8</span><br><span class="line">    box[v6]=v7</span><br><span class="line">    xor.append(box[(v7+v8)&amp;<span class="number">0xff</span>])</span><br><span class="line">enc=[<span class="number">0x5A</span>, <span class="number">0x60</span>, <span class="number">0x54</span>, <span class="number">0x7A</span>, <span class="number">0x7A</span>, <span class="number">0x54</span>, <span class="number">0x72</span>, <span class="number">0x44</span>, <span class="number">0x7C</span>, <span class="number">0x66</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x5B</span>, <span class="number">0x5F</span>, <span class="number">0x56</span>, <span class="number">0x56</span>, <span class="number">0x4C</span>, <span class="number">0x7C</span>, <span class="number">0x79</span>, <span class="number">0x6E</span>, <span class="number">0x65</span>, <span class="number">0x55</span>, <span class="number">0x52</span>, <span class="number">0x79</span>, <span class="number">0x55</span>, <span class="number">0x6D</span>, <span class="number">0x46</span>, <span class="number">0x6B</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0x4A</span>, <span class="number">0x67</span>, <span class="number">0x4C</span>, <span class="number">0x61</span>, <span class="number">0x73</span>, <span class="number">0x4A</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x5A</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x52</span>, <span class="number">0x78</span>, <span class="number">0x49</span>, <span class="number">0x55</span>, <span class="number">0x6C</span>, <span class="number">0x48</span>, <span class="number">0x5C</span>, <span class="number">0x76</span>, <span class="number">0x5A</span>, <span class="number">0x45</span>,<span class="number">0x3d</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    enc[i]-=<span class="number">61</span></span><br><span class="line">f=[<span class="number">0</span>]*<span class="number">39</span></span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(enc),<span class="number">4</span>):</span><br><span class="line">    f[j]=(((enc[i]&amp;<span class="number">0x3f</span>)&lt;&lt;<span class="number">2</span>)|((enc[i+<span class="number">1</span>]&amp;<span class="number">0x3f</span>)&gt;&gt;<span class="number">4</span>))&amp;<span class="number">0xff</span></span><br><span class="line">    f[j+<span class="number">1</span>]=(((enc[i+<span class="number">1</span>])&lt;&lt;<span class="number">4</span>)|((enc[i+<span class="number">2</span>]&amp;<span class="number">0x3f</span>)&gt;&gt;<span class="number">2</span>))&amp;<span class="number">0xff</span></span><br><span class="line">    f[j+<span class="number">2</span>]=(((enc[i+<span class="number">2</span>])&lt;&lt;<span class="number">6</span>)|((enc[i+<span class="number">3</span>])&amp;<span class="number">0x3f</span>))&amp;<span class="number">0xff</span></span><br><span class="line">    j+=<span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(f)):</span><br><span class="line">    f[i]^=xor[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="GKCTF-2021-QQQQT"><a href="#GKCTF-2021-QQQQT" class="headerlink" title="[GKCTF 2021]QQQQT"></a>[GKCTF 2021]QQQQT</h2><p>感觉解包不解包好像差不多emmm？……<br>base58加密，我还以为跟base64一样的，呜呜呜，结果被教育了</p>
<h2 id="SCTF2019-babyre"><a href="#SCTF2019-babyre" class="headerlink" title="[SCTF2019]babyre"></a>[SCTF2019]babyre</h2><p>思想升华了属于是</p>
<p>修花指令，神tm，函数必须选中才能分析……（脏话</p>
<p>第一部分，第一次见三维迷宫，还是挺有意思的。出题人还是比较温柔，用的是<code>5*5*5</code>的迷宫，对我这种手解废物来说还是比较容易(x<br>x下一层，y上一层，手动走迷宫：ddwwxxssxaxwwaasasyywwdd</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">r&#x27;**************.****.**s..*..******.****.***********..***..**..#*..***..***.********************.**..*******..**...*..*.*.**.*&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(s))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">125</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">5</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">25</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    <span class="built_in">print</span>(s[i],end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>第二部分，神tm，逆算法逆了半天然后告诉我就是个base64……这咋看出来base64的啊……这base的码表不能这么长(zhang)吧……难道是另一种实现方式吗</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;sctf_9102&#x27;</span></span><br><span class="line">box=[<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span></span><br><span class="line">,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span></span><br><span class="line">,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x3E</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x3F</span></span><br><span class="line">,<span class="number">0x34</span>,<span class="number">0x35</span> ,<span class="number">0x36</span>,<span class="number">0x37</span>,<span class="number">0x38</span>,<span class="number">0x39</span> ,<span class="number">0x3A</span>,<span class="number">0x3B</span>,<span class="number">0x3C</span>,<span class="number">0x3D</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x40</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span></span><br><span class="line">,<span class="number">0x7F</span>, <span class="number">0</span> ,<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x03</span>,<span class="number">0x04</span> ,<span class="number">0x05</span>,<span class="number">0x06</span>,<span class="number">0x07</span>,<span class="number">0x08</span> ,<span class="number">0x09</span>,<span class="number">0x0A</span>,<span class="number">0x0B</span>,<span class="number">0x0C</span> ,<span class="number">0x0D</span>,<span class="number">0x0E</span></span><br><span class="line">,<span class="number">0x0F</span>,<span class="number">0x10</span> ,<span class="number">0x11</span>,<span class="number">0x12</span>,<span class="number">0x13</span>,<span class="number">0x14</span> ,<span class="number">0x15</span>,<span class="number">0x16</span>,<span class="number">0x17</span>,<span class="number">0x18</span> ,<span class="number">0x19</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span></span><br><span class="line">,<span class="number">0x7F</span>,<span class="number">0x1A</span> ,<span class="number">0x1B</span>,<span class="number">0x1C</span>,<span class="number">0x1D</span>,<span class="number">0x1E</span> ,<span class="number">0x1F</span>,<span class="number">0x20</span>,<span class="number">0x21</span>,<span class="number">0x22</span> ,<span class="number">0x23</span>,<span class="number">0x24</span>,<span class="number">0x25</span>,<span class="number">0x26</span> ,<span class="number">0x27</span>,<span class="number">0x28</span></span><br><span class="line">,<span class="number">0x29</span>,<span class="number">0x2A</span> ,<span class="number">0x2B</span>,<span class="number">0x2C</span>,<span class="number">0x2D</span>,<span class="number">0x2E</span> ,<span class="number">0x2F</span>,<span class="number">0x30</span>,<span class="number">0x31</span>,<span class="number">0x32</span> ,<span class="number">0x33</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span>,<span class="number">0x7F</span> ,<span class="number">0x7F</span>,<span class="number">0x7F</span>]</span><br><span class="line">f=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        f=<span class="built_in">ord</span>(s[i*<span class="number">3</span>+j])|(f&lt;&lt;<span class="number">8</span>)</span><br><span class="line">    dec=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    dec+=<span class="built_in">chr</span>(box.index((f&gt;&gt;<span class="number">18</span>)&amp;<span class="number">0x3f</span>))</span><br><span class="line">    dec+=<span class="built_in">chr</span>(box.index((f&gt;&gt;<span class="number">12</span>)&amp;<span class="number">0x3f</span>))</span><br><span class="line">    dec+=<span class="built_in">chr</span>(box.index((f&gt;&gt;<span class="number">6</span>)&amp;<span class="number">0x3f</span>))</span><br><span class="line">    dec+=<span class="built_in">chr</span>(box.index(f&amp;<span class="number">0x3f</span>))</span><br><span class="line">    <span class="built_in">print</span>(dec,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>第三部分，用了一个类似生成SM4轮密钥（去掉S盒）的过程，出题人还是很好心地换成了大端序(x 总之移位异或的过程是不用改变可以直接解密回来的，我刚开始竟然没看到循环，罪过罪过，又是改脚本改半年<br>我真是sb啊……写脚本的时候一直在想，加密过程是取四个中的第一个与后三个的加密结果异或，那解密的时候也应该异或一组里面的第一个。我真是sb啊……1和enc(2,3,4)生成5，那么解密肯定要用5来异或enc(2,3,4)才能产生1啊……也就是解密的异或应该用一组里的最后一个……我是什么sb，我自己爬呜呜呜</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rol</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> ((x&lt;&lt;y)|(x&gt;&gt;(<span class="number">32</span>-y)))&amp;<span class="number">0xffffffff</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ror</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> ((x&gt;&gt;y)|(x&lt;&lt;(<span class="number">32</span>-y)))&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> rol(x,<span class="number">12</span>)^rol(x,<span class="number">8</span>)^ror(x,<span class="number">2</span>)^ror(x,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub</span>(<span class="params">x</span>):</span><br><span class="line">    t1=box[x&amp;<span class="number">0xff</span>]</span><br><span class="line">    t2=box[(x&amp;<span class="number">0xff00</span>)&gt;&gt;<span class="number">8</span>]</span><br><span class="line">    t3=box[(x&amp;<span class="number">0xff0000</span>)&gt;&gt;<span class="number">16</span>]</span><br><span class="line">    t4=box[(x&amp;<span class="number">0xff000000</span>)&gt;&gt;<span class="number">24</span>]</span><br><span class="line">    v=t1|(t2&lt;&lt;<span class="number">8</span>)|(t3&lt;&lt;<span class="number">16</span>)|(t4&lt;&lt;<span class="number">24</span>)</span><br><span class="line">    <span class="keyword">return</span> enc(v)</span><br><span class="line"></span><br><span class="line">box=[<span class="number">0xD6</span> ,<span class="number">0x90</span>  ,<span class="number">0xE9</span> ,<span class="number">0xFE</span>,<span class="number">0xCC</span> ,<span class="number">0xE1</span>  ,<span class="number">0x3D</span> ,<span class="number">0xB7</span>,<span class="number">0x16</span> ,<span class="number">0xB6</span>  ,<span class="number">0x14</span> ,<span class="number">0xC2</span>,<span class="number">0x28</span> ,<span class="number">0xFB</span>  ,<span class="number">0x2C</span> ,<span class="number">0x05</span>,<span class="number">0x2B</span> ,<span class="number">0x67</span>  ,<span class="number">0x9A</span> ,<span class="number">0x76</span>,<span class="number">0x2A</span> ,<span class="number">0xBE</span>  ,<span class="number">0x04</span> ,<span class="number">0xC3</span>,<span class="number">0xAA</span> ,<span class="number">0x44</span>  ,<span class="number">0x13</span> ,<span class="number">0x26</span>,<span class="number">0x49</span> ,<span class="number">0x86</span>  ,<span class="number">0x06</span> ,<span class="number">0x99</span>,<span class="number">0x9C</span> ,<span class="number">0x42</span>  ,<span class="number">0x50</span> ,<span class="number">0xF4</span>,<span class="number">0x91</span> ,<span class="number">0xEF</span>  ,<span class="number">0x98</span> ,<span class="number">0x7A</span>,<span class="number">0x33</span> ,<span class="number">0x54</span>  ,<span class="number">0x0B</span> ,<span class="number">0x43</span>,<span class="number">0xED</span> ,<span class="number">0xCF</span>  ,<span class="number">0xAC</span> ,<span class="number">0x62</span>,<span class="number">0xE4</span> ,<span class="number">0xB3</span>  ,<span class="number">0x1C</span> ,<span class="number">0xA9</span>,<span class="number">0xC9</span> ,<span class="number">0x08</span>  ,<span class="number">0xE8</span> ,<span class="number">0x95</span>,<span class="number">0x80</span> ,<span class="number">0xDF</span>  ,<span class="number">0x94</span> ,<span class="number">0xFA</span>,<span class="number">0x75</span> ,<span class="number">0x8F</span>  ,<span class="number">0x3F</span> ,<span class="number">0xA6</span>,<span class="number">0x47</span> ,<span class="number">0x07</span>  ,<span class="number">0xA7</span> ,<span class="number">0xFC</span>,<span class="number">0xF3</span> ,<span class="number">0x73</span>  ,<span class="number">0x17</span> ,<span class="number">0xBA</span>,<span class="number">0x83</span> ,<span class="number">0x59</span>  ,<span class="number">0x3C</span> ,<span class="number">0x19</span>,<span class="number">0xE6</span> ,<span class="number">0x85</span>  ,<span class="number">0x4F</span> ,<span class="number">0xA8</span>,<span class="number">0x68</span> ,<span class="number">0x6B</span>  ,<span class="number">0x81</span> ,<span class="number">0xB2</span>,<span class="number">0x71</span> ,<span class="number">0x64</span>  ,<span class="number">0xDA</span> ,<span class="number">0x8B</span>,<span class="number">0xF8</span> ,<span class="number">0xEB</span>  ,<span class="number">0x0F</span> ,<span class="number">0x4B</span>,<span class="number">0x70</span> ,<span class="number">0x56</span>  ,<span class="number">0x9D</span> ,<span class="number">0x35</span>,<span class="number">0x1E</span> ,<span class="number">0x24</span>  ,<span class="number">0x0E</span> ,<span class="number">0x5E</span>,<span class="number">0x63</span> ,<span class="number">0x58</span>  ,<span class="number">0xD1</span> ,<span class="number">0xA2</span>,<span class="number">0x25</span> ,<span class="number">0x22</span>  ,<span class="number">0x7C</span> ,<span class="number">0x3B</span>,<span class="number">0x01</span> ,<span class="number">0x21</span>  ,<span class="number">0x78</span> ,<span class="number">0x87</span>,<span class="number">0xD4</span> ,<span class="number">0</span>     ,<span class="number">0x46</span> ,<span class="number">0x57</span>,<span class="number">0x9F</span> ,<span class="number">0xD3</span>  ,<span class="number">0x27</span> ,<span class="number">0x52</span>,<span class="number">0x4C</span> ,<span class="number">0x36</span>  ,<span class="number">0x02</span> ,<span class="number">0xE7</span>,<span class="number">0xA0</span> ,<span class="number">0xC4</span>  ,<span class="number">0xC8</span> ,<span class="number">0x9E</span>,<span class="number">0xEA</span> ,<span class="number">0xBF</span>  ,<span class="number">0x8A</span> ,<span class="number">0xD2</span>,<span class="number">0x40</span> ,<span class="number">0xC7</span>  ,<span class="number">0x38</span> ,<span class="number">0xB5</span>,<span class="number">0xA3</span> ,<span class="number">0xF7</span>  ,<span class="number">0xF2</span> ,<span class="number">0xCE</span>,<span class="number">0xF9</span> ,<span class="number">0x61</span>  ,<span class="number">0x15</span> ,<span class="number">0xA1</span>,<span class="number">0xE0</span> ,<span class="number">0xAE</span>  ,<span class="number">0x5D</span> ,<span class="number">0xA4</span>,<span class="number">0x9B</span> ,<span class="number">0x34</span>  ,<span class="number">0x1A</span> ,<span class="number">0x55</span>,<span class="number">0xAD</span> ,<span class="number">0x93</span>  ,<span class="number">0x32</span> ,<span class="number">0x30</span>,<span class="number">0xF5</span> ,<span class="number">0x8C</span>  ,<span class="number">0xB1</span> ,<span class="number">0xE3</span>,<span class="number">0x1D</span> ,<span class="number">0xF6</span>  ,<span class="number">0xE2</span> ,<span class="number">0x2E</span>,<span class="number">0x82</span> ,<span class="number">0x66</span>  ,<span class="number">0xCA</span> ,<span class="number">0x60</span>,<span class="number">0xC0</span> ,<span class="number">0x29</span>  ,<span class="number">0x23</span> ,<span class="number">0xAB</span>,<span class="number">0x0D</span> ,<span class="number">0x53</span>  ,<span class="number">0x4E</span> ,<span class="number">0x6F</span>,<span class="number">0xD5</span> ,<span class="number">0xDB</span>  ,<span class="number">0x37</span> ,<span class="number">0x45</span>,<span class="number">0xDE</span> ,<span class="number">0xFD</span>  ,<span class="number">0x8E</span> ,<span class="number">0x2F</span>,<span class="number">0x03</span> ,<span class="number">0xFF</span>  ,<span class="number">0x6A</span> ,<span class="number">0x72</span>,<span class="number">0x6D</span> ,<span class="number">0x6C</span>  ,<span class="number">0x5B</span> ,<span class="number">0x51</span>,<span class="number">0x8D</span> ,<span class="number">0x1B</span>  ,<span class="number">0xAF</span> ,<span class="number">0x92</span>,<span class="number">0xBB</span> ,<span class="number">0xDD</span>  ,<span class="number">0xBC</span> ,<span class="number">0x7F</span>,<span class="number">0x11</span> ,<span class="number">0xD9</span>  ,<span class="number">0x5C</span> ,<span class="number">0x41</span>,<span class="number">0x1F</span> ,<span class="number">0x10</span>  ,<span class="number">0x5A</span> ,<span class="number">0xD8</span>,<span class="number">0x0A</span> ,<span class="number">0xC1</span>  ,<span class="number">0x31</span> ,<span class="number">0x88</span>,<span class="number">0xA5</span> ,<span class="number">0xCD</span>  ,<span class="number">0x7B</span> ,<span class="number">0xBD</span>,<span class="number">0x2D</span> ,<span class="number">0x74</span>  ,<span class="number">0xD0</span> ,<span class="number">0x12</span>,<span class="number">0xB8</span> ,<span class="number">0xE5</span>  ,<span class="number">0xB4</span> ,<span class="number">0xB0</span>,<span class="number">0x89</span> ,<span class="number">0x69</span>  ,<span class="number">0x97</span> ,<span class="number">0x4A</span>,<span class="number">0x0C</span> ,<span class="number">0x96</span>  ,<span class="number">0x77</span> ,<span class="number">0x7E</span>,<span class="number">0x65</span> ,<span class="number">0xB9</span>  ,<span class="number">0xF1</span> ,<span class="number">0x09</span>,<span class="number">0xC5</span> ,<span class="number">0x6E</span>  ,<span class="number">0xC6</span> ,<span class="number">0x84</span>,<span class="number">0x18</span> ,<span class="number">0xF0</span>  ,<span class="number">0x7D</span> ,<span class="number">0xEC</span>,<span class="number">0x3A</span> ,<span class="number">0xDC</span>  ,<span class="number">0x4D</span> ,<span class="number">0x20</span>,<span class="number">0x79</span> ,<span class="number">0xEE</span>  ,<span class="number">0x5F</span> ,<span class="number">0x3E</span>,<span class="number">0xD7</span> ,<span class="number">0xCB</span>  ,<span class="number">0x39</span> ,<span class="number">0x48</span>,<span class="number">0xC6</span> ,<span class="number">0xBA</span>  ,<span class="number">0xB1</span> ,<span class="number">0xA3</span>,<span class="number">0x50</span> ,<span class="number">0x33</span>  ,<span class="number">0xAA</span> ,<span class="number">0x56</span>,<span class="number">0x97</span> ,<span class="number">0x91</span>  ,<span class="number">0x7D</span> ,<span class="number">0x67</span>,<span class="number">0xDC</span> ,<span class="number">0x22</span>  ,<span class="number">0x70</span> ,<span class="number">0xB2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">cmp=[<span class="number">0</span>]*<span class="number">26</span>+[<span class="number">0xbe040680</span>,<span class="number">0xc5af7647</span>,<span class="number">0x9fcc401f</span>,<span class="number">0xd8bf92ef</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    cmp[k]=cmp[k+<span class="number">4</span>]^sub(cmp[k+<span class="number">1</span>]^cmp[k+<span class="number">2</span>]^cmp[k+<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    s+=<span class="built_in">chr</span>(cmp[i]&amp;<span class="number">0xff</span>)</span><br><span class="line">    s+=<span class="built_in">chr</span>((cmp[i]&amp;<span class="number">0xff00</span>)&gt;&gt;<span class="number">8</span>)</span><br><span class="line">    s+=<span class="built_in">chr</span>((cmp[i]&amp;<span class="number">0xff0000</span>)&gt;&gt;<span class="number">16</span>)</span><br><span class="line">    s+=<span class="built_in">chr</span>((cmp[i]&amp;<span class="number">0xff000000</span>)&gt;&gt;<span class="number">24</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="WMCTF2020-easy-re"><a href="#WMCTF2020-easy-re" class="headerlink" title="[WMCTF2020]easy_re"></a>[WMCTF2020]easy_re</h2><p>好奇怪的题</p>
<h2 id="SCTF2019-Strange-apk"><a href="#SCTF2019-Strange-apk" class="headerlink" title="[SCTF2019]Strange apk"></a>[SCTF2019]Strange apk</h2><p>安卓，8会，爬了</p>
<h2 id="2019红帽杯-Snake"><a href="#2019红帽杯-Snake" class="headerlink" title="[2019红帽杯]Snake"></a>[2019红帽杯]Snake</h2><p>好怪的题，再看一眼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">baopo</span>(<span class="params">i</span>):</span><br><span class="line">    dll = ctypes.cdll.LoadLibrary(<span class="string">&quot;D:\\code\\python\\Interface.dll&quot;</span>)<span class="comment">#进入interface.dll这个文件</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    dll.GameObject(i)<span class="comment">#调用GameObject（）这个函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):<span class="comment">#从0~99开始爆破</span></span><br><span class="line">    baopo(i)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="SCTF2019-creakme"><a href="#SCTF2019-creakme" class="headerlink" title="[SCTF2019]creakme"></a>[SCTF2019]creakme</h2><p><a target="_blank" rel="noopener" href="https://github.com/0xE4s0n/creakme_sctf2019/blob/master/creakme/creakme.cpp">源码</a><br><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-268988.htm">windows调试附加</a></p>
<p>看懂SEH之后写篇博客……现在只是在track神的指导下调出来那段SMC了，呜呜，还是太菜了。<br>基本上我现在是大概能够理解，SEH之所以经常作为反调试的手段，因为它在调试状态下不会被运行的，而且catch段的代码不会被ida反编译出来。这个题里正好就是SMC那一段没有反编译出来，所以突然return一段乱码数据还挺诡异的……(bushi)而其实是那段数据先被SMC，然后再作为函数被调用。<br>要调试SEH里的代码，必须先找到catch块，然后手动改EIP跳转到相应地址。之前问track神怎么找catch块，他回答在汇编里嗯翻……cao……<br>前几天看《逆向工程核心原理》，好像可以在FS寄存器指向的寄存器里找到TEB的地址，然后固定偏移的地方有存SEH链表的地址，学习ing……</p>
<p>SMC解密部分代码对密文加密后的还原：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;&gt;pvfqYc,4tTc2UxRmlJ,sB&#123;Fh4Ck2:CFOb4ErhtIcoLo&#x27;</span></span><br><span class="line">new=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    new+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(new[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p>AES解密部分：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">key=<span class="string">b&quot;sycloversyclover&quot;</span></span><br><span class="line">iv=<span class="string">b&quot;sctfsctfsctfsctf&quot;</span></span><br><span class="line">cipher=base64.b64decode(<span class="string">&quot;nKnbHsgqD3aNEB91jB3gEzAr+IklQwT1bSs3+bXpeuo=&quot;</span>)</span><br><span class="line">aes=AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line"><span class="built_in">print</span>(aes.decrypt(cipher))</span><br></pre></td></tr></table></figure>

<h2 id="SCTF2019-Who-is-he"><a href="#SCTF2019-Who-is-he" class="headerlink" title="[SCTF2019]Who is he"></a>[SCTF2019]Who is he</h2><h2 id="CISCN2018-2ex"><a href="#CISCN2018-2ex" class="headerlink" title="[CISCN2018]2ex"></a>[CISCN2018]2ex</h2><p>白给……</p>
<h2 id="watevrCTF-2019-Timeout"><a href="#watevrCTF-2019-Timeout" class="headerlink" title="[watevrCTF 2019]Timeout"></a>[watevrCTF 2019]Timeout</h2><p>明文字符串……</p>
<h2 id="FlareOn2-very-success"><a href="#FlareOn2-very-success" class="headerlink" title="[FlareOn2]very_success"></a>[FlareOn2]very_success</h2><p>太黑了……</p>
<figure class="highlight c"><figcaption><span>&#123;.line-numbers&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __usercall sub_401084@&lt;eax&gt;(<span class="type">int</span> result@&lt;eax&gt;, <span class="type">int</span> a2, <span class="type">char</span> *a3, <span class="type">int</span> a4)</span><br><span class="line">&#123;</span><br><span class="line">  __int16 v4; <span class="comment">// bx</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  _BYTE *v7; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">char</span> enc; <span class="comment">// al</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// kr00_4</span></span><br><span class="line">  <span class="type">char</span> enc1; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// cf</span></span><br><span class="line">  __int16 v12; <span class="comment">// ax</span></span><br><span class="line">  <span class="type">bool</span> v13; <span class="comment">// zf</span></span><br><span class="line">  _BYTE *v14; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> xor; <span class="comment">// [esp+0h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">37</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a4 &gt;= <span class="number">37</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = (_BYTE *)(a2 + <span class="number">36</span>);</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      LOWORD(result) = <span class="number">0x1C7</span>;</span><br><span class="line">      xor = result;</span><br><span class="line">      enc = *a3++;</span><br><span class="line">      v9 = __readeflags();</span><br><span class="line">      enc1 = xor ^ enc;</span><br><span class="line">      __writeeflags(v9);</span><br><span class="line">      v12 = (<span class="type">unsigned</span> __int8)(__ROL1__(<span class="number">1</span>, v4 &amp; <span class="number">3</span>) + v11 + enc1);</span><br><span class="line">      v4 += v12;</span><br><span class="line">      v13 = *v7 == (<span class="type">unsigned</span> __int8)v12;</span><br><span class="line">      v14 = v7 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( !v13 )</span><br><span class="line">        LOWORD(v5) = <span class="number">0</span>;</span><br><span class="line">      result = xor;</span><br><span class="line">      <span class="keyword">if</span> ( !v5 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v7 = v14 - <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">if</span> ( !--v5 )</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意第19行是<code>v7 = (_BYTE *)(a2 + 36);</code>，也就是把v2[36]赋给v7，此后与v7赋值有关的操作分别是<code>v14 = v7 + 1;</code>和<code>v7 = v14 - 2;</code>，等价于<code>v7-=1</code>，也就是从后往前比较的。<br>算法很好逆，地址动调一下也能找到，不知道当时为什么没写，可能看到一坨浆糊的代码脑子就不好使了吧hhhhhh</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">v7=[<span class="number">0xAF</span>, <span class="number">0xAA</span>, <span class="number">0xAD</span>, <span class="number">0xEB</span>, <span class="number">0xAE</span>, <span class="number">0xAA</span>, <span class="number">0xEC</span>, <span class="number">0xA4</span>, <span class="number">0xBA</span>, <span class="number">0xAF</span>, </span><br><span class="line">  <span class="number">0xAE</span>, <span class="number">0xAA</span>, <span class="number">0x8A</span>, <span class="number">0xC0</span>, <span class="number">0xA7</span>, <span class="number">0xB0</span>, <span class="number">0xBC</span>, <span class="number">0x9A</span>, <span class="number">0xBA</span>, <span class="number">0xA5</span>, </span><br><span class="line">  <span class="number">0xA5</span>, <span class="number">0xBA</span>, <span class="number">0xAF</span>, <span class="number">0xB8</span>, <span class="number">0x9D</span>, <span class="number">0xB8</span>, <span class="number">0xF9</span>, <span class="number">0xAE</span>, <span class="number">0x9D</span>, <span class="number">0xAB</span>, </span><br><span class="line">  <span class="number">0xB4</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xB3</span>, <span class="number">0x90</span>, <span class="number">0x9A</span>, <span class="number">0xA8</span>]</span><br><span class="line">v4=<span class="number">0</span></span><br><span class="line">f=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v7)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    rol=((<span class="number">1</span>&lt;&lt;(v4&amp;<span class="number">3</span>))|(<span class="number">1</span>&gt;&gt;(<span class="number">8</span>-(v4&amp;<span class="number">3</span>))))&amp;<span class="number">0xff</span></span><br><span class="line">    f+=<span class="built_in">chr</span>((v7[i]-rol-<span class="number">1</span>)^<span class="number">0xc7</span>)</span><br><span class="line">    v4+=v7[i]</span><br><span class="line">    v4&amp;=<span class="number">0xff</span></span><br><span class="line"><span class="built_in">print</span>(f)</span><br></pre></td></tr></table></figure>

<h2 id="网鼎杯-2020-青龙组-bang"><a href="#网鼎杯-2020-青龙组-bang" class="headerlink" title="[网鼎杯 2020 青龙组]bang"></a>[网鼎杯 2020 青龙组]bang</h2><p>下了一堆安卓脱壳的软件不会用，还有模拟器什么的，网上的教程都有亿点简略……最后开谷歌搜到了<a target="_blank" rel="noopener" href="https://github.com/CodingGay/BlackDex/releases">BlackDex</a>这玩意，下在手机上直接脱壳了 <del>不就是懒得装模拟器</del></p>
<p>脱壳完之后是几个文件，也不知道逆哪个，readme里也没写咋用……麻了啊<br>我根据我对于apk的朴素认知猜测了一下，新建文件夹，把脱壳产生的几个文件丢进去，然后打成压缩包，后缀改成apk，放进jadx里反编译搜字符串，成功~</p>
<h2 id="SUCTF2018-babyre"><a href="#SUCTF2018-babyre" class="headerlink" title="[SUCTF2018]babyre"></a>[SUCTF2018]babyre</h2><p>刚开始写脚本每次没有把v6清零导致每次运算都带上次结果，所以怎么也跑不出来，呜呜呜<br>每次新的循环赋值一定要把之前的内容清零啊啊喂<br>还有就是看着tqdm真是个好东西啊哈哈哈，省去了等待的不安</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">v4=[<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">16</span>,<span class="number">19</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">20</span>,<span class="number">23</span>,<span class="number">22</span>,<span class="number">19</span>,<span class="number">28</span>,<span class="number">25</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">28</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">31</span>]</span><br><span class="line">v5=[<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;$!\&quot;&#x27;$!\&quot;#().+$-&amp;/81:;4=&gt;7092;&lt;567HIBBDDFGHIJJMMONPPRSUTVWYYZ[\\]^^``ccdeggiikklmnnpprstuwwxy&#123;&#123;&#125;&#125;&quot;</span>]+[<span class="number">0</span>]*<span class="number">60</span></span><br><span class="line">v5[<span class="number">94</span>] = <span class="number">127</span></span><br><span class="line">v5[<span class="number">95</span>] = <span class="number">127</span></span><br><span class="line">v5[<span class="number">96</span>] = <span class="number">0x81</span></span><br><span class="line">v5[<span class="number">97</span>] = <span class="number">0x81</span></span><br><span class="line">v5[<span class="number">98</span>] = <span class="number">0x83</span></span><br><span class="line">v5[<span class="number">99</span>] = <span class="number">0x83</span></span><br><span class="line">v5[<span class="number">100</span>] = <span class="number">0x8C</span></span><br><span class="line">v5[<span class="number">101</span>] = <span class="number">0x8D</span></span><br><span class="line">v5[<span class="number">102</span>] = <span class="number">0x8E</span></span><br><span class="line">v5[<span class="number">103</span>] = <span class="number">0x8F</span></span><br><span class="line">v5[<span class="number">104</span>] = <span class="number">0x88</span></span><br><span class="line">v5[<span class="number">105</span>] = <span class="number">0x89</span></span><br><span class="line">v5[<span class="number">106</span>] = <span class="number">0x8A</span></span><br><span class="line">v5[<span class="number">107</span>] = <span class="number">0x8B</span></span><br><span class="line">v5[<span class="number">108</span>] = <span class="number">0x8C</span></span><br><span class="line">v5[<span class="number">109</span>] = <span class="number">0x8D</span></span><br><span class="line">v5[<span class="number">110</span>] = <span class="number">0x8E</span></span><br><span class="line">v5[<span class="number">111</span>] = <span class="number">0x87</span></span><br><span class="line">v5[<span class="number">112</span>] = <span class="number">0x98</span></span><br><span class="line">v5[<span class="number">113</span>] = <span class="number">0x91</span></span><br><span class="line">v5[<span class="number">114</span>] = <span class="number">0x92</span></span><br><span class="line">v5[<span class="number">115</span>] = <span class="number">0x93</span></span><br><span class="line">v5[<span class="number">116</span>] = <span class="number">0x94</span></span><br><span class="line">v5[<span class="number">117</span>] = <span class="number">0x95</span></span><br><span class="line">v5[<span class="number">118</span>] = <span class="number">0x96</span></span><br><span class="line">v5[<span class="number">119</span>] = <span class="number">0x97</span></span><br><span class="line">v5[<span class="number">120</span>] = <span class="number">0x98</span></span><br><span class="line">v5[<span class="number">121</span>] = <span class="number">0x99</span></span><br><span class="line">v5[<span class="number">122</span>] = <span class="number">0x9A</span></span><br><span class="line">v5[<span class="number">123</span>] = <span class="number">0x9A</span></span><br><span class="line">v5[<span class="number">124</span>] = <span class="number">0x9C</span></span><br><span class="line">v5[<span class="number">125</span>] = <span class="number">0x9C</span></span><br><span class="line">v5[<span class="number">126</span>] = <span class="number">0x9E</span></span><br><span class="line">v5[<span class="number">127</span>] = <span class="number">0x9E</span></span><br><span class="line">v5[<span class="number">128</span>] = <span class="number">0xA0</span></span><br><span class="line">v5[<span class="number">129</span>] = <span class="number">160</span></span><br><span class="line">v5[<span class="number">130</span>] = <span class="number">0xA2</span></span><br><span class="line">v5[<span class="number">131</span>] = <span class="number">0xA2</span></span><br><span class="line">v5[<span class="number">132</span>] = <span class="number">0xA4</span></span><br><span class="line">v5[<span class="number">133</span>] = <span class="number">0xA4</span></span><br><span class="line">v5[<span class="number">134</span>] = <span class="number">0xA6</span></span><br><span class="line">v5[<span class="number">135</span>] = <span class="number">0xA6</span></span><br><span class="line">v5[<span class="number">136</span>] = <span class="number">0xA8</span></span><br><span class="line">v5[<span class="number">137</span>] = <span class="number">0xA8</span></span><br><span class="line">v5[<span class="number">138</span>] = <span class="number">0xAA</span></span><br><span class="line">v5[<span class="number">139</span>] = <span class="number">0xAA</span></span><br><span class="line">v5[<span class="number">140</span>] = <span class="number">0xAC</span></span><br><span class="line">v5[<span class="number">141</span>] = <span class="number">0xAC</span></span><br><span class="line">v5[<span class="number">142</span>] = <span class="number">0xAE</span></span><br><span class="line">v5[<span class="number">143</span>] = <span class="number">0xAE</span></span><br><span class="line">v5[<span class="number">144</span>] = <span class="number">0xB0</span></span><br><span class="line">v5[<span class="number">145</span>] = <span class="number">0xB1</span></span><br><span class="line">v5[<span class="number">146</span>] = <span class="number">0xB2</span></span><br><span class="line">v5[<span class="number">147</span>] = <span class="number">0xB3</span></span><br><span class="line">v=v4+v5</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> trange(<span class="number">0x10000</span>):</span><br><span class="line">    i=<span class="number">8</span></span><br><span class="line">    v6=[<span class="number">0</span>]*<span class="number">100</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        i-=<span class="number">1</span></span><br><span class="line">        j=<span class="number">22</span></span><br><span class="line">        <span class="keyword">while</span> j!=<span class="number">0</span>:</span><br><span class="line">            v9=v[<span class="number">22</span>*i+j-<span class="number">1</span>]</span><br><span class="line">            j-=<span class="number">1</span></span><br><span class="line">            v10=(v9&gt;&gt;((key&gt;&gt;(<span class="number">2</span>*i))&amp;<span class="number">3</span>))&amp;<span class="number">1</span></span><br><span class="line">            v6[j]|=v10&lt;&lt;i</span><br><span class="line">            v6[j]&amp;=<span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> v6[<span class="number">0</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;S&#x27;</span>) <span class="keyword">and</span> v6[<span class="number">1</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;U&#x27;</span>) <span class="keyword">and</span> v6[<span class="number">2</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>) <span class="keyword">and</span> v6[<span class="number">3</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;T&#x27;</span>) <span class="keyword">and</span> v6[<span class="number">4</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;F&#x27;</span>) <span class="keyword">and</span> v6[<span class="number">5</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> v6:</span><br><span class="line">    <span class="keyword">if</span> f==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(f),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="MRCTF2020-EasyCpp"><a href="#MRCTF2020-EasyCpp" class="headerlink" title="[MRCTF2020]EasyCpp"></a>[MRCTF2020]EasyCpp</h2><p>C++代码真滴丑……<br>异或1，然后分解质因数，把质因数从小到大拼接起来，中间用空格（后面换成等号）就是密文。为了方便，手动把最前面的等号删了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">s=[]</span><br><span class="line">s.append(<span class="string">&#x27;zqE=z=z=z&#x27;</span>)</span><br><span class="line">s.append(<span class="string">&#x27;lzzE&#x27;</span>)</span><br><span class="line">s.append(<span class="string">&#x27;ll=T=s=s=E&#x27;</span>)</span><br><span class="line">s.append(<span class="string">&#x27;zATT&#x27;</span>)</span><br><span class="line">s.append(<span class="string">&#x27;s=s=s=E=E=E&#x27;</span>)</span><br><span class="line">s.append(<span class="string">&#x27;EOll=E&#x27;</span>)</span><br><span class="line">s.append(<span class="string">&#x27;lE=T=E=E=E&#x27;</span>)</span><br><span class="line">s.append(<span class="string">&#x27;EsE=s=z&#x27;</span>)</span><br><span class="line">s.append(<span class="string">&#x27;AT=lE=ll&#x27;</span>)</span><br><span class="line">f=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    i=i.replace(<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    i=i.replace(<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    i=i.replace(<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    i=i.replace(<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    i=i.replace(<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    i=i.replace(<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">    i=i.replace(<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;6&#x27;</span>)</span><br><span class="line">    i=i.replace(<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;7&#x27;</span>)</span><br><span class="line">    i=i.replace(<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;8&#x27;</span>)</span><br><span class="line">    i=i.replace(<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    t=i.split(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    num=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> t:</span><br><span class="line">        num*=<span class="built_in">int</span>(j)</span><br><span class="line">    f+=<span class="built_in">str</span>(num^<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(f.encode()).hexdigest().swapcase())</span><br></pre></td></tr></table></figure>

<h2 id="Dig-the-way"><a href="#Dig-the-way" class="headerlink" title="Dig the way"></a>Dig the way</h2><p>pwn题，8会（逃</p>
<h2 id="羊城杯-2020-Bytecode"><a href="#羊城杯-2020-Bytecode" class="headerlink" title="[羊城杯 2020]Bytecode"></a>[羊城杯 2020]Bytecode</h2><p>属于是体力活</p>
<h2 id="HDCTF2019-MFC"><a href="#HDCTF2019-MFC" class="headerlink" title="[HDCTF2019]MFC"></a>[HDCTF2019]MFC</h2><p>MFC，8会(bushi</p>
<h2 id="ACTF新生赛2020-Splendid-MineCraft"><a href="#ACTF新生赛2020-Splendid-MineCraft" class="headerlink" title="[ACTF新生赛2020]Splendid_MineCraft"></a>[ACTF新生赛2020]Splendid_MineCraft</h2><p>两个SMC，又忘了异或的运算优先级比加法低，被折磨N年……<br><del>这个题真的做的想死……</del> 第一步还好说，第二步动调的时候不知道IDA为啥SMC老出不来，然后又破罐子破摔试了几次居然又可以了emmmm <del>不知道到底是什么问题，我不就把F8换成F7了吗……</del> SMC调好之后的汇编代码反编译出来也是一言难尽，还不如硬刚汇编……其实真的去看汇编也没想象中那么难懂emmm，还是克服一下畏惧吧。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">box=[</span><br><span class="line"><span class="number">0xF6</span>,<span class="number">0xA3</span>,<span class="number">0x5B</span>,<span class="number">0x9D</span>,<span class="number">0xE0</span>,<span class="number">0x95</span>,<span class="number">0x98</span>,<span class="number">0x68</span></span><br><span class="line">,<span class="number">0x8C</span>,<span class="number">0x65</span>,<span class="number">0xBB</span>,<span class="number">0x76</span>,<span class="number">0x89</span>,<span class="number">0xD4</span>,<span class="number">0x09</span>,<span class="number">0xFD</span>,<span class="number">0xF3</span>,<span class="number">0x5C</span>,<span class="number">0x3C</span>,<span class="number">0x4C</span>,<span class="number">0x36</span>,<span class="number">0x8E</span>,<span class="number">0x4D</span>,<span class="number">0xC4</span></span><br><span class="line">,<span class="number">0x80</span>,<span class="number">0x44</span>,<span class="number">0xD6</span>,<span class="number">0xA9</span>,<span class="number">0x01</span>,<span class="number">0x32</span>,<span class="number">0x77</span>,<span class="number">0x29</span>,<span class="number">0x90</span>,<span class="number">0xBC</span>,<span class="number">0xC0</span>,<span class="number">0xA8</span>,<span class="number">0xD8</span>,<span class="number">0xF9</span>,<span class="number">0xE1</span>,<span class="number">0x1D</span></span><br><span class="line">,<span class="number">0xE4</span>,<span class="number">0x67</span>,<span class="number">0x7D</span>,<span class="number">0x2A</span>,<span class="number">0x2C</span>,<span class="number">0x59</span>,<span class="number">0x9E</span>,<span class="number">0x3D</span>,<span class="number">0x7A</span>,<span class="number">0x34</span>,<span class="number">0x11</span>,<span class="number">0x43</span>,<span class="number">0x74</span>,<span class="number">0xD1</span>,<span class="number">0x62</span>,<span class="number">0x60</span></span><br><span class="line">,<span class="number">0x02</span>,<span class="number">0x4B</span>,<span class="number">0xAE</span>,<span class="number">0x99</span>,<span class="number">0x57</span>,<span class="number">0xC6</span>,<span class="number">0x73</span>,<span class="number">0xB0</span>,<span class="number">0x33</span>,<span class="number">0x18</span>,<span class="number">0x2B</span>,<span class="number">0xFE</span>,<span class="number">0xB9</span>,<span class="number">0x85</span>,<span class="number">0xB6</span>,<span class="number">0xD9</span></span><br><span class="line">,<span class="number">0xDE</span>,<span class="number">0x7B</span>,<span class="number">0xCF</span>,<span class="number">0x4F</span>,<span class="number">0xB3</span>,<span class="number">0xD5</span>,<span class="number">0x08</span>,<span class="number">0x7C</span>,<span class="number">0x0A</span>,<span class="number">0x71</span>,<span class="number">0x12</span>,<span class="number">0x06</span>,<span class="number">0x37</span>,<span class="number">0xFF</span>,<span class="number">0x7F</span>,<span class="number">0xB7</span></span><br><span class="line">,<span class="number">0x46</span>,<span class="number">0x42</span>,<span class="number">0x25</span>,<span class="number">0xC9</span>,<span class="number">0xD0</span>,<span class="number">0x50</span>,<span class="number">0x52</span>,<span class="number">0xCE</span>,<span class="number">0xBD</span>,<span class="number">0x6C</span>,<span class="number">0xE5</span>,<span class="number">0x6F</span>,<span class="number">0xA5</span>,<span class="number">0x15</span>,<span class="number">0xED</span>,<span class="number">0x64</span></span><br><span class="line">,<span class="number">0xF0</span>,<span class="number">0x23</span>,<span class="number">0x35</span>,<span class="number">0xE7</span>,<span class="number">0x0C</span>,<span class="number">0x61</span>,<span class="number">0xA4</span>,<span class="number">0xD7</span>,<span class="number">0x51</span>,<span class="number">0x75</span>,<span class="number">0x9A</span>,<span class="number">0xF2</span>,<span class="number">0x1E</span>,<span class="number">0xEB</span>,<span class="number">0x58</span>,<span class="number">0xF1</span></span><br><span class="line">,<span class="number">0x94</span>,<span class="number">0xC3</span>,<span class="number">0x2F</span>,<span class="number">0x56</span>,<span class="number">0xF7</span>,<span class="number">0xE6</span>,<span class="number">0x86</span>,<span class="number">0x47</span>,<span class="number">0xFB</span>,<span class="number">0x83</span>,<span class="number">0x5E</span>,<span class="number">0xCC</span>,<span class="number">0x21</span>,<span class="number">0x4A</span>,<span class="number">0x24</span>,<span class="number">0x07</span></span><br><span class="line">,<span class="number">0x1C</span>,<span class="number">0x8A</span>,<span class="number">0x5A</span>,<span class="number">0x17</span>,<span class="number">0x1B</span>,<span class="number">0xDA</span>,<span class="number">0xEC</span>,<span class="number">0x38</span>,<span class="number">0x0E</span>,<span class="number">0x7E</span>,<span class="number">0xB4</span>,<span class="number">0x48</span>,<span class="number">0x88</span>,<span class="number">0xF4</span>,<span class="number">0xB8</span>,<span class="number">0x27</span></span><br><span class="line">,<span class="number">0x91</span>,<span class="number">0x00</span>,<span class="number">0x13</span>,<span class="number">0x97</span>,<span class="number">0xBE</span>,<span class="number">0x53</span>,<span class="number">0xC2</span>,<span class="number">0xE8</span>,<span class="number">0xEA</span>,<span class="number">0x1A</span>,<span class="number">0xE9</span>,<span class="number">0x2D</span>,<span class="number">0x14</span>,<span class="number">0x0B</span>,<span class="number">0xBF</span>,<span class="number">0xB5</span></span><br><span class="line">,<span class="number">0x40</span>,<span class="number">0x79</span>,<span class="number">0xD2</span>,<span class="number">0x3E</span>,<span class="number">0x19</span>,<span class="number">0x5D</span>,<span class="number">0xF8</span>,<span class="number">0x69</span>,<span class="number">0x39</span>,<span class="number">0x5F</span>,<span class="number">0xDB</span>,<span class="number">0xFA</span>,<span class="number">0xB2</span>,<span class="number">0x8B</span>,<span class="number">0x6E</span>,<span class="number">0xA2</span></span><br><span class="line">,<span class="number">0xDF</span>,<span class="number">0x16</span>,<span class="number">0xE2</span>,<span class="number">0x63</span>,<span class="number">0xB1</span>,<span class="number">0x20</span>,<span class="number">0xCB</span>,<span class="number">0xBA</span>,<span class="number">0xEE</span>,<span class="number">0x8D</span>,<span class="number">0xAA</span>,<span class="number">0xC8</span>,<span class="number">0xC7</span>,<span class="number">0xC5</span>,<span class="number">0x05</span>,<span class="number">0x66</span></span><br><span class="line">,<span class="number">0x6D</span>,<span class="number">0x3A</span>,<span class="number">0x45</span>,<span class="number">0x72</span>,<span class="number">0x0D</span>,<span class="number">0xCA</span>,<span class="number">0x84</span>,<span class="number">0x4E</span>,<span class="number">0xF5</span>,<span class="number">0x31</span>,<span class="number">0x6B</span>,<span class="number">0x92</span>,<span class="number">0xDC</span>,<span class="number">0xDD</span>,<span class="number">0x9C</span>,<span class="number">0x3F</span></span><br><span class="line">,<span class="number">0x55</span>,<span class="number">0x96</span>,<span class="number">0xA1</span>,<span class="number">0x9F</span>,<span class="number">0xCD</span>,<span class="number">0x9B</span>,<span class="number">0xE3</span>,<span class="number">0xA0</span>,<span class="number">0xA7</span>,<span class="number">0xFC</span>,<span class="number">0xC1</span>,<span class="number">0x78</span>,<span class="number">0x10</span>,<span class="number">0x2E</span>,<span class="number">0x82</span>,<span class="number">0x8F</span></span><br><span class="line">,<span class="number">0x30</span>,<span class="number">0x54</span>,<span class="number">0x04</span>,<span class="number">0xAC</span>,<span class="number">0x41</span>,<span class="number">0x93</span>,<span class="number">0xD3</span>,<span class="number">0x3B</span>,<span class="number">0xEF</span>,<span class="number">0x03</span>,<span class="number">0x81</span>,<span class="number">0x70</span>,<span class="number">0xA6</span>,<span class="number">0x1F</span>,<span class="number">0x22</span>,<span class="number">0x26</span></span><br><span class="line">,<span class="number">0x28</span>,<span class="number">0x6A</span>,<span class="number">0xAB</span>,<span class="number">0x87</span>,<span class="number">0xAD</span>,<span class="number">0x49</span>,<span class="number">0x0F</span>,<span class="number">0xAF</span>,<span class="number">0x90</span>,<span class="number">0x90</span>,<span class="number">0x33</span>,<span class="number">0xFF</span>,<span class="number">0x51</span>,<span class="number">0x53</span>,<span class="number">0x83</span>,<span class="number">0xFF</span></span><br><span class="line">]</span><br><span class="line">s=[<span class="number">0x30</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x30</span>, <span class="number">0x63</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(box.index(s[i])^(<span class="number">0x83</span>+i)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="GWCTF-2019-babyvm"><a href="#GWCTF-2019-babyvm" class="headerlink" title="[GWCTF 2019]babyvm"></a>[GWCTF 2019]babyvm</h2><p>忘了记录</p>
<h2 id="ACTF新生赛2020-fungame"><a href="#ACTF新生赛2020-fungame" class="headerlink" title="[ACTF新生赛2020]fungame"></a>[ACTF新生赛2020]fungame</h2><p>出题人脑洞好大哈哈哈哈哈哈哈</p>
<h2 id="NPUCTF2020-Baby-Obfuscation"><a href="#NPUCTF2020-Baby-Obfuscation" class="headerlink" title="[NPUCTF2020]Baby Obfuscation"></a>[NPUCTF2020]Baby Obfuscation</h2><p><del>这符号表不扣还不如扣了……这个出题人终于完成了我一直以来的梦想：手动扣符号表（就是自己把函数名字改成奇奇怪怪的没人认识的字母(bushi</del><br>不过这种纯逆算法的题，还是肝就能出来的，好吧~试了一下angr爆不出来，只好手逆了，看过track神手过混淆的那篇文章之后觉得大为震撼，虽然看起来是一团浆糊的代码，但其实还是能看出来挺多东西的hhhhhhhhh <del>直接克服了我对这种一团浆糊的代码的恐惧</del><br>加密逻辑一共有五处，但其实有两处走不到，所以就剩三处，剩的三处也很简单，一次加一次异或，话说不知道为啥我开始调试的时候那个i_0是等于1的 <del>不过这block第一位怎么看都不可能参与运算的吧啊喂</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">block=~(~(flag[i-1])+index[(i-1)%4])</span></span><br><span class="line"><span class="string">block^=~(~(flag[i-1])+index[(i-1)%4])</span></span><br><span class="line"><span class="string">block*=8+2</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">ind=[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">block=[<span class="number">0</span>,<span class="number">0x1E79</span>, <span class="number">0x1E79</span>, <span class="number">0x2135</span>, <span class="number">0x170D</span>, <span class="number">0x1F41</span>, <span class="number">0x1901</span>, <span class="number">0x2CED</span>,</span><br><span class="line"><span class="number">0x11F9</span>, <span class="number">0x2649</span>, <span class="number">0x2581</span>, <span class="number">0x2DB5</span>, <span class="number">0x14B5</span>, <span class="number">0x25E5</span>, <span class="number">0x2A31</span>, <span class="number">0x30D5</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(block)):</span><br><span class="line">  block[i]//=<span class="number">100</span></span><br><span class="line">  block[i]^=ind[(i-<span class="number">1</span>)%<span class="number">4</span>]</span><br><span class="line">  block[i]+=ind[(i-<span class="number">1</span>)%<span class="number">4</span>]</span><br><span class="line">  flag+=<span class="built_in">chr</span>(block[i])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="BSidesSF2019-blink"><a href="#BSidesSF2019-blink" class="headerlink" title="[BSidesSF2019]blink"></a>[BSidesSF2019]blink</h2><p>？？？两分钟速通题？？？<br>直接jadx打开，base64转图片，结束</p>
<h2 id="SUCTF2019-hardcpp"><a href="#SUCTF2019-hardcpp" class="headerlink" title="[SUCTF2019]hardcpp"></a>[SUCTF2019]hardcpp</h2><p>纪念我手逆出来的第一个OLLVM啊hhhhhhhhhh <del>不就是懒得学怎么去除控制流平坦化嘛</del><br>不过感觉上OLLVM也就是增加了几个控制条件而已，然后多了一些糨糊代码， <del>看不懂的直接略过就可以了</del> 理论上还是可以手逆出来的~<br>至于这个题就是只有while中间那一坨代码有用</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v13; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v15; <span class="comment">// al</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">char</span> v24; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v25; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v26; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> v27; <span class="comment">// al</span></span><br><span class="line">  <span class="type">int</span> v28; <span class="comment">// [rsp+9Ch] [rbp-94h]</span></span><br><span class="line">  <span class="type">char</span> v29[<span class="number">8</span>]; <span class="comment">// [rsp+A0h] [rbp-90h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v30[<span class="number">8</span>]; <span class="comment">// [rsp+A8h] [rbp-88h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v31[<span class="number">8</span>]; <span class="comment">// [rsp+B0h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v32[<span class="number">8</span>]; <span class="comment">// [rsp+B8h] [rbp-78h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v33[<span class="number">8</span>]; <span class="comment">// [rsp+C0h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v34[<span class="number">7</span>]; <span class="comment">// [rsp+C8h] [rbp-68h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v35; <span class="comment">// [rsp+CFh] [rbp-61h]</span></span><br><span class="line">  <span class="type">int</span> cir_i; <span class="comment">// [rsp+D0h] [rbp-60h]</span></span><br><span class="line">  <span class="type">int</span> v37; <span class="comment">// [rsp+D4h] [rbp-5Ch]</span></span><br><span class="line">  <span class="type">int</span> rand_sub1; <span class="comment">// [rsp+D8h] [rbp-58h]</span></span><br><span class="line">  <span class="type">int</span> rand1; <span class="comment">// [rsp+DCh] [rbp-54h]</span></span><br><span class="line">  <span class="type">char</span> ipt; <span class="comment">// [rsp+E0h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v41[<span class="number">23</span>]; <span class="comment">// [rsp+E1h] [rbp-4Fh] BYREF</span></span><br><span class="line">  <span class="type">char</span> v42[<span class="number">8</span>]; <span class="comment">// [rsp+F8h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v43[<span class="number">8</span>]; <span class="comment">// [rsp+100h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v44[<span class="number">8</span>]; <span class="comment">// [rsp+108h] [rbp-28h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v45[<span class="number">4</span>]; <span class="comment">// [rsp+110h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">int</span> rand2; <span class="comment">// [rsp+114h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> **v47; <span class="comment">// [rsp+118h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> v48; <span class="comment">// [rsp+120h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v49; <span class="comment">// [rsp+124h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> rand_sub2; <span class="comment">// [rsp+128h] [rbp-8h]</span></span><br><span class="line">  <span class="type">bool</span> v51; <span class="comment">// [rsp+12Eh] [rbp-2h]</span></span><br><span class="line">  <span class="type">bool</span> v52; <span class="comment">// [rsp+12Fh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line">  v49 = <span class="number">0</span>;</span><br><span class="line">  v48 = argc;</span><br><span class="line">  v47 = argv;</span><br><span class="line">  rand2 = time(<span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;func(?)=\&quot;01abfc750a0c942167651c40d088531d\&quot;?&quot;</span>);</span><br><span class="line">  ipt = getchar();</span><br><span class="line">  fgets(v41, <span class="number">21</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  rand1 = time(<span class="number">0LL</span>);</span><br><span class="line">  rand_sub1 = rand1 - rand2;</span><br><span class="line">  rand_sub2 = rand1 - rand2;</span><br><span class="line">  v28 = <span class="number">1883240069</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                  &#123;</span><br><span class="line">                    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                    &#123;</span><br><span class="line">                      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                        &#123;</span><br><span class="line">                          <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                          &#123;</span><br><span class="line">                            <span class="keyword">while</span> ( v28 == <span class="number">-2090540314</span> )</span><br><span class="line">                            &#123;</span><br><span class="line">                              v35 = rand_sub1 ^ *(&amp;ipt + cir_i);<span class="comment">// v35=input[i]^rand_sub</span></span><br><span class="line">                              v34[<span class="number">0</span>] = main::$_0::operator()(v44, (<span class="type">unsigned</span> <span class="type">int</span>)v35);<span class="comment">// v34=v35</span></span><br><span class="line">                              v33[<span class="number">0</span>] = main::$_1::operator()(v42, (<span class="type">unsigned</span> <span class="type">int</span>)*(&amp;ipt + rand_sub1 + cir_i - <span class="number">1</span>));<span class="comment">// v33=input[rand_sub+i-1]</span></span><br><span class="line">                              v11 = main::$_1::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">int</span>)#<span class="number">1</span>&#125;::operator()(v33, <span class="number">7</span>);<span class="comment">// v11=enc%7</span></span><br><span class="line">                              v35 = main::$_0::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">char</span>)#<span class="number">1</span>&#125;::operator()((__int64)v34, v11);<span class="comment">// v35=v34+v11</span></span><br><span class="line">                              v32[<span class="number">0</span>] = main::$_2::operator()(v45, (<span class="type">unsigned</span> <span class="type">int</span>)v35);<span class="comment">// v32=v35</span></span><br><span class="line">                              v31[<span class="number">0</span>] = main::$_2::operator()(v45, (<span class="type">unsigned</span> <span class="type">int</span>)*(&amp;ipt + rand_sub1 + cir_i - <span class="number">1</span>));<span class="comment">// v31=input[rand_sub+i-1]</span></span><br><span class="line">                              v12 = main::$_2::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">char</span>)#<span class="number">1</span>&#125;::operator()(v31, <span class="number">18</span>);<span class="comment">// v12=v31^18</span></span><br><span class="line">                              v30[<span class="number">0</span>] = main::$_3::operator()(v43, (<span class="type">unsigned</span> <span class="type">int</span>)v12);<span class="comment">// v30=v12</span></span><br><span class="line">                              v13 = main::$_3::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">char</span>)#<span class="number">1</span>&#125;::operator()(v30, <span class="number">3LL</span>);<span class="comment">// v13=v30*3</span></span><br><span class="line">                              v29[<span class="number">0</span>] = main::$_0::operator()(v44, (<span class="type">unsigned</span> <span class="type">int</span>)v13);<span class="comment">// v29=v13</span></span><br><span class="line">                              v14 = main::$_0::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">char</span>)#<span class="number">1</span>&#125;::operator()((__int64)v29, <span class="number">2</span>);<span class="comment">// v14=v29+2</span></span><br><span class="line">                              v15 = main::$_2::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">char</span>)#<span class="number">1</span>&#125;::operator()(v32, v14);<span class="comment">// v15=v32^v14</span></span><br><span class="line">                              v16 = <span class="number">1299792285</span>;</span><br><span class="line">                              v35 = v15;</span><br><span class="line">                              v52 = enc[cir_i - <span class="number">1</span>] != v15;</span><br><span class="line">                              <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">                                v16 = <span class="number">-424557443</span>;</span><br><span class="line">                              v28 = v16;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">if</span> ( v28 != <span class="number">-1957245689</span> )</span><br><span class="line">                              <span class="keyword">break</span>;</span><br><span class="line">                            v28 = <span class="number">1587023630</span>;</span><br><span class="line">                          &#125;</span><br><span class="line">                          <span class="keyword">if</span> ( v28 != <span class="number">-1884297895</span> )</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                          v28 = <span class="number">-984930794</span>;</span><br><span class="line">                          <span class="built_in">puts</span>(<span class="string">&quot;You win&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> ( v28 != <span class="number">-1852837876</span> )</span><br><span class="line">                          <span class="keyword">break</span>;</span><br><span class="line">                        v18 = <span class="number">1375414539</span>;</span><br><span class="line">                        <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">                          v18 = <span class="number">1154698238</span>;</span><br><span class="line">                        v28 = v18;</span><br><span class="line">                      &#125;</span><br><span class="line">                      <span class="keyword">if</span> ( v28 != <span class="number">-1220297252</span> )</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                      v21 = <span class="number">-1884297895</span>;</span><br><span class="line">                      <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">                        v21 = <span class="number">-984930794</span>;</span><br><span class="line">                      v28 = v21;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> ( v28 != <span class="number">0xC54B2616</span> )</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">                    <span class="built_in">puts</span>(<span class="string">&quot;You win&quot;</span>);</span><br><span class="line">                    v22 = <span class="number">-1884297895</span>;</span><br><span class="line">                    <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">                      v22 = <span class="number">456293525</span>;</span><br><span class="line">                    v28 = v22;</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">if</span> ( v28 != <span class="number">-740226431</span> )</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                  v4 = <span class="number">2137069843</span>;</span><br><span class="line">                  <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">                    v4 = <span class="number">739060228</span>;</span><br><span class="line">                  v28 = v4;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ( v28 == <span class="number">-459161563</span> )</span><br><span class="line">                  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">if</span> ( v28 != <span class="number">-424557443</span> )</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                v17 = <span class="number">1856799435</span>;</span><br><span class="line">                <span class="keyword">if</span> ( v52 )</span><br><span class="line">                  v17 = <span class="number">-1852837876</span>;</span><br><span class="line">                v28 = v17;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> ( v28 != <span class="number">-350248402</span> )</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">              v28 = <span class="number">-55540564</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v28 != <span class="number">-294402024</span> )</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            v6 = <span class="number">1721328217</span>;</span><br><span class="line">            <span class="keyword">if</span> ( v51 )</span><br><span class="line">              v6 = <span class="number">-459161563</span>;</span><br><span class="line">            v28 = v6;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( v28 != <span class="number">-226137905</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v28 = <span class="number">24093646</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( v28 != <span class="number">-55540564</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        v20 = <span class="number">-350248402</span>;</span><br><span class="line">        <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">          v20 = <span class="number">-226137905</span>;</span><br><span class="line">        v28 = v20;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v28 != <span class="number">24093646</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      ++cir_i;</span><br><span class="line">      v28 = <span class="number">1587023630</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v28 == <span class="number">456293525</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">switch</span> ( v28 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">506113758</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Let the silent second hand take the place of my doubt...&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">case</span> <span class="number">623475433</span>:</span><br><span class="line">        cir_i = <span class="number">1</span>;</span><br><span class="line">        v28 = <span class="number">1132336453</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">739060228</span>:</span><br><span class="line">        v37 = <span class="built_in">strlen</span>(&amp;ipt);</span><br><span class="line">        v51 = v37 != <span class="number">21</span>;</span><br><span class="line">        v5 = <span class="number">2137069843</span>;</span><br><span class="line">        <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">          v5 = <span class="number">-294402024</span>;</span><br><span class="line">        v28 = v5;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1011555671</span>:</span><br><span class="line">        v10 = <span class="number">1299792285</span>;</span><br><span class="line">        <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">          v10 = <span class="number">-2090540314</span>;</span><br><span class="line">        v28 = v10;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1132336453</span>:</span><br><span class="line">        v8 = <span class="number">623475433</span>;</span><br><span class="line">        cir_i = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">          v8 = <span class="number">-1957245689</span>;</span><br><span class="line">        v28 = v8;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1154698238</span>:</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1299792285</span>:</span><br><span class="line">        v35 = rand_sub1 ^ *(&amp;ipt + cir_i);</span><br><span class="line">        v34[<span class="number">0</span>] = main::$_0::operator()(v44, (<span class="type">unsigned</span> <span class="type">int</span>)v35);</span><br><span class="line">        v33[<span class="number">0</span>] = main::$_1::operator()(v42, (<span class="type">unsigned</span> <span class="type">int</span>)*(&amp;ipt + rand_sub1 + cir_i - <span class="number">1</span>));</span><br><span class="line">        v24 = main::$_1::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">int</span>)#<span class="number">1</span>&#125;::operator()(v33, <span class="number">7</span>);</span><br><span class="line">        v35 = main::$_0::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">char</span>)#<span class="number">1</span>&#125;::operator()((__int64)v34, v24);</span><br><span class="line">        v32[<span class="number">0</span>] = main::$_2::operator()(v45, (<span class="type">unsigned</span> <span class="type">int</span>)v35);</span><br><span class="line">        v31[<span class="number">0</span>] = main::$_2::operator()(v45, (<span class="type">unsigned</span> <span class="type">int</span>)*(&amp;ipt + rand_sub1 + cir_i - <span class="number">1</span>));</span><br><span class="line">        v25 = main::$_2::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">char</span>)#<span class="number">1</span>&#125;::operator()(v31, <span class="number">18</span>);</span><br><span class="line">        v30[<span class="number">0</span>] = main::$_3::operator()(v43, (<span class="type">unsigned</span> <span class="type">int</span>)v25);</span><br><span class="line">        v26 = main::$_3::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">char</span>)#<span class="number">1</span>&#125;::operator()(v30, <span class="number">3LL</span>);</span><br><span class="line">        v29[<span class="number">0</span>] = main::$_0::operator()(v44, (<span class="type">unsigned</span> <span class="type">int</span>)v26);</span><br><span class="line">        v27 = main::$_0::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">char</span>)#<span class="number">1</span>&#125;::operator()((__int64)v29, <span class="number">2</span>);</span><br><span class="line">        v35 = main::$_2::operator() <span class="type">const</span>(<span class="type">char</span>)::&#123;lambda(<span class="type">char</span>)#<span class="number">1</span>&#125;::operator()(v32, v27);</span><br><span class="line">        v28 = <span class="number">-2090540314</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1375414539</span>:</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1587023630</span>:</span><br><span class="line">        v9 = <span class="number">-1220297252</span>;</span><br><span class="line">        <span class="keyword">if</span> ( cir_i &lt; <span class="number">21</span> )</span><br><span class="line">          v9 = <span class="number">1011555671</span>;</span><br><span class="line">        v28 = v9;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1721328217</span>:</span><br><span class="line">        v7 = <span class="number">623475433</span>;</span><br><span class="line">        <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">          v7 = <span class="number">1132336453</span>;</span><br><span class="line">        v28 = v7;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1856799435</span>:</span><br><span class="line">        v19 = <span class="number">-350248402</span>;</span><br><span class="line">        <span class="keyword">if</span> ( y &lt; <span class="number">10</span> || ((((_BYTE)x - <span class="number">1</span>) * (_BYTE)x) &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">          v19 = <span class="number">-55540564</span>;</span><br><span class="line">        v28 = v19;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1883240069</span>:</span><br><span class="line">        v3 = <span class="number">-740226431</span>;</span><br><span class="line">        <span class="keyword">if</span> ( rand_sub2 &gt; <span class="number">0</span> )</span><br><span class="line">          v3 = <span class="number">506113758</span>;</span><br><span class="line">        v28 = v3;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        v37 = <span class="built_in">strlen</span>(&amp;ipt);</span><br><span class="line">        v28 = <span class="number">739060228</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以最后的表达式就是</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enc[i<span class="number">-1</span>]=(s[i]^rand_sub+s[rand_sub+i<span class="number">-1</span>]%<span class="number">7</span>)^((s[rand_sub+i<span class="number">-1</span>]^<span class="number">18</span>)*<span class="number">3</span>+<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>而这个rand_sub盲猜一波应该是0，不然索引对不上，不过就算不是0也可以在0到enc的长度之内爆破，所以问题不大hhh<br>s[0]不知道，在32到0x7f之内爆破一下<br>这个题有狗啊，这是SUCTF的题，我本来盲猜开头是SUCTF{，赌s[0]是’S’，结果出不来，看了一下题解开头是’#flag{‘，出题人真的太狗了啊hhhhhh</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="number">0xF3</span>, <span class="number">0x2E</span>, <span class="number">0x18</span>, <span class="number">0x36</span>, <span class="number">0xE1</span>, <span class="number">0x4C</span>, <span class="number">0x22</span>, <span class="number">0xD1</span>, <span class="number">0xF9</span>, <span class="number">0x8C</span>, </span><br><span class="line">  <span class="number">0x40</span>, <span class="number">0x76</span>, <span class="number">0xF4</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0xA3</span>, <span class="number">0x90</span>, <span class="number">0x0E</span>, <span class="number">0xA5</span>]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">0x7f</span>):</span><br><span class="line">    r=[]</span><br><span class="line">    r.append(k)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(enc)+<span class="number">1</span>):</span><br><span class="line">        r.append(((enc[i-<span class="number">1</span>]^((r[i-<span class="number">1</span>]^<span class="number">18</span>)*<span class="number">3</span>+<span class="number">2</span>))-(r[i-<span class="number">1</span>]%<span class="number">7</span>))&amp;<span class="number">0xff</span>)</span><br><span class="line">    f=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> r:</span><br><span class="line">        f+=<span class="built_in">chr</span>(i)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;&#123;&#x27;</span> <span class="keyword">in</span> f <span class="keyword">and</span> <span class="string">&#x27;&#125;&#x27;</span> <span class="keyword">in</span> f:</span><br><span class="line">        <span class="built_in">print</span>(f)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="NPUCTF2020-BasicASM"><a href="#NPUCTF2020-BasicASM" class="headerlink" title="[NPUCTF2020]BasicASM"></a>[NPUCTF2020]BasicASM</h2><p>水题，学会看汇编……别骂了我就是只会F5的呜呜呜呜呜呜呜呜</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;662e61257b26301d7972751d6b2c6f355f3a38742d74341d61776d7d7d&#x27;</span></span><br><span class="line">f=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(s),<span class="number">2</span>):</span><br><span class="line">    f.append(<span class="built_in">int</span>(s[i:i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(f),<span class="number">2</span>):</span><br><span class="line">    f[i]^=<span class="number">0x42</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="MRCTF2020-Shit"><a href="#MRCTF2020-Shit" class="headerlink" title="[MRCTF2020]Shit"></a>[MRCTF2020]Shit</h2><p>我不理解，为什么给了源码，源码里还有注释的解密脚本</p>
<h2 id="De1CTF2019-Re-Sign"><a href="#De1CTF2019-Re-Sign" class="headerlink" title="[De1CTF2019]Re_Sign"></a>[De1CTF2019]Re_Sign</h2><p>8会脱壳</p>
<h2 id="watevrCTF-2019-Repyc"><a href="#watevrCTF-2019-Repyc" class="headerlink" title="[watevrCTF 2019]Repyc"></a>[watevrCTF 2019]Repyc</h2><p>虚拟机真tm难搞……动调把报错的代码都删了，好多没用上的代码还列表越界，就离谱……<br>还是尽量用uncompyle6反编译pyc吧，虽然麻烦了一点……被那个网站的编码坑惨了。不知道是怎么回事，这种字符用那个网站解码出来跟uncompyle6的不一样，可能是编码方式的问题，关键是它显示的也是十六进制流啊，搞不懂这为什么会出错……差点心态爆炸了属于是<br>不过感觉渐渐摸到一点虚拟机的门槛吧……呜呜呜呜呜呜呜呜我真的感觉虚拟机好难搞啊为什么他们做虚拟机看起来都这么轻松呜呜呜呜呜呜呜呜呜</p>
<figure class="highlight python"><figcaption><span>&#123;.line-numbers&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fun1</span>(<span class="params">op</span>):</span><br><span class="line">    eax = <span class="number">0</span></span><br><span class="line">    t2 = <span class="number">0</span></span><br><span class="line">    t3 = [<span class="number">0</span>] * <span class="number">2</span> ** (<span class="number">2</span> * <span class="number">2</span>)</span><br><span class="line">    t4 = [<span class="number">0</span>] * <span class="number">100</span></span><br><span class="line">    stack = []</span><br><span class="line">    <span class="keyword">while</span> op[eax][<span class="number">0</span>] != <span class="string">&#x27;nop&#x27;</span>:</span><br><span class="line">        opcode = op[eax][<span class="number">0</span>].lower()</span><br><span class="line">        this_list = op[eax][<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">if</span> opcode == <span class="string">&#x27;add&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = t3[this_list[<span class="number">1</span>]] + t3[this_list[<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;xor&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = t3[this_list[<span class="number">1</span>]] ^ t3[this_list[<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;sub&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = t3[this_list[<span class="number">1</span>]] - t3[this_list[<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;mul&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = t3[this_list[<span class="number">1</span>]] * t3[this_list[<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;div&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = t3[this_list[<span class="number">1</span>]] / t3[this_list[<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;and&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = t3[this_list[<span class="number">1</span>]] &amp; t3[this_list[<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;or&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = t3[this_list[<span class="number">1</span>]] | t3[this_list[<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;equ&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = t3[this_list[<span class="number">0</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;lea&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = t3[this_list[<span class="number">1</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;mov&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = this_list[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;mov1&#x27;</span>:</span><br><span class="line">            t4[this_list[<span class="number">0</span>]] = t3[this_list[<span class="number">1</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;mov2&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = t4[this_list[<span class="number">1</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;clear0&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;clear1&#x27;</span>:</span><br><span class="line">            t4[this_list[<span class="number">0</span>]] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;input&#x27;</span>:</span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = <span class="built_in">input</span>(t3[this_list[<span class="number">1</span>]])</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;input0&#x27;</span>:</span><br><span class="line">            t4[this_list[<span class="number">0</span>]] = <span class="built_in">input</span>(t3[this_list[<span class="number">1</span>]])</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;print&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(t3[this_list[<span class="number">0</span>]])</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;print0&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(t4[this_list[<span class="number">0</span>]])</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;mov3&#x27;</span>:</span><br><span class="line">            eax = t3[this_list[<span class="number">0</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;mov4&#x27;</span>:</span><br><span class="line">            eax = t4[this_list[<span class="number">0</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;pop&#x27;</span>:</span><br><span class="line">            eax = stack.pop()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;cmp+push1&#x27;</span>:</span><br><span class="line">            t3[<span class="number">7</span>] = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t3[this_list[<span class="number">0</span>]])):</span><br><span class="line">                <span class="keyword">if</span> t3[this_list[<span class="number">0</span>]] != t3[this_list[<span class="number">1</span>]]:</span><br><span class="line">                    t3[<span class="number">7</span>] = <span class="number">1</span></span><br><span class="line">                    eax = t3[this_list[<span class="number">2</span>]]</span><br><span class="line">                    stack.append(eax)</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;xor+mov&#x27;</span>:</span><br><span class="line">            k3 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t3[this_list[<span class="number">0</span>]])):</span><br><span class="line">                k3 += <span class="built_in">chr</span>(<span class="built_in">ord</span>(t3[this_list[<span class="number">0</span>]][i]) ^ t3[this_list[<span class="number">1</span>]])</span><br><span class="line">            </span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = k3</span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="string">&#x27;sub+mov&#x27;</span>:</span><br><span class="line">            k3 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t3[this_list[<span class="number">0</span>]])):</span><br><span class="line">                k3 += <span class="built_in">chr</span>(<span class="built_in">ord</span>(t3[this_list[<span class="number">0</span>]][i]) - t3[this_list[<span class="number">1</span>]])</span><br><span class="line">            </span><br><span class="line">            t3[this_list[<span class="number">0</span>]] = k3</span><br><span class="line">        eax += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">fun1([</span><br><span class="line">    [<span class="string">&#x27;mov&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;Authentication token: &#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;input0&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="string">&#x27;mov&#x27;</span>,<span class="number">6</span>,<span class="string">&#x27;\xc3\xa1\xc3\x97\xc3\xa4\xc3\x93\xc3\xa2\xc3\xa6\xc3\xad\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\x9b\xc3\xa3\xc3\xa5\xc3\xa4\xc3\x89\xc3\x96\xc3\x93\xc3\x89\xc3\xa4\xc3\xa0\xc3\x93\xc3\x89\xc3\x96\xc3\x93\xc3\xa5\xc3\xa4\xc3\x89\xc3\x93\xc3\x9a\xc3\x95\xc3\xa6\xc3\xaf\xc3\xa8\xc3\xa4\xc3\x9f\xc3\x99\xc3\x9a\xc3\x89\xc3\x9b\xc3\x93\xc3\xa4\xc3\xa0\xc3\x99\xc3\x94\xc3\x89\xc3\x93\xc3\xa2\xc3\xa6\xc3\x89\xc3\xa0\xc3\x93\xc3\x9a\xc3\x95\xc3\x93\xc3\x92\xc3\x99\xc3\xa6\xc3\xa4\xc3\xa0\xc3\x89\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\x9f\xc3\xa5\xc3\x89\xc3\xa4\xc3\xa0\xc3\x93\xc3\x89\xc3\x9a\xc3\x93\xc3\xa1\xc3\x89\xc2\xb7\xc3\x94\xc3\xa2\xc3\x97\xc3\x9a\xc3\x95\xc3\x93\xc3\x94\xc3\x89\xc2\xb3\xc3\x9a\xc3\x95\xc3\xa6\xc3\xaf\xc3\xa8\xc3\xa4\xc3\x9f\xc3\x99\xc3\x9a\xc3\x89\xc3\x85\xc3\xa4\xc3\x97\xc3\x9a\xc3\x94\xc3\x97\xc3\xa6\xc3\x94\xc3\x89\xc3\x97\xc3\x9a\xc3\xaf\xc3\xa1\xc3\x97\xc3\xaf\xc3\xa5\xc3\x89\xc3\x9f\xc3\x89\xc3\x94\xc3\x99\xc3\x9a\xc3\xa4\xc3\x89\xc3\xa6\xc3\x93\xc3\x97\xc3\x9c\xc3\x9c\xc3\xaf\xc3\x89\xc3\xa0\xc3\x97\xc3\xa2\xc3\x93\xc3\x89\xc3\x97\xc3\x89\xc3\x91\xc3\x99\xc3\x99\xc3\x94\xc3\x89\xc3\xa2\xc3\x9f\xc3\x94\xc3\x89\xc3\x96\xc3\xa3\xc3\xa4\xc3\x89\xc3\x9f\xc3\x89\xc3\xa6\xc3\x93\xc3\x97\xc3\x9c\xc3\x9c\xc3\xaf\xc3\x89\xc3\x93\xc3\x9a\xc3\x9e\xc3\x99\xc3\xaf\xc3\x89\xc3\xa4\xc3\xa0\xc3\x9f\xc3\xa5\xc3\x89\xc3\xa5\xc3\x99\xc3\x9a\xc3\x91\xc3\x89\xc3\x9f\xc3\x89\xc3\xa0\xc3\x99\xc3\xa8\xc3\x93\xc3\x89\xc3\xaf\xc3\x99\xc3\xa3\xc3\x89\xc3\xa1\xc3\x9f\xc3\x9c\xc3\x9c\xc3\x89\xc3\x93\xc3\x9a\xc3\x9e\xc3\x99\xc3\xaf\xc3\x89\xc3\x9f\xc3\xa4\xc3\x89\xc3\x97\xc3\xa5\xc3\xa1\xc3\x93\xc3\x9c\xc3\x9c\xc2\x97\xc3\x89\xc3\xaf\xc3\x99\xc3\xa3\xc3\xa4\xc3\xa3\xc3\x96\xc3\x93\xc2\x9a\xc3\x95\xc3\x99\xc3\x9b\xc2\x99\xc3\xa1\xc3\x97\xc3\xa4\xc3\x95\xc3\xa0\xc2\xa9\xc3\xa2\xc2\xab\xc2\xb3\xc2\xa3\xc3\xaf\xc2\xb2\xc3\x95\xc3\x94\xc3\x88\xc2\xb7\xc2\xb1\xc3\xa2\xc2\xa8\xc3\xab&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;mov&#x27;</span>,<span class="number">2</span>,<span class="number">2</span> ** (<span class="number">3</span> * <span class="number">2</span> + <span class="number">1</span>) - <span class="number">2</span> ** (<span class="number">2</span> + <span class="number">1</span>)],</span><br><span class="line">    [<span class="string">&#x27;mov&#x27;</span>,<span class="number">4</span>,<span class="number">15</span>],</span><br><span class="line">    [<span class="string">&#x27;mov&#x27;</span>,<span class="number">3</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="string">&#x27;mul&#x27;</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>],</span><br><span class="line">    [<span class="string">&#x27;add&#x27;</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>],</span><br><span class="line">    [<span class="string">&#x27;equ&#x27;</span>,<span class="number">0</span>,<span class="number">2</span>],</span><br><span class="line">    [<span class="string">&#x27;claer0&#x27;</span>,<span class="number">3</span>],</span><br><span class="line">    [<span class="string">&#x27;xor+mov&#x27;</span>,<span class="number">6</span>,<span class="number">3</span>],</span><br><span class="line">    [<span class="string">&#x27;mov&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;Thanks.&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;mov&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;Authorizing access...&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;print&#x27;</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="string">&#x27;mov2&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="string">&#x27;xor+mov&#x27;</span>,<span class="number">0</span>,<span class="number">2</span>],</span><br><span class="line">    [<span class="string">&#x27;sub+mov&#x27;</span>,<span class="number">0</span>,<span class="number">4</span>],</span><br><span class="line">    [<span class="string">&#x27;mov&#x27;</span>,<span class="number">5</span>,<span class="number">19</span>],</span><br><span class="line">    [<span class="string">&#x27;cmp+push1&#x27;</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">5</span>],</span><br><span class="line">    [<span class="string">&#x27;print&#x27;</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="string">&#x27;nop&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;mov&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;Access denied!&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;print&#x27;</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="string">&#x27;nop&#x27;</span>]])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这是用在线网站反编译的python代码，当然，我修了一下诡异的字符，然后删去了报错还没用的cmp部分来动调观察用来异或和减的值是多少。<br>77行的mov将密文放到索引为6的地方，93行比较索引为6的地方（即密文）和索引为0的地方（可以推测是明文加密后的结果），此前在索引为0的地方加密的只有90和91行的异或和减，所以整个过程就是把明文异或然后减，要恢复明文只需加然后异或就可以了。至于减和异或的值，可以自己手动调试取得。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&#x27;á×äÓâæíäàßåÉÛãåäÉÖÓÉäàÓÉÖÓåäÉÓÚÕæïèäßÙÚÉÛÓäàÙÔÉÓâæÉàÓÚÕÓÒÙæäàÉäàßåÉßåÉäàÓÉÚÓáÉ·Ôâ×ÚÕÓÔÉ³ÚÕæïèäßÙÚÉÅä×ÚÔ×æÔÉ×Úïá×ïåÉßÉÔÙÚäÉæÓ×ÜÜïÉà×âÓÉ×ÉÑÙÙÔÉâßÔÉÖãäÉßÉæÓ×ÜÜïÉÓÚÞÙïÉäàßåÉåÙÚÑÉßÉàÙèÓÉïÙãÉáßÜÜÉÓÚÞÙïÉßäÉ×åáÓÜÜ\x97ÉïÙãäãÖÓ\x9aÕÙÛ\x99á×äÕà©â«³£ï²ÕÔÈ·±â¨ë&#x27;</span></span><br><span class="line">b = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">	b += <span class="built_in">chr</span>(<span class="built_in">ord</span>(i) + <span class="number">15</span> ^ <span class="number">135</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<h2 id="HellScream"><a href="#HellScream" class="headerlink" title="HellScream"></a>HellScream</h2><p>RSA，8会</p>
<h2 id="FlareOn1-Javascrap"><a href="#FlareOn1-Javascrap" class="headerlink" title="[FlareOn1]Javascrap"></a>[FlareOn1]Javascrap</h2><p>PHP真好玩……</p>
<h2 id="FlareOn6-Memecat-Battlestation"><a href="#FlareOn6-Memecat-Battlestation" class="headerlink" title="[FlareOn6]Memecat Battlestation"></a>[FlareOn6]Memecat Battlestation</h2><p>好奇怪的题，两次验证，一次明文一次异或。<br>但是我很好奇，最后成功会显示flag图片，但是为什么资源文件里找不到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&quot;\x03 &amp;$-\x1e\x02 //./&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="FlareOn1-Shellolololol"><a href="#FlareOn1-Shellolololol" class="headerlink" title="[FlareOn1]Shellolololol"></a>[FlareOn1]Shellolololol</h2><p>动调看栈窗口出的，emmm没懂考点在哪里 <del>难道就是动调吗</del></p>
<h2 id="CFI-CTF-2018-powerPacked"><a href="#CFI-CTF-2018-powerPacked" class="headerlink" title="[CFI-CTF 2018]powerPacked"></a>[CFI-CTF 2018]powerPacked</h2><p>ELF的upx壳，嗯，长知识了，我一直以为只有PE有UPX壳的……<br><code>CFI&#123;i_love_powerpc</code> <del>这玩意怎么看都不可能是flag吧啊喂</del><br>但它真的是flag诶，加个大括号就好了……</p>
<h2 id="b01lers2020-chugga-chugga"><a href="#b01lers2020-chugga-chugga" class="headerlink" title="[b01lers2020]chugga_chugga"></a>[b01lers2020]chugga_chugga</h2><p>嘶，翻buu发现这题flag交了，但是这里忘了记录了，emmm应该不难吧（逃</p>

    </div>

    <div class="about">
        <h1>关于本文</h1>
        <p>本文作者 云之君, 许可由 <a
                target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
    </div>

    
        
    
</article>
        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h4 class="title">Blog</h4>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/CTF" class="item">CTF</a>
                
                <a href="/Learn" class="item">Learn</a>
                
                <a href="/Diary" class="item">Diary</a>
                
                <a href="/friends" class="item">Friends</a>
                
            </div>
            
            <div class="group">
                <h4 class="title">Me</h4>
                
                <a target="_blank" rel="noopener" href="https://github.com/YunZh1Jun" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://space.bilibili.com/25320847" class="item">Bilibili</a>
                
                <a href="mailto:yunzh1jun@qq.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 云之君<br >驱动由 <a href="http://hexo.io/" target="_blank">Hexo</a></span>
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
    </body>
</html>