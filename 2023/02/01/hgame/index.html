<!DOCTYPE html>
<html lang="zh-cn">
    <!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>hgame2023 - 云之君&#39;s Blog</title>
  
    <link rel="shortcut icon" href="/img/fav/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
<link rel="stylesheet" href="/css/waline.css">

  
  
  
<link rel="stylesheet" href="/css/post.css">

  

  
    
<script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
 
  

  
<meta name="generator" content="Hexo 5.4.2"></head>
    <body data-color-scheme="auto">
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">云之君&#39;s Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">主页</a>
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/CTF">CTF</a>
            
            
            
            <a class="nav-item" href="/Learn">Learn</a>
            
            
            
            <a class="nav-item" href="/Dairy">Dairy</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/YunZh1Jun" target="_blank">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        <article class="post">
    <div class="meta">
        
        <div class="date" id="date">
            
            
            <span>February</span>
            
            
            
            
            
            
            
            
            
            
            
            <span>1,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">hgame2023</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <hr>
<h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><p>第一周……题很简单，写得比较乱，就这样吧…………</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: x = [<span class="number">0x5b</span>,<span class="number">0x54</span>,<span class="number">0x52</span>,<span class="number">0x5e</span>,<span class="number">0x56</span>,<span class="number">0x48</span>,<span class="number">0x44</span>,<span class="number">0x56</span>,<span class="number">0x5f</span>,<span class="number">0x50</span>,<span class="number">0x3</span>,<span class="number">0x5e</span>,<span class="number">0x56</span>,<span class="number">0x6c</span>,<span class="number">0x47</span>,<span class="number">0x3</span>,<span class="number">0x6c</span>,<span class="number">0x41</span>,<span class="number">0x56</span>,<span class="number">0x6c</span>,<span class="number">0x44</span>,<span class="number">0x5</span></span><br><span class="line">   ...: c,<span class="number">0x41</span>,<span class="number">0x2</span>,<span class="number">0x57</span>,<span class="number">0x12</span>,<span class="number">0x4e</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: <span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">   ...:     <span class="built_in">print</span>(<span class="built_in">chr</span>(i^<span class="number">0x33</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">   ...:</span><br><span class="line">hgame&#123;welc0me_t0_re_wor1d!&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">box = [<span class="number">8</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">0xD</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">0xB</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">0xE</span>, <span class="number">6</span>,</span><br><span class="line"><span class="number">3</span>, <span class="number">6</span>, <span class="number">0xF</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">0xF</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0xF</span>, <span class="number">5</span>, <span class="number">5</span>,</span><br><span class="line"><span class="number">6</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">0xF</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">0xF</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">7</span>,</span><br><span class="line"><span class="number">0xF</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">0xF</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>,</span><br><span class="line"><span class="number">7</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">0xF</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">0xE</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">6</span>,</span><br><span class="line"><span class="number">0xE</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">0xD</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(box), <span class="number">2</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>((box[i+<span class="number">1</span>]&lt;&lt;<span class="number">4</span>)+box[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#hgame&#123;encode_is_easy_for_a_reverse_engineer&#125;</span></span><br></pre></td></tr></table></figure>

<p>本来以为是出题人的恶趣味，结果只是不小心出错了emmmm</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* v)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x543210DD</span>;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    sum -= <span class="number">0x543210DD</span> * <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;</span><br><span class="line">    v1 -= (sum + v0) ^ ((v0 &gt;&gt; <span class="number">5</span>) + <span class="number">0x45678901</span>) ^ (<span class="number">16</span> * (v0 + <span class="number">0x3456789</span>));</span><br><span class="line">    v0 -= (sum + v1) ^ (<span class="number">16</span> * v1 + <span class="number">0x12345678</span>) ^ ((v1 &gt;&gt; <span class="number">5</span>) + <span class="number">0x23456789</span>);</span><br><span class="line">    sum += <span class="number">0x543210DD</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v[<span class="number">0</span>]=v0; </span><br><span class="line">    v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> v[<span class="number">8</span>] = &#123;<span class="number">0x2E63829D</span>, <span class="number">0xC14E400F</span>, <span class="number">0x73495F40</span>, <span class="number">0x765F345F</span>, <span class="number">0x5F797265</span>, <span class="number">0x6C613368</span>, <span class="number">0x5F796874</span>, <span class="number">0x6E317264</span>&#125;;</span><br><span class="line">    decrypt(v);</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> *c ;</span><br><span class="line">    c = (<span class="type">char</span>*)v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,c[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c%c&quot;</span>,<span class="number">0x6b</span>,<span class="number">0x7d</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//hgame&#123;Te@_Is_4_very_h3althy_dr1nk&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> c[] = &#123;</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xFF</span>, <span class="number">0xFD</span>, <span class="number">0x09</span>, <span class="number">0x01</span>, <span class="number">0xF3</span>, <span class="number">0xB0</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>,</span><br><span class="line">    <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0x17</span>, <span class="number">0x05</span>, <span class="number">0xEB</span>, <span class="number">0x17</span>, <span class="number">0xFD</span>, <span class="number">0x17</span>, </span><br><span class="line">    <span class="number">0xEA</span>, <span class="number">0x01</span>, <span class="number">0xEE</span>, <span class="number">0x01</span>, <span class="number">0xEA</span>, <span class="number">0xB1</span>, <span class="number">0x05</span>, <span class="number">0xFA</span>, <span class="number">0x08</span>, <span class="number">0x01</span>, </span><br><span class="line">    <span class="number">0x17</span>, <span class="number">0xAC</span>, <span class="number">0xEC</span>, <span class="number">0x01</span>, <span class="number">0xEA</span>, <span class="number">0xFD</span>, <span class="number">0xF0</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x06</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">41</span>; i++)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,(c[i]+<span class="number">86</span>)^<span class="number">0x32</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//hgame&#123;4ddit1on_is_a_rever5ible_0peration&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在 http://factordb.com/ 分解n</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">11239134987804993586763559028187245057652550219515201768644770733869088185320740938450178816138394844329723311433549899499795775655921261664087997097294813</span></span><br><span class="line">q=<span class="number">12022912661420941592569751731802639375088427463430162252113082619617837010913002515450223656942836378041122163833359097910935638423464006252814266959128953</span></span><br><span class="line">c=<span class="number">110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">i = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, i, p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">crcbp = <span class="built_in">open</span>(<span class="string">&quot;图片路径&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()    <span class="comment">#打开图片</span></span><br><span class="line">crc32frombp = <span class="built_in">int</span>(crcbp[<span class="number">29</span>:<span class="number">33</span>].<span class="built_in">hex</span>(),<span class="number">16</span>)     <span class="comment">#读取图片中的CRC校验值</span></span><br><span class="line"><span class="built_in">print</span>(crc32frombp)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4000</span>):                        <span class="comment">#宽度1-4000进行枚举</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4000</span>):                    <span class="comment">#高度1-4000进行枚举</span></span><br><span class="line">        data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + \</span><br><span class="line">            struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="comment">#print(crc32)</span></span><br><span class="line">        <span class="keyword">if</span>(crc32 == crc32frombp):            <span class="comment">#计算当图片大小为i:j时的CRC校验值，与图片中的CRC比较，当相同，则图片大小已经确定</span></span><br><span class="line">            <span class="built_in">print</span>(i, j)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;hex:&#x27;</span>, <span class="built_in">hex</span>(i), <span class="built_in">hex</span>(j))</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#hex: 0x200 0x2c2</span></span><br><span class="line"><span class="comment">#hgame&#123;e99p1ant_want_a_girlfriend_qq_524306184&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="before-main"><a href="#before-main" class="headerlink" title="before main"></a>before main</h3><p>init函数换了base64的码表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&quot;AMHo7dLxUEabf6Z3PdWr6cOy75i4fdfeUzL17kaV7rG=&quot;</span></span><br><span class="line"></span><br><span class="line">string1 = <span class="string">&quot;qaCpwYM2tO/RP0XeSZv8kLd6nfA7UHJ1No4gF5zr3VsBQbl9juhEGymc+WTxIiDK&quot;</span></span><br><span class="line">string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br><span class="line"><span class="comment">#hgame&#123;s0meth1ng_run_befOre_m@in&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><p>矩阵相乘，用输入矩阵乘以box1，得到box2，最终用box2乘以box1的逆矩阵即可还原输入矩阵。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">box1 = matrix([[<span class="number">126</span>,<span class="number">225</span>,<span class="number">62</span>,<span class="number">40</span>,<span class="number">216</span>],[<span class="number">253</span>,<span class="number">20</span>,<span class="number">124</span>,<span class="number">232</span>,<span class="number">122</span>],[<span class="number">62</span>,<span class="number">23</span>,<span class="number">100</span>,<span class="number">161</span>,<span class="number">36</span>],[<span class="number">118</span>,<span class="number">21</span>,<span class="number">184</span>,<span class="number">26</span>,<span class="number">142</span>],[<span class="number">59</span>,<span class="number">31</span>,<span class="number">186</span>,<span class="number">82</span>,<span class="number">79</span>]])</span><br><span class="line">box2 = matrix([[<span class="number">63998</span>,<span class="number">33111</span>,<span class="number">67762</span>,<span class="number">54789</span>,<span class="number">61979</span>],[<span class="number">69619</span>,<span class="number">37190</span>,<span class="number">70162</span>,<span class="number">53110</span>,<span class="number">68678</span>],[<span class="number">63339</span>,<span class="number">30687</span>,<span class="number">66494</span>,<span class="number">50936</span>,<span class="number">60810</span>],[<span class="number">48784</span>,<span class="number">30188</span>,<span class="number">60104</span>,<span class="number">44599</span>,<span class="number">52265</span>],[<span class="number">43048</span>,<span class="number">23660</span>,<span class="number">43850</span>,<span class="number">33646</span>,<span class="number">44270</span>]])</span><br><span class="line"><span class="built_in">print</span>(box2*box1.inverse())</span><br><span class="line"><span class="comment">#hgame&#123;y0ur_m@th_1s_gO0d&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a>stream</h3><p>md。。。这题做得我想鼠。。。<br>解包之后反编译，明显RC4＋base64<br>但是直接写脚本是解不出来的……<br>这是为什么呢？哦~原来是encode的锅，只要把base解密之后的密文再decode回去就好了~……</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">enc = base64.b64decode(<span class="string">b&#x27;wr3ClVcSw7nCmMOcHcKgacOtMkvDjxZ6asKWw4nChMK8IsK7KMOOasOrdgbDlx3DqcKqwr0hw701Ly57w63CtcOl&#x27;</span>)</span><br><span class="line">enc = enc.decode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crypt</span>(<span class="params">data,key</span>) :</span><br><span class="line">    s = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>) :</span><br><span class="line">        s[i] = i</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>) :</span><br><span class="line">        j = (j + s[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        s[i], s[j] = s[j], s[i]</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> data :</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + s[i]) % <span class="number">256</span></span><br><span class="line">        s[i], s[j] = s[j], s[i]</span><br><span class="line">        res = res + <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) ^ s[(s[i] + s[j]) % <span class="number">256</span>])</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;As_we_do_as_you_know&quot;</span> </span><br><span class="line">res = crypt(enc,key)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<p>最后一个安卓xtea，不写了，摆了。</p>
<h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="kunmusic"><a href="#kunmusic" class="headerlink" title="kunmusic"></a>kunmusic</h3><p>C#写的，直接看DLL，用dnspy<br>main函数里有：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">	ApplicationConfiguration.Initialize();</span><br><span class="line">	<span class="built_in">byte</span>[] data = Resources.data;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; data.Length; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">byte</span>[] array = data;</span><br><span class="line">		<span class="built_in">int</span> num = i;</span><br><span class="line">		array[num] ^= <span class="number">104</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	Activator.CreateInstance(Assembly.Load(data).GetType(<span class="string">&quot;WinFormsLibrary1.Class1&quot;</span>), <span class="keyword">new</span> <span class="built_in">object</span>[]</span><br><span class="line">	&#123;</span><br><span class="line">		Program.form1</span><br><span class="line">	&#125;);</span><br><span class="line">	Application.Run(Program.form1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接调试断到这里，自己把数据拖出来异或。数据太长就不放脚本了。<br>得到一个exe文件，还是C#写的，dnspy里看一个叫music的类：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">music</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.num[<span class="number">0</span>] + <span class="number">52296</span> + <span class="keyword">this</span>.num[<span class="number">1</span>] - <span class="number">26211</span> + <span class="keyword">this</span>.num[<span class="number">2</span>] - <span class="number">11754</span> + (<span class="keyword">this</span>.num[<span class="number">3</span>] ^ <span class="number">41236</span>) + <span class="keyword">this</span>.num[<span class="number">4</span>] * <span class="number">63747</span> + <span class="keyword">this</span>.num[<span class="number">5</span>] - <span class="number">52714</span> + <span class="keyword">this</span>.num[<span class="number">6</span>] - <span class="number">10512</span> + <span class="keyword">this</span>.num[<span class="number">7</span>] * <span class="number">12972</span> + <span class="keyword">this</span>.num[<span class="number">8</span>] + <span class="number">45505</span> + <span class="keyword">this</span>.num[<span class="number">9</span>] - <span class="number">21713</span> + <span class="keyword">this</span>.num[<span class="number">10</span>] - <span class="number">59122</span> + <span class="keyword">this</span>.num[<span class="number">11</span>] - <span class="number">12840</span> + (<span class="keyword">this</span>.num[<span class="number">12</span>] ^ <span class="number">21087</span>) == <span class="number">12702282</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] - <span class="number">25228</span> + (<span class="keyword">this</span>.num[<span class="number">1</span>] ^ <span class="number">20699</span>) + (<span class="keyword">this</span>.num[<span class="number">2</span>] ^ <span class="number">8158</span>) + <span class="keyword">this</span>.num[<span class="number">3</span>] - <span class="number">65307</span> + <span class="keyword">this</span>.num[<span class="number">4</span>] * <span class="number">30701</span> + <span class="keyword">this</span>.num[<span class="number">5</span>] * <span class="number">47555</span> + <span class="keyword">this</span>.num[<span class="number">6</span>] - <span class="number">2557</span> + (<span class="keyword">this</span>.num[<span class="number">7</span>] ^ <span class="number">49055</span>) + <span class="keyword">this</span>.num[<span class="number">8</span>] - <span class="number">7992</span> + (<span class="keyword">this</span>.num[<span class="number">9</span>] ^ <span class="number">57465</span>) + (<span class="keyword">this</span>.num[<span class="number">10</span>] ^ <span class="number">57426</span>) + <span class="keyword">this</span>.num[<span class="number">11</span>] + <span class="number">13299</span> + <span class="keyword">this</span>.num[<span class="number">12</span>] - <span class="number">50966</span> == <span class="number">9946829</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] - <span class="number">64801</span> + <span class="keyword">this</span>.num[<span class="number">1</span>] - <span class="number">60698</span> + <span class="keyword">this</span>.num[<span class="number">2</span>] - <span class="number">40853</span> + <span class="keyword">this</span>.num[<span class="number">3</span>] - <span class="number">54907</span> + <span class="keyword">this</span>.num[<span class="number">4</span>] + <span class="number">29882</span> + (<span class="keyword">this</span>.num[<span class="number">5</span>] ^ <span class="number">13574</span>) + (<span class="keyword">this</span>.num[<span class="number">6</span>] ^ <span class="number">21310</span>) + <span class="keyword">this</span>.num[<span class="number">7</span>] + <span class="number">47366</span> + <span class="keyword">this</span>.num[<span class="number">8</span>] + <span class="number">41784</span> + (<span class="keyword">this</span>.num[<span class="number">9</span>] ^ <span class="number">53690</span>) + <span class="keyword">this</span>.num[<span class="number">10</span>] * <span class="number">58436</span> + <span class="keyword">this</span>.num[<span class="number">11</span>] * <span class="number">15590</span> + <span class="keyword">this</span>.num[<span class="number">12</span>] + <span class="number">58225</span> == <span class="number">2372055</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] + <span class="number">61538</span> + <span class="keyword">this</span>.num[<span class="number">1</span>] - <span class="number">17121</span> + <span class="keyword">this</span>.num[<span class="number">2</span>] - <span class="number">58124</span> + <span class="keyword">this</span>.num[<span class="number">3</span>] + <span class="number">8186</span> + <span class="keyword">this</span>.num[<span class="number">4</span>] + <span class="number">21253</span> + <span class="keyword">this</span>.num[<span class="number">5</span>] - <span class="number">38524</span> + <span class="keyword">this</span>.num[<span class="number">6</span>] - <span class="number">48323</span> + <span class="keyword">this</span>.num[<span class="number">7</span>] - <span class="number">20556</span> + <span class="keyword">this</span>.num[<span class="number">8</span>] * <span class="number">56056</span> + <span class="keyword">this</span>.num[<span class="number">9</span>] + <span class="number">18568</span> + <span class="keyword">this</span>.num[<span class="number">10</span>] + <span class="number">12995</span> + (<span class="keyword">this</span>.num[<span class="number">11</span>] ^ <span class="number">39260</span>) + <span class="keyword">this</span>.num[<span class="number">12</span>] + <span class="number">25329</span> == <span class="number">6732474</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] - <span class="number">42567</span> + <span class="keyword">this</span>.num[<span class="number">1</span>] - <span class="number">17743</span> + <span class="keyword">this</span>.num[<span class="number">2</span>] * <span class="number">47827</span> + <span class="keyword">this</span>.num[<span class="number">3</span>] - <span class="number">10246</span> + (<span class="keyword">this</span>.num[<span class="number">4</span>] ^ <span class="number">16284</span>) + <span class="keyword">this</span>.num[<span class="number">5</span>] + <span class="number">39390</span> + <span class="keyword">this</span>.num[<span class="number">6</span>] * <span class="number">11803</span> + <span class="keyword">this</span>.num[<span class="number">7</span>] * <span class="number">60332</span> + (<span class="keyword">this</span>.num[<span class="number">8</span>] ^ <span class="number">18491</span>) + (<span class="keyword">this</span>.num[<span class="number">9</span>] ^ <span class="number">4795</span>) + <span class="keyword">this</span>.num[<span class="number">10</span>] - <span class="number">25636</span> + <span class="keyword">this</span>.num[<span class="number">11</span>] - <span class="number">16780</span> + <span class="keyword">this</span>.num[<span class="number">12</span>] - <span class="number">62345</span> == <span class="number">14020739</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] - <span class="number">10968</span> + <span class="keyword">this</span>.num[<span class="number">1</span>] - <span class="number">31780</span> + (<span class="keyword">this</span>.num[<span class="number">2</span>] ^ <span class="number">31857</span>) + <span class="keyword">this</span>.num[<span class="number">3</span>] - <span class="number">61983</span> + <span class="keyword">this</span>.num[<span class="number">4</span>] * <span class="number">31048</span> + <span class="keyword">this</span>.num[<span class="number">5</span>] * <span class="number">20189</span> + <span class="keyword">this</span>.num[<span class="number">6</span>] + <span class="number">12337</span> + <span class="keyword">this</span>.num[<span class="number">7</span>] * <span class="number">25945</span> + (<span class="keyword">this</span>.num[<span class="number">8</span>] ^ <span class="number">7064</span>) + <span class="keyword">this</span>.num[<span class="number">9</span>] - <span class="number">25369</span> + <span class="keyword">this</span>.num[<span class="number">10</span>] - <span class="number">54893</span> + <span class="keyword">this</span>.num[<span class="number">11</span>] * <span class="number">59949</span> + (<span class="keyword">this</span>.num[<span class="number">12</span>] ^ <span class="number">12441</span>) == <span class="number">14434062</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] + <span class="number">16689</span> + <span class="keyword">this</span>.num[<span class="number">1</span>] - <span class="number">10279</span> + <span class="keyword">this</span>.num[<span class="number">2</span>] - <span class="number">32918</span> + <span class="keyword">this</span>.num[<span class="number">3</span>] - <span class="number">57155</span> + <span class="keyword">this</span>.num[<span class="number">4</span>] * <span class="number">26571</span> + <span class="keyword">this</span>.num[<span class="number">5</span>] * <span class="number">15086</span> + (<span class="keyword">this</span>.num[<span class="number">6</span>] ^ <span class="number">22986</span>) + (<span class="keyword">this</span>.num[<span class="number">7</span>] ^ <span class="number">23349</span>) + (<span class="keyword">this</span>.num[<span class="number">8</span>] ^ <span class="number">16381</span>) + (<span class="keyword">this</span>.num[<span class="number">9</span>] ^ <span class="number">23173</span>) + <span class="keyword">this</span>.num[<span class="number">10</span>] - <span class="number">40224</span> + <span class="keyword">this</span>.num[<span class="number">11</span>] + <span class="number">31751</span> + <span class="keyword">this</span>.num[<span class="number">12</span>] * <span class="number">8421</span> == <span class="number">7433598</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] + <span class="number">28740</span> + <span class="keyword">this</span>.num[<span class="number">1</span>] - <span class="number">64696</span> + <span class="keyword">this</span>.num[<span class="number">2</span>] + <span class="number">60470</span> + <span class="keyword">this</span>.num[<span class="number">3</span>] - <span class="number">14752</span> + (<span class="keyword">this</span>.num[<span class="number">4</span>] ^ <span class="number">1287</span>) + (<span class="keyword">this</span>.num[<span class="number">5</span>] ^ <span class="number">35272</span>) + <span class="keyword">this</span>.num[<span class="number">6</span>] + <span class="number">49467</span> + <span class="keyword">this</span>.num[<span class="number">7</span>] - <span class="number">33788</span> + <span class="keyword">this</span>.num[<span class="number">8</span>] + <span class="number">20606</span> + (<span class="keyword">this</span>.num[<span class="number">9</span>] ^ <span class="number">44874</span>) + <span class="keyword">this</span>.num[<span class="number">10</span>] * <span class="number">19764</span> + <span class="keyword">this</span>.num[<span class="number">11</span>] + <span class="number">48342</span> + <span class="keyword">this</span>.num[<span class="number">12</span>] * <span class="number">56511</span> == <span class="number">7989404</span> &amp;&amp; (<span class="keyword">this</span>.num[<span class="number">0</span>] ^ <span class="number">28978</span>) + <span class="keyword">this</span>.num[<span class="number">1</span>] + <span class="number">23120</span> + <span class="keyword">this</span>.num[<span class="number">2</span>] + <span class="number">22802</span> + <span class="keyword">this</span>.num[<span class="number">3</span>] * <span class="number">31533</span> + (<span class="keyword">this</span>.num[<span class="number">4</span>] ^ <span class="number">39287</span>) + <span class="keyword">this</span>.num[<span class="number">5</span>] - <span class="number">48576</span> + (<span class="keyword">this</span>.num[<span class="number">6</span>] ^ <span class="number">28542</span>) + <span class="keyword">this</span>.num[<span class="number">7</span>] - <span class="number">43265</span> + <span class="keyword">this</span>.num[<span class="number">8</span>] + <span class="number">22365</span> + <span class="keyword">this</span>.num[<span class="number">9</span>] + <span class="number">61108</span> + <span class="keyword">this</span>.num[<span class="number">10</span>] * <span class="number">2823</span> + <span class="keyword">this</span>.num[<span class="number">11</span>] - <span class="number">30343</span> + <span class="keyword">this</span>.num[<span class="number">12</span>] + <span class="number">14780</span> == <span class="number">3504803</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] * <span class="number">22466</span> + (<span class="keyword">this</span>.num[<span class="number">1</span>] ^ <span class="number">55999</span>) + <span class="keyword">this</span>.num[<span class="number">2</span>] - <span class="number">53658</span> + (<span class="keyword">this</span>.num[<span class="number">3</span>] ^ <span class="number">47160</span>) + (<span class="keyword">this</span>.num[<span class="number">4</span>] ^ <span class="number">12511</span>) + <span class="keyword">this</span>.num[<span class="number">5</span>] * <span class="number">59807</span> + <span class="keyword">this</span>.num[<span class="number">6</span>] + <span class="number">46242</span> + <span class="keyword">this</span>.num[<span class="number">7</span>] + <span class="number">3052</span> + (<span class="keyword">this</span>.num[<span class="number">8</span>] ^ <span class="number">25279</span>) + <span class="keyword">this</span>.num[<span class="number">9</span>] + <span class="number">30202</span> + <span class="keyword">this</span>.num[<span class="number">10</span>] * <span class="number">22698</span> + <span class="keyword">this</span>.num[<span class="number">11</span>] + <span class="number">33480</span> + (<span class="keyword">this</span>.num[<span class="number">12</span>] ^ <span class="number">16757</span>) == <span class="number">11003580</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] * <span class="number">57492</span> + (<span class="keyword">this</span>.num[<span class="number">1</span>] ^ <span class="number">13421</span>) + <span class="keyword">this</span>.num[<span class="number">2</span>] - <span class="number">13941</span> + (<span class="keyword">this</span>.num[<span class="number">3</span>] ^ <span class="number">48092</span>) + <span class="keyword">this</span>.num[<span class="number">4</span>] * <span class="number">38310</span> + <span class="keyword">this</span>.num[<span class="number">5</span>] + <span class="number">9884</span> + <span class="keyword">this</span>.num[<span class="number">6</span>] - <span class="number">45500</span> + <span class="keyword">this</span>.num[<span class="number">7</span>] - <span class="number">19233</span> + <span class="keyword">this</span>.num[<span class="number">8</span>] + <span class="number">58274</span> + <span class="keyword">this</span>.num[<span class="number">9</span>] + <span class="number">36175</span> + (<span class="keyword">this</span>.num[<span class="number">10</span>] ^ <span class="number">18568</span>) + <span class="keyword">this</span>.num[<span class="number">11</span>] * <span class="number">49694</span> + (<span class="keyword">this</span>.num[<span class="number">12</span>] ^ <span class="number">9473</span>) == <span class="number">25546210</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] - <span class="number">23355</span> + <span class="keyword">this</span>.num[<span class="number">1</span>] * <span class="number">50164</span> + (<span class="keyword">this</span>.num[<span class="number">2</span>] ^ <span class="number">34618</span>) + <span class="keyword">this</span>.num[<span class="number">3</span>] + <span class="number">52703</span> + <span class="keyword">this</span>.num[<span class="number">4</span>] + <span class="number">36245</span> + <span class="keyword">this</span>.num[<span class="number">5</span>] * <span class="number">46648</span> + (<span class="keyword">this</span>.num[<span class="number">6</span>] ^ <span class="number">4858</span>) + (<span class="keyword">this</span>.num[<span class="number">7</span>] ^ <span class="number">41846</span>) + <span class="keyword">this</span>.num[<span class="number">8</span>] * <span class="number">27122</span> + (<span class="keyword">this</span>.num[<span class="number">9</span>] ^ <span class="number">42058</span>) + <span class="keyword">this</span>.num[<span class="number">10</span>] * <span class="number">15676</span> + <span class="keyword">this</span>.num[<span class="number">11</span>] - <span class="number">31863</span> + <span class="keyword">this</span>.num[<span class="number">12</span>] + <span class="number">62510</span> == <span class="number">11333836</span> &amp;&amp; <span class="keyword">this</span>.num[<span class="number">0</span>] * <span class="number">30523</span> + (<span class="keyword">this</span>.num[<span class="number">1</span>] ^ <span class="number">7990</span>) + <span class="keyword">this</span>.num[<span class="number">2</span>] + <span class="number">39058</span> + <span class="keyword">this</span>.num[<span class="number">3</span>] * <span class="number">57549</span> + (<span class="keyword">this</span>.num[<span class="number">4</span>] ^ <span class="number">53440</span>) + <span class="keyword">this</span>.num[<span class="number">5</span>] * <span class="number">4275</span> + <span class="keyword">this</span>.num[<span class="number">6</span>] - <span class="number">48863</span> + (<span class="keyword">this</span>.num[<span class="number">7</span>] ^ <span class="number">55436</span>) + (<span class="keyword">this</span>.num[<span class="number">8</span>] ^ <span class="number">2624</span>) + (<span class="keyword">this</span>.num[<span class="number">9</span>] ^ <span class="number">13652</span>) + <span class="keyword">this</span>.num[<span class="number">10</span>] + <span class="number">62231</span> + <span class="keyword">this</span>.num[<span class="number">11</span>] + <span class="number">19456</span> + <span class="keyword">this</span>.num[<span class="number">12</span>] - <span class="number">13195</span> == <span class="number">13863722</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">int</span>[] array = <span class="keyword">new</span> <span class="built_in">int</span>[]&#123;<span class="number">132</span>,<span class="number">47</span>,<span class="number">180</span>,<span class="number">7</span>,<span class="number">216</span>,<span class="number">45</span>,<span class="number">68</span>,<span class="number">6</span>,<span class="number">39</span>,<span class="number">246</span>,<span class="number">124</span>,<span class="number">2</span>,<span class="number">243</span>,<span class="number">137</span>,<span class="number">58</span>,<span class="number">172</span>,<span class="number">53</span>,<span class="number">200</span>,<span class="number">99</span>,<span class="number">91</span>,<span class="number">83</span>,<span class="number">13</span>,<span class="number">171</span>,<span class="number">80</span>,<span class="number">108</span>,<span class="number">235</span>,<span class="number">179</span>,<span class="number">58</span>,<span class="number">176</span>,<span class="number">28</span>,<span class="number">216</span>,<span class="number">36</span>,<span class="number">11</span>,<span class="number">80</span>,<span class="number">39</span>,<span class="number">162</span>,<span class="number">97</span>,<span class="number">58</span>,<span class="number">236</span>,<span class="number">130</span>,<span class="number">123</span>,<span class="number">176</span>,<span class="number">24</span>,<span class="number">212</span>,<span class="number">56</span>,<span class="number">89</span>,<span class="number">72</span>&#125;;</span><br><span class="line">		<span class="built_in">string</span> text = <span class="string">&quot;&quot;</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; array.Length; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			text += ((<span class="built_in">char</span>)(array[i] ^ <span class="keyword">this</span>.num[i % <span class="keyword">this</span>.num.Length])).ToString();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">new</span> SoundPlayer(Resources.过年鸡).Play();</span><br><span class="line">		MessageBox.Show(text);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>z3解方程＋异或，不过这个题有多解，需要自己根据flag看着限制一下z3的解 <del>这一步真的好折磨……</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">strlen=<span class="number">13</span></span><br><span class="line"></span><br><span class="line">num=[BitVec(<span class="string">&quot;num[%d]&quot;</span>%i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(strlen)]</span><br><span class="line"></span><br><span class="line">s=Solver()</span><br><span class="line"></span><br><span class="line">s.add(num[<span class="number">0</span>] == <span class="number">236</span>)</span><br><span class="line">s.add(num[<span class="number">2</span>] == <span class="number">213</span>)</span><br><span class="line">s.add(num[<span class="number">6</span>] != <span class="number">190</span>)</span><br><span class="line">s.add(num[<span class="number">12</span>] != <span class="number">5</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] + <span class="number">52296</span> + num[<span class="number">1</span>] - <span class="number">26211</span> + num[<span class="number">2</span>] - <span class="number">11754</span> + (num[<span class="number">3</span>] ^ <span class="number">41236</span>) + num[<span class="number">4</span>] * <span class="number">63747</span> + num[<span class="number">5</span>] - <span class="number">52714</span> + num[<span class="number">6</span>] - <span class="number">10512</span> + num[<span class="number">7</span>] * <span class="number">12972</span> + num[<span class="number">8</span>] + <span class="number">45505</span> + num[<span class="number">9</span>] - <span class="number">21713</span> + num[<span class="number">10</span>] - <span class="number">59122</span> + num[<span class="number">11</span>] - <span class="number">12840</span> + (num[<span class="number">12</span>] ^ <span class="number">21087</span>) == <span class="number">12702282</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] - <span class="number">25228</span> + (num[<span class="number">1</span>] ^ <span class="number">20699</span>) + (num[<span class="number">2</span>] ^ <span class="number">8158</span>) + num[<span class="number">3</span>] - <span class="number">65307</span> + num[<span class="number">4</span>] * <span class="number">30701</span> + num[<span class="number">5</span>] * <span class="number">47555</span> + num[<span class="number">6</span>] - <span class="number">2557</span> + (num[<span class="number">7</span>] ^ <span class="number">49055</span>) + num[<span class="number">8</span>] - <span class="number">7992</span> + (num[<span class="number">9</span>] ^ <span class="number">57465</span>) + (num[<span class="number">10</span>] ^ <span class="number">57426</span>) + num[<span class="number">11</span>] + <span class="number">13299</span> + num[<span class="number">12</span>] - <span class="number">50966</span> == <span class="number">9946829</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] - <span class="number">64801</span> + num[<span class="number">1</span>] - <span class="number">60698</span> + num[<span class="number">2</span>] - <span class="number">40853</span> + num[<span class="number">3</span>] - <span class="number">54907</span> + num[<span class="number">4</span>] + <span class="number">29882</span> + (num[<span class="number">5</span>] ^ <span class="number">13574</span>) + (num[<span class="number">6</span>] ^ <span class="number">21310</span>) + num[<span class="number">7</span>] + <span class="number">47366</span> + num[<span class="number">8</span>] + <span class="number">41784</span> + (num[<span class="number">9</span>] ^ <span class="number">53690</span>) + num[<span class="number">10</span>] * <span class="number">58436</span> + num[<span class="number">11</span>] * <span class="number">15590</span> + num[<span class="number">12</span>] + <span class="number">58225</span> == <span class="number">2372055</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] + <span class="number">61538</span> + num[<span class="number">1</span>] - <span class="number">17121</span> + num[<span class="number">2</span>] - <span class="number">58124</span> + num[<span class="number">3</span>] + <span class="number">8186</span> + num[<span class="number">4</span>] + <span class="number">21253</span> + num[<span class="number">5</span>] - <span class="number">38524</span> + num[<span class="number">6</span>] - <span class="number">48323</span> + num[<span class="number">7</span>] - <span class="number">20556</span> + num[<span class="number">8</span>] * <span class="number">56056</span> + num[<span class="number">9</span>] + <span class="number">18568</span> + num[<span class="number">10</span>] + <span class="number">12995</span> + (num[<span class="number">11</span>] ^ <span class="number">39260</span>) + num[<span class="number">12</span>] + <span class="number">25329</span> == <span class="number">6732474</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] - <span class="number">42567</span> + num[<span class="number">1</span>] - <span class="number">17743</span> + num[<span class="number">2</span>] * <span class="number">47827</span> + num[<span class="number">3</span>] - <span class="number">10246</span> + (num[<span class="number">4</span>] ^ <span class="number">16284</span>) + num[<span class="number">5</span>] + <span class="number">39390</span> + num[<span class="number">6</span>] * <span class="number">11803</span> + num[<span class="number">7</span>] * <span class="number">60332</span> + (num[<span class="number">8</span>] ^ <span class="number">18491</span>) + (num[<span class="number">9</span>] ^ <span class="number">4795</span>) + num[<span class="number">10</span>] - <span class="number">25636</span> + num[<span class="number">11</span>] - <span class="number">16780</span> + num[<span class="number">12</span>] - <span class="number">62345</span> == <span class="number">14020739</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] - <span class="number">10968</span> + num[<span class="number">1</span>] - <span class="number">31780</span> + (num[<span class="number">2</span>] ^ <span class="number">31857</span>) + num[<span class="number">3</span>] - <span class="number">61983</span> + num[<span class="number">4</span>] * <span class="number">31048</span> + num[<span class="number">5</span>] * <span class="number">20189</span> + num[<span class="number">6</span>] + <span class="number">12337</span> + num[<span class="number">7</span>] * <span class="number">25945</span> + (num[<span class="number">8</span>] ^ <span class="number">7064</span>) + num[<span class="number">9</span>] - <span class="number">25369</span> + num[<span class="number">10</span>] - <span class="number">54893</span> + num[<span class="number">11</span>] * <span class="number">59949</span> + (num[<span class="number">12</span>] ^ <span class="number">12441</span>) == <span class="number">14434062</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] + <span class="number">16689</span> + num[<span class="number">1</span>] - <span class="number">10279</span> + num[<span class="number">2</span>] - <span class="number">32918</span> + num[<span class="number">3</span>] - <span class="number">57155</span> + num[<span class="number">4</span>] * <span class="number">26571</span> + num[<span class="number">5</span>] * <span class="number">15086</span> + (num[<span class="number">6</span>] ^ <span class="number">22986</span>) + (num[<span class="number">7</span>] ^ <span class="number">23349</span>) + (num[<span class="number">8</span>] ^ <span class="number">16381</span>) + (num[<span class="number">9</span>] ^ <span class="number">23173</span>) + num[<span class="number">10</span>] - <span class="number">40224</span> + num[<span class="number">11</span>] + <span class="number">31751</span> + num[<span class="number">12</span>] * <span class="number">8421</span> == <span class="number">7433598</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] + <span class="number">28740</span> + num[<span class="number">1</span>] - <span class="number">64696</span> + num[<span class="number">2</span>] + <span class="number">60470</span> + num[<span class="number">3</span>] - <span class="number">14752</span> + (num[<span class="number">4</span>] ^ <span class="number">1287</span>) + (num[<span class="number">5</span>] ^ <span class="number">35272</span>) + num[<span class="number">6</span>] + <span class="number">49467</span> + num[<span class="number">7</span>] - <span class="number">33788</span> + num[<span class="number">8</span>] + <span class="number">20606</span> + (num[<span class="number">9</span>] ^ <span class="number">44874</span>) + num[<span class="number">10</span>] * <span class="number">19764</span> + num[<span class="number">11</span>] + <span class="number">48342</span> + num[<span class="number">12</span>] * <span class="number">56511</span> == <span class="number">7989404</span>)</span><br><span class="line">s.add((num[<span class="number">0</span>] ^ <span class="number">28978</span>) + num[<span class="number">1</span>] + <span class="number">23120</span> + num[<span class="number">2</span>] + <span class="number">22802</span> + num[<span class="number">3</span>] * <span class="number">31533</span> + (num[<span class="number">4</span>] ^ <span class="number">39287</span>) + num[<span class="number">5</span>] - <span class="number">48576</span> + (num[<span class="number">6</span>] ^ <span class="number">28542</span>) + num[<span class="number">7</span>] - <span class="number">43265</span> + num[<span class="number">8</span>] + <span class="number">22365</span> + num[<span class="number">9</span>] + <span class="number">61108</span> + num[<span class="number">10</span>] * <span class="number">2823</span> + num[<span class="number">11</span>] - <span class="number">30343</span> + num[<span class="number">12</span>] + <span class="number">14780</span> == <span class="number">3504803</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] * <span class="number">22466</span> + (num[<span class="number">1</span>] ^ <span class="number">55999</span>) + num[<span class="number">2</span>] - <span class="number">53658</span> + (num[<span class="number">3</span>] ^ <span class="number">47160</span>) + (num[<span class="number">4</span>] ^ <span class="number">12511</span>) + num[<span class="number">5</span>] * <span class="number">59807</span> + num[<span class="number">6</span>] + <span class="number">46242</span> + num[<span class="number">7</span>] + <span class="number">3052</span> + (num[<span class="number">8</span>] ^ <span class="number">25279</span>) + num[<span class="number">9</span>] + <span class="number">30202</span> + num[<span class="number">10</span>] * <span class="number">22698</span> + num[<span class="number">11</span>] + <span class="number">33480</span> + (num[<span class="number">12</span>] ^ <span class="number">16757</span>) == <span class="number">11003580</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] * <span class="number">57492</span> + (num[<span class="number">1</span>] ^ <span class="number">13421</span>) + num[<span class="number">2</span>] - <span class="number">13941</span> + (num[<span class="number">3</span>] ^ <span class="number">48092</span>) + num[<span class="number">4</span>] * <span class="number">38310</span> + num[<span class="number">5</span>] + <span class="number">9884</span> + num[<span class="number">6</span>] - <span class="number">45500</span> + num[<span class="number">7</span>] - <span class="number">19233</span> + num[<span class="number">8</span>] + <span class="number">58274</span> + num[<span class="number">9</span>] + <span class="number">36175</span> + (num[<span class="number">10</span>] ^ <span class="number">18568</span>) + num[<span class="number">11</span>] * <span class="number">49694</span> + (num[<span class="number">12</span>] ^ <span class="number">9473</span>) == <span class="number">25546210</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] - <span class="number">23355</span> + num[<span class="number">1</span>] * <span class="number">50164</span> + (num[<span class="number">2</span>] ^ <span class="number">34618</span>) + num[<span class="number">3</span>] + <span class="number">52703</span> + num[<span class="number">4</span>] + <span class="number">36245</span> + num[<span class="number">5</span>] * <span class="number">46648</span> + (num[<span class="number">6</span>] ^ <span class="number">4858</span>) + (num[<span class="number">7</span>] ^ <span class="number">41846</span>) + num[<span class="number">8</span>] * <span class="number">27122</span> + (num[<span class="number">9</span>] ^ <span class="number">42058</span>) + num[<span class="number">10</span>] * <span class="number">15676</span> + num[<span class="number">11</span>] - <span class="number">31863</span> + num[<span class="number">12</span>] + <span class="number">62510</span> == <span class="number">11333836</span>)</span><br><span class="line">s.add(num[<span class="number">0</span>] * <span class="number">30523</span> + (num[<span class="number">1</span>] ^ <span class="number">7990</span>) + num[<span class="number">2</span>] + <span class="number">39058</span> + num[<span class="number">3</span>] * <span class="number">57549</span> + (num[<span class="number">4</span>] ^ <span class="number">53440</span>) + num[<span class="number">5</span>] * <span class="number">4275</span> + num[<span class="number">6</span>] - <span class="number">48863</span> + (num[<span class="number">7</span>] ^ <span class="number">55436</span>) + (num[<span class="number">8</span>] ^ <span class="number">2624</span>) + (num[<span class="number">9</span>] ^ <span class="number">13652</span>) + num[<span class="number">10</span>] + <span class="number">62231</span> + num[<span class="number">11</span>] + <span class="number">19456</span> + num[<span class="number">12</span>] - <span class="number">13195</span> == <span class="number">13863722</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check()==sat:</span><br><span class="line">    m=s.model()</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>

<p>最终异或得flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">num = [<span class="number">0</span>]*<span class="number">13</span></span><br><span class="line">num[<span class="number">10</span>] = <span class="number">15</span></span><br><span class="line">num[<span class="number">9</span>] = <span class="number">199</span></span><br><span class="line">num[<span class="number">4</span>] = <span class="number">189</span></span><br><span class="line">num[<span class="number">6</span>] = <span class="number">62</span></span><br><span class="line">num[<span class="number">3</span>] = <span class="number">106</span></span><br><span class="line">num[<span class="number">8</span>] = <span class="number">120</span></span><br><span class="line">num[<span class="number">1</span>] = <span class="number">72</span></span><br><span class="line">num[<span class="number">7</span>] = <span class="number">53</span></span><br><span class="line">num[<span class="number">11</span>] = <span class="number">93</span></span><br><span class="line">num[<span class="number">12</span>] = <span class="number">133</span></span><br><span class="line">num[<span class="number">5</span>] = <span class="number">86</span></span><br><span class="line">num[<span class="number">2</span>] = <span class="number">213</span></span><br><span class="line">num[<span class="number">0</span>] = <span class="number">236</span></span><br><span class="line"></span><br><span class="line">x = [<span class="number">132</span>,<span class="number">47</span>,<span class="number">180</span>,<span class="number">7</span>,<span class="number">216</span>,<span class="number">45</span>,<span class="number">68</span>,<span class="number">6</span>,<span class="number">39</span>,<span class="number">246</span>,<span class="number">124</span>,<span class="number">2</span>,<span class="number">243</span>,<span class="number">137</span>,<span class="number">58</span>,<span class="number">172</span>,<span class="number">53</span>,<span class="number">200</span>,<span class="number">99</span>,<span class="number">91</span>,<span class="number">83</span>,<span class="number">13</span>,<span class="number">171</span>,<span class="number">80</span>,<span class="number">108</span>,<span class="number">235</span>,<span class="number">179</span>,<span class="number">58</span>,<span class="number">176</span>,<span class="number">28</span>,<span class="number">216</span>,<span class="number">36</span>,<span class="number">11</span>,<span class="number">80</span>,<span class="number">39</span>,<span class="number">162</span>,<span class="number">97</span>,<span class="number">58</span>,<span class="number">236</span>,<span class="number">130</span>,<span class="number">123</span>,<span class="number">176</span>,<span class="number">24</span>,<span class="number">212</span>,<span class="number">56</span>,<span class="number">89</span>,<span class="number">72</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(x[i]^num[i%<span class="built_in">len</span>(num)]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#hgame&#123;z3_1s_very_u5eful_1n_rever5e_engin3ering&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="patchme"><a href="#patchme" class="headerlink" title="patchme"></a>patchme</h3><p>好折磨。。。最开始搜到系统调用就直接开始改，用的int 0x80，后来才发现那是32位的系统调用，64位要用syscall…… <del>对不起我是傻子</del><br>然后参数长度刚开始看的栈上是0x20（别问我咋看的，我也不知道），后来输入输出都没问题，确信是参数长度有问题，才看IDA的伪代码长度是24……</p>
<p>漏洞存在于主函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_13E8</span><span class="params">(<span class="type">int</span> a1, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rbp</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">24</span>]; <span class="comment">// [rsp-28h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp-10h] [rbp-18h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp-8h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v6 = v2;</span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  dword_4028 = a1;</span><br><span class="line">  qword_4020 = a2;</span><br><span class="line">  gets(v4);</span><br><span class="line">  <span class="built_in">printf</span>(v4);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>gets读取的输入长度无限制，可以通过gets布置payload以达到控制程序流程的目的，而printf存在格式化字符串漏洞。所以这里主要修复这两个函数。<br>可以将gets改为系统调用sys_read，printf改成系统调用sys_write，系统调用参数查询<a target="_blank" rel="noopener" href="https://introspelliam.github.io/2017/08/06/pwn/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A/">系统调用约定</a></p>
<p>把</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.text:000000000000141F                 lea     rax, [rbp-20h]</span><br><span class="line">.text:0000000000001423                 mov     rdi, rax</span><br><span class="line">.text:0000000000001426                 mov     eax, 0</span><br><span class="line">.text:000000000000142B                 call    _gets</span><br><span class="line">.text:0000000000001430                 lea     rax, [rbp-20h]</span><br><span class="line">.text:0000000000001434                 mov     rdi, rax        ; format</span><br><span class="line">.text:0000000000001437                 mov     eax, 0</span><br><span class="line">.text:000000000000143C                 call    _printf</span><br></pre></td></tr></table></figure>

<p>改成</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.text:000000000000141F                 lea     rsi, [rbp-20h]  ; buf</span><br><span class="line">.text:0000000000001423                 xor     rdi, rdi        ; fd</span><br><span class="line">.text:0000000000001426                 nop</span><br><span class="line">.text:0000000000001427                 nop</span><br><span class="line">.text:0000000000001428                 nop</span><br><span class="line">.text:0000000000001429                 nop</span><br><span class="line">.text:000000000000142A                 xor     rax, rax</span><br><span class="line">.text:000000000000142D                 mov     rdx, 18h        ; count</span><br><span class="line">.text:0000000000001434                 syscall                 ; LINUX - sys_read</span><br><span class="line">.text:0000000000001436                 xor     rax, rax</span><br><span class="line">.text:0000000000001439                 inc     rax</span><br><span class="line">.text:000000000000143C                 inc     rdi             ; fd</span><br><span class="line">.text:000000000000143F                 syscall</span><br></pre></td></tr></table></figure>

<p>（我为了省地方，清零都用的xor）<br>保存运行，随便输点啥即可<br><code>hgame&#123;You_4re_a_p@tch_master_0r_reverse_ma5ter&#125;</code></p>
<h3 id="cpp"><a href="#cpp" class="headerlink" title="cpp"></a>cpp</h3><p>究极折磨的题……调N年看不懂在干什么，后来发现应该是单字节加密，遂爆破</p>
<p>由于本人菜得不会hook库函数，遂决定patch输出爆破。具体而言就是把输出字符串patch成加密后的密文，和程序里原有的密文对比，对比正确的长度多一位则说明这一位正确。密文很好找，在sub_140003080。<br>关于具体怎么patch，先去找memcmp函数，也就是最终密文和输入加密后的密文对比的地方，固定基址之后在sub_140007D70。去看这个函数的汇编，调用memcmp前，我们需要的指针在rdx里，那么想办法保留rdx的值，我选择把它暂存在r15里，等到最后调用输出的时候直接用r15覆盖rdx即可。</p>
<p>具体而言就是改成下面这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">.text:0000000140007D9C 48 89 C2                                mov     rdx, rax        </span><br><span class="line">.text:0000000140007D9F 90                                      nop</span><br><span class="line">.text:0000000140007DA0 90                                      nop</span><br><span class="line">.text:0000000140007DA1 48 8B 44 24 20                          mov     rax, [rsp+48h+Buf1]</span><br><span class="line">.text:0000000140007DA6 48 8B 4C 24 28                          mov     rcx, [rsp+48h+var_20]</span><br><span class="line">.text:0000000140007DAB 48 2B C8                                sub     rcx, rax</span><br><span class="line">.text:0000000140007DAE 48 8B C1                                mov     rax, rcx</span><br><span class="line">.text:0000000140007DB1 4C 8B C0                                mov     r8, rax         ; Size</span><br><span class="line">.text:0000000140007DB4 49 89 D7                                mov     r15, rdx        ; Buf2</span><br><span class="line">.text:0000000140007DB7 90                                      nop</span><br><span class="line">.text:0000000140007DB8 90                                      nop</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">.text:000000014000334A 4C 89 FA                                mov     rdx, r15        ; Keypatch modified </span><br><span class="line">.text:000000014000334D 90                                      nop</span><br><span class="line">.text:000000014000334E 90                                      nop</span><br><span class="line">.text:000000014000334F 90                                      nop</span><br><span class="line">.text:0000000140003350 90                                      nop</span><br><span class="line">.text:0000000140003351 48 8B 0D B0 6D 00 00                    mov     rcx, cs:?cout@std@@3V?$basic_ostream@DU?$char_traits@D@std@@@1@A ; std::ostream std::cout</span><br><span class="line">.text:0000000140003358 E8 13 12 00 00                          call    sub_140004570</span><br></pre></td></tr></table></figure>

<p>写交互脚本爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line">flag = <span class="string">&#x27;hgame&#123;&#x27;</span></span><br><span class="line">enc = [<span class="number">0x28</span>,<span class="number">0x50</span>,<span class="number">0xC1</span>,<span class="number">0x23</span>,<span class="number">0x98</span>,<span class="number">0xA1</span>,<span class="number">0x41</span>,<span class="number">0x36</span>,<span class="number">0x4C</span>,<span class="number">0x31</span>,<span class="number">0xCB</span>,<span class="number">0x52</span>,<span class="number">0x90</span>,<span class="number">0xF1</span>,<span class="number">0xAC</span>,<span class="number">0xCC</span>,<span class="number">0xF</span>,<span class="number">0x6C</span>,<span class="number">0x2A</span>,<span class="number">0x89</span>,<span class="number">0x7F</span>,<span class="number">0xDF</span>,<span class="number">0x11</span>,<span class="number">0x84</span>,<span class="number">0x7F</span>,<span class="number">0xE6</span>,<span class="number">0xA2</span>,<span class="number">0xE0</span>,<span class="number">0x59</span>,<span class="number">0xC7</span>,<span class="number">0xC5</span>,<span class="number">0x46</span>,<span class="number">0x5D</span>,<span class="number">0x29</span>,<span class="number">0x38</span>,<span class="number">0x93</span>,<span class="number">0xED</span>,<span class="number">0x15</span>,<span class="number">0x7A</span>,<span class="number">0xFF</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmp</span>(<span class="params">s1,s2</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> s1[i]!=s2[i]:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line"><span class="built_in">len</span> = <span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x80</span>):</span><br><span class="line">        p = subprocess.Popen([<span class="string">&quot;week3-cpp.exe&quot;</span>], stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)</span><br><span class="line">        tmp = flag + <span class="built_in">chr</span>(j)*(<span class="number">33</span>-i)+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">        p.stdin.write(tmp.encode())</span><br><span class="line">        p.stdin.close()</span><br><span class="line">        out = p.stdout.read()[:<span class="number">40</span>]</span><br><span class="line">        p.stdout.close()</span><br><span class="line">        <span class="keyword">if</span> cmp(out, enc)&gt;<span class="built_in">len</span>:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">len</span> += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;yes&#x27;</span> <span class="keyword">in</span> out:</span><br><span class="line">            <span class="built_in">print</span>(tmp)</span><br><span class="line">            exit()</span><br><span class="line"><span class="comment">#hgame&#123;Cpp_1s_much_m0r3_dlff1cult_th4n_C&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><p>好像很麻烦，经典go+vm，懒得写了，就这样吧……</p>

    </div>

    <div class="about">
        <h1>关于本文</h1>
        <p>本文作者 云之君, 许可由 <a
                target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
    </div>

    
        
    
</article>
        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h4 class="title">Blog</h4>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/CTF" class="item">CTF</a>
                
                <a href="/Learn" class="item">Learn</a>
                
                <a href="/Dairy" class="item">Dairy</a>
                
                <a href="/friends" class="item">Friends</a>
                
            </div>
            
            <div class="group">
                <h4 class="title">Me</h4>
                
                <a target="_blank" rel="noopener" href="https://github.com/YunZh1Jun" class="item">GitHub</a>
                
                <a href="mailto:yunzh1jun@qq.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2023 云之君<br >驱动由 <a href="http://hexo.io/" target="_blank">Hexo</a></span>
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
    </body>
</html>